<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>ML_PythonNotes_2021</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



<style type="text/css">
    /*!
*
* Twitter Bootstrap
*
*/
/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block;
  vertical-align: baseline;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a {
  background-color: transparent;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */
@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a,
  a:visited {
    text-decoration: underline;
  }
  a[href]:after {
    content: " (" attr(href) ")";
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }
  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  tr,
  img {
    page-break-inside: avoid;
  }
  img {
    max-width: 100% !important;
  }
  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }
  h2,
  h3 {
    page-break-after: avoid;
  }
  .navbar {
    display: none;
  }
  .btn > .caret,
  .dropup > .btn > .caret {
    border-top-color: #000 !important;
  }
  .label {
    border: 1px solid #000;
  }
  .table {
    border-collapse: collapse !important;
  }
  .table td,
  .table th {
    background-color: #fff !important;
  }
  .table-bordered th,
  .table-bordered td {
    border: 1px solid #ddd !important;
  }
}
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.glyphicon-asterisk:before {
  content: "\002a";
}
.glyphicon-plus:before {
  content: "\002b";
}
.glyphicon-euro:before,
.glyphicon-eur:before {
  content: "\20ac";
}
.glyphicon-minus:before {
  content: "\2212";
}
.glyphicon-cloud:before {
  content: "\2601";
}
.glyphicon-envelope:before {
  content: "\2709";
}
.glyphicon-pencil:before {
  content: "\270f";
}
.glyphicon-glass:before {
  content: "\e001";
}
.glyphicon-music:before {
  content: "\e002";
}
.glyphicon-search:before {
  content: "\e003";
}
.glyphicon-heart:before {
  content: "\e005";
}
.glyphicon-star:before {
  content: "\e006";
}
.glyphicon-star-empty:before {
  content: "\e007";
}
.glyphicon-user:before {
  content: "\e008";
}
.glyphicon-film:before {
  content: "\e009";
}
.glyphicon-th-large:before {
  content: "\e010";
}
.glyphicon-th:before {
  content: "\e011";
}
.glyphicon-th-list:before {
  content: "\e012";
}
.glyphicon-ok:before {
  content: "\e013";
}
.glyphicon-remove:before {
  content: "\e014";
}
.glyphicon-zoom-in:before {
  content: "\e015";
}
.glyphicon-zoom-out:before {
  content: "\e016";
}
.glyphicon-off:before {
  content: "\e017";
}
.glyphicon-signal:before {
  content: "\e018";
}
.glyphicon-cog:before {
  content: "\e019";
}
.glyphicon-trash:before {
  content: "\e020";
}
.glyphicon-home:before {
  content: "\e021";
}
.glyphicon-file:before {
  content: "\e022";
}
.glyphicon-time:before {
  content: "\e023";
}
.glyphicon-road:before {
  content: "\e024";
}
.glyphicon-download-alt:before {
  content: "\e025";
}
.glyphicon-download:before {
  content: "\e026";
}
.glyphicon-upload:before {
  content: "\e027";
}
.glyphicon-inbox:before {
  content: "\e028";
}
.glyphicon-play-circle:before {
  content: "\e029";
}
.glyphicon-repeat:before {
  content: "\e030";
}
.glyphicon-refresh:before {
  content: "\e031";
}
.glyphicon-list-alt:before {
  content: "\e032";
}
.glyphicon-lock:before {
  content: "\e033";
}
.glyphicon-flag:before {
  content: "\e034";
}
.glyphicon-headphones:before {
  content: "\e035";
}
.glyphicon-volume-off:before {
  content: "\e036";
}
.glyphicon-volume-down:before {
  content: "\e037";
}
.glyphicon-volume-up:before {
  content: "\e038";
}
.glyphicon-qrcode:before {
  content: "\e039";
}
.glyphicon-barcode:before {
  content: "\e040";
}
.glyphicon-tag:before {
  content: "\e041";
}
.glyphicon-tags:before {
  content: "\e042";
}
.glyphicon-book:before {
  content: "\e043";
}
.glyphicon-bookmark:before {
  content: "\e044";
}
.glyphicon-print:before {
  content: "\e045";
}
.glyphicon-camera:before {
  content: "\e046";
}
.glyphicon-font:before {
  content: "\e047";
}
.glyphicon-bold:before {
  content: "\e048";
}
.glyphicon-italic:before {
  content: "\e049";
}
.glyphicon-text-height:before {
  content: "\e050";
}
.glyphicon-text-width:before {
  content: "\e051";
}
.glyphicon-align-left:before {
  content: "\e052";
}
.glyphicon-align-center:before {
  content: "\e053";
}
.glyphicon-align-right:before {
  content: "\e054";
}
.glyphicon-align-justify:before {
  content: "\e055";
}
.glyphicon-list:before {
  content: "\e056";
}
.glyphicon-indent-left:before {
  content: "\e057";
}
.glyphicon-indent-right:before {
  content: "\e058";
}
.glyphicon-facetime-video:before {
  content: "\e059";
}
.glyphicon-picture:before {
  content: "\e060";
}
.glyphicon-map-marker:before {
  content: "\e062";
}
.glyphicon-adjust:before {
  content: "\e063";
}
.glyphicon-tint:before {
  content: "\e064";
}
.glyphicon-edit:before {
  content: "\e065";
}
.glyphicon-share:before {
  content: "\e066";
}
.glyphicon-check:before {
  content: "\e067";
}
.glyphicon-move:before {
  content: "\e068";
}
.glyphicon-step-backward:before {
  content: "\e069";
}
.glyphicon-fast-backward:before {
  content: "\e070";
}
.glyphicon-backward:before {
  content: "\e071";
}
.glyphicon-play:before {
  content: "\e072";
}
.glyphicon-pause:before {
  content: "\e073";
}
.glyphicon-stop:before {
  content: "\e074";
}
.glyphicon-forward:before {
  content: "\e075";
}
.glyphicon-fast-forward:before {
  content: "\e076";
}
.glyphicon-step-forward:before {
  content: "\e077";
}
.glyphicon-eject:before {
  content: "\e078";
}
.glyphicon-chevron-left:before {
  content: "\e079";
}
.glyphicon-chevron-right:before {
  content: "\e080";
}
.glyphicon-plus-sign:before {
  content: "\e081";
}
.glyphicon-minus-sign:before {
  content: "\e082";
}
.glyphicon-remove-sign:before {
  content: "\e083";
}
.glyphicon-ok-sign:before {
  content: "\e084";
}
.glyphicon-question-sign:before {
  content: "\e085";
}
.glyphicon-info-sign:before {
  content: "\e086";
}
.glyphicon-screenshot:before {
  content: "\e087";
}
.glyphicon-remove-circle:before {
  content: "\e088";
}
.glyphicon-ok-circle:before {
  content: "\e089";
}
.glyphicon-ban-circle:before {
  content: "\e090";
}
.glyphicon-arrow-left:before {
  content: "\e091";
}
.glyphicon-arrow-right:before {
  content: "\e092";
}
.glyphicon-arrow-up:before {
  content: "\e093";
}
.glyphicon-arrow-down:before {
  content: "\e094";
}
.glyphicon-share-alt:before {
  content: "\e095";
}
.glyphicon-resize-full:before {
  content: "\e096";
}
.glyphicon-resize-small:before {
  content: "\e097";
}
.glyphicon-exclamation-sign:before {
  content: "\e101";
}
.glyphicon-gift:before {
  content: "\e102";
}
.glyphicon-leaf:before {
  content: "\e103";
}
.glyphicon-fire:before {
  content: "\e104";
}
.glyphicon-eye-open:before {
  content: "\e105";
}
.glyphicon-eye-close:before {
  content: "\e106";
}
.glyphicon-warning-sign:before {
  content: "\e107";
}
.glyphicon-plane:before {
  content: "\e108";
}
.glyphicon-calendar:before {
  content: "\e109";
}
.glyphicon-random:before {
  content: "\e110";
}
.glyphicon-comment:before {
  content: "\e111";
}
.glyphicon-magnet:before {
  content: "\e112";
}
.glyphicon-chevron-up:before {
  content: "\e113";
}
.glyphicon-chevron-down:before {
  content: "\e114";
}
.glyphicon-retweet:before {
  content: "\e115";
}
.glyphicon-shopping-cart:before {
  content: "\e116";
}
.glyphicon-folder-close:before {
  content: "\e117";
}
.glyphicon-folder-open:before {
  content: "\e118";
}
.glyphicon-resize-vertical:before {
  content: "\e119";
}
.glyphicon-resize-horizontal:before {
  content: "\e120";
}
.glyphicon-hdd:before {
  content: "\e121";
}
.glyphicon-bullhorn:before {
  content: "\e122";
}
.glyphicon-bell:before {
  content: "\e123";
}
.glyphicon-certificate:before {
  content: "\e124";
}
.glyphicon-thumbs-up:before {
  content: "\e125";
}
.glyphicon-thumbs-down:before {
  content: "\e126";
}
.glyphicon-hand-right:before {
  content: "\e127";
}
.glyphicon-hand-left:before {
  content: "\e128";
}
.glyphicon-hand-up:before {
  content: "\e129";
}
.glyphicon-hand-down:before {
  content: "\e130";
}
.glyphicon-circle-arrow-right:before {
  content: "\e131";
}
.glyphicon-circle-arrow-left:before {
  content: "\e132";
}
.glyphicon-circle-arrow-up:before {
  content: "\e133";
}
.glyphicon-circle-arrow-down:before {
  content: "\e134";
}
.glyphicon-globe:before {
  content: "\e135";
}
.glyphicon-wrench:before {
  content: "\e136";
}
.glyphicon-tasks:before {
  content: "\e137";
}
.glyphicon-filter:before {
  content: "\e138";
}
.glyphicon-briefcase:before {
  content: "\e139";
}
.glyphicon-fullscreen:before {
  content: "\e140";
}
.glyphicon-dashboard:before {
  content: "\e141";
}
.glyphicon-paperclip:before {
  content: "\e142";
}
.glyphicon-heart-empty:before {
  content: "\e143";
}
.glyphicon-link:before {
  content: "\e144";
}
.glyphicon-phone:before {
  content: "\e145";
}
.glyphicon-pushpin:before {
  content: "\e146";
}
.glyphicon-usd:before {
  content: "\e148";
}
.glyphicon-gbp:before {
  content: "\e149";
}
.glyphicon-sort:before {
  content: "\e150";
}
.glyphicon-sort-by-alphabet:before {
  content: "\e151";
}
.glyphicon-sort-by-alphabet-alt:before {
  content: "\e152";
}
.glyphicon-sort-by-order:before {
  content: "\e153";
}
.glyphicon-sort-by-order-alt:before {
  content: "\e154";
}
.glyphicon-sort-by-attributes:before {
  content: "\e155";
}
.glyphicon-sort-by-attributes-alt:before {
  content: "\e156";
}
.glyphicon-unchecked:before {
  content: "\e157";
}
.glyphicon-expand:before {
  content: "\e158";
}
.glyphicon-collapse-down:before {
  content: "\e159";
}
.glyphicon-collapse-up:before {
  content: "\e160";
}
.glyphicon-log-in:before {
  content: "\e161";
}
.glyphicon-flash:before {
  content: "\e162";
}
.glyphicon-log-out:before {
  content: "\e163";
}
.glyphicon-new-window:before {
  content: "\e164";
}
.glyphicon-record:before {
  content: "\e165";
}
.glyphicon-save:before {
  content: "\e166";
}
.glyphicon-open:before {
  content: "\e167";
}
.glyphicon-saved:before {
  content: "\e168";
}
.glyphicon-import:before {
  content: "\e169";
}
.glyphicon-export:before {
  content: "\e170";
}
.glyphicon-send:before {
  content: "\e171";
}
.glyphicon-floppy-disk:before {
  content: "\e172";
}
.glyphicon-floppy-saved:before {
  content: "\e173";
}
.glyphicon-floppy-remove:before {
  content: "\e174";
}
.glyphicon-floppy-save:before {
  content: "\e175";
}
.glyphicon-floppy-open:before {
  content: "\e176";
}
.glyphicon-credit-card:before {
  content: "\e177";
}
.glyphicon-transfer:before {
  content: "\e178";
}
.glyphicon-cutlery:before {
  content: "\e179";
}
.glyphicon-header:before {
  content: "\e180";
}
.glyphicon-compressed:before {
  content: "\e181";
}
.glyphicon-earphone:before {
  content: "\e182";
}
.glyphicon-phone-alt:before {
  content: "\e183";
}
.glyphicon-tower:before {
  content: "\e184";
}
.glyphicon-stats:before {
  content: "\e185";
}
.glyphicon-sd-video:before {
  content: "\e186";
}
.glyphicon-hd-video:before {
  content: "\e187";
}
.glyphicon-subtitles:before {
  content: "\e188";
}
.glyphicon-sound-stereo:before {
  content: "\e189";
}
.glyphicon-sound-dolby:before {
  content: "\e190";
}
.glyphicon-sound-5-1:before {
  content: "\e191";
}
.glyphicon-sound-6-1:before {
  content: "\e192";
}
.glyphicon-sound-7-1:before {
  content: "\e193";
}
.glyphicon-copyright-mark:before {
  content: "\e194";
}
.glyphicon-registration-mark:before {
  content: "\e195";
}
.glyphicon-cloud-download:before {
  content: "\e197";
}
.glyphicon-cloud-upload:before {
  content: "\e198";
}
.glyphicon-tree-conifer:before {
  content: "\e199";
}
.glyphicon-tree-deciduous:before {
  content: "\e200";
}
.glyphicon-cd:before {
  content: "\e201";
}
.glyphicon-save-file:before {
  content: "\e202";
}
.glyphicon-open-file:before {
  content: "\e203";
}
.glyphicon-level-up:before {
  content: "\e204";
}
.glyphicon-copy:before {
  content: "\e205";
}
.glyphicon-paste:before {
  content: "\e206";
}
.glyphicon-alert:before {
  content: "\e209";
}
.glyphicon-equalizer:before {
  content: "\e210";
}
.glyphicon-king:before {
  content: "\e211";
}
.glyphicon-queen:before {
  content: "\e212";
}
.glyphicon-pawn:before {
  content: "\e213";
}
.glyphicon-bishop:before {
  content: "\e214";
}
.glyphicon-knight:before {
  content: "\e215";
}
.glyphicon-baby-formula:before {
  content: "\e216";
}
.glyphicon-tent:before {
  content: "\26fa";
}
.glyphicon-blackboard:before {
  content: "\e218";
}
.glyphicon-bed:before {
  content: "\e219";
}
.glyphicon-apple:before {
  content: "\f8ff";
}
.glyphicon-erase:before {
  content: "\e221";
}
.glyphicon-hourglass:before {
  content: "\231b";
}
.glyphicon-lamp:before {
  content: "\e223";
}
.glyphicon-duplicate:before {
  content: "\e224";
}
.glyphicon-piggy-bank:before {
  content: "\e225";
}
.glyphicon-scissors:before {
  content: "\e226";
}
.glyphicon-bitcoin:before {
  content: "\e227";
}
.glyphicon-btc:before {
  content: "\e227";
}
.glyphicon-xbt:before {
  content: "\e227";
}
.glyphicon-yen:before {
  content: "\00a5";
}
.glyphicon-jpy:before {
  content: "\00a5";
}
.glyphicon-ruble:before {
  content: "\20bd";
}
.glyphicon-rub:before {
  content: "\20bd";
}
.glyphicon-scale:before {
  content: "\e230";
}
.glyphicon-ice-lolly:before {
  content: "\e231";
}
.glyphicon-ice-lolly-tasted:before {
  content: "\e232";
}
.glyphicon-education:before {
  content: "\e233";
}
.glyphicon-option-horizontal:before {
  content: "\e234";
}
.glyphicon-option-vertical:before {
  content: "\e235";
}
.glyphicon-menu-hamburger:before {
  content: "\e236";
}
.glyphicon-modal-window:before {
  content: "\e237";
}
.glyphicon-oil:before {
  content: "\e238";
}
.glyphicon-grain:before {
  content: "\e239";
}
.glyphicon-sunglasses:before {
  content: "\e240";
}
.glyphicon-text-size:before {
  content: "\e241";
}
.glyphicon-text-color:before {
  content: "\e242";
}
.glyphicon-text-background:before {
  content: "\e243";
}
.glyphicon-object-align-top:before {
  content: "\e244";
}
.glyphicon-object-align-bottom:before {
  content: "\e245";
}
.glyphicon-object-align-horizontal:before {
  content: "\e246";
}
.glyphicon-object-align-left:before {
  content: "\e247";
}
.glyphicon-object-align-vertical:before {
  content: "\e248";
}
.glyphicon-object-align-right:before {
  content: "\e249";
}
.glyphicon-triangle-right:before {
  content: "\e250";
}
.glyphicon-triangle-left:before {
  content: "\e251";
}
.glyphicon-triangle-bottom:before {
  content: "\e252";
}
.glyphicon-triangle-top:before {
  content: "\e253";
}
.glyphicon-console:before {
  content: "\e254";
}
.glyphicon-superscript:before {
  content: "\e255";
}
.glyphicon-subscript:before {
  content: "\e256";
}
.glyphicon-menu-left:before {
  content: "\e257";
}
.glyphicon-menu-right:before {
  content: "\e258";
}
.glyphicon-menu-down:before {
  content: "\e259";
}
.glyphicon-menu-up:before {
  content: "\e260";
}
* {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
*:before,
*:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html {
  font-size: 10px;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 1.42857143;
  color: #000;
  background-color: #fff;
}
input,
button,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
a {
  color: #337ab7;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #23527c;
  text-decoration: underline;
}
a:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
figure {
  margin: 0;
}
img {
  vertical-align: middle;
}
.img-responsive,
.thumbnail > img,
.thumbnail a > img,
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  display: block;
  max-width: 100%;
  height: auto;
}
.img-rounded {
  border-radius: 3px;
}
.img-thumbnail {
  padding: 4px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
  max-width: 100%;
  height: auto;
}
.img-circle {
  border-radius: 50%;
}
hr {
  margin-top: 18px;
  margin-bottom: 18px;
  border: 0;
  border-top: 1px solid #eeeeee;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
[role="button"] {
  cursor: pointer;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
  font-family: inherit;
  font-weight: 500;
  line-height: 1.1;
  color: inherit;
}
h1 small,
h2 small,
h3 small,
h4 small,
h5 small,
h6 small,
.h1 small,
.h2 small,
.h3 small,
.h4 small,
.h5 small,
.h6 small,
h1 .small,
h2 .small,
h3 .small,
h4 .small,
h5 .small,
h6 .small,
.h1 .small,
.h2 .small,
.h3 .small,
.h4 .small,
.h5 .small,
.h6 .small {
  font-weight: normal;
  line-height: 1;
  color: #777777;
}
h1,
.h1,
h2,
.h2,
h3,
.h3 {
  margin-top: 18px;
  margin-bottom: 9px;
}
h1 small,
.h1 small,
h2 small,
.h2 small,
h3 small,
.h3 small,
h1 .small,
.h1 .small,
h2 .small,
.h2 .small,
h3 .small,
.h3 .small {
  font-size: 65%;
}
h4,
.h4,
h5,
.h5,
h6,
.h6 {
  margin-top: 9px;
  margin-bottom: 9px;
}
h4 small,
.h4 small,
h5 small,
.h5 small,
h6 small,
.h6 small,
h4 .small,
.h4 .small,
h5 .small,
.h5 .small,
h6 .small,
.h6 .small {
  font-size: 75%;
}
h1,
.h1 {
  font-size: 33px;
}
h2,
.h2 {
  font-size: 27px;
}
h3,
.h3 {
  font-size: 23px;
}
h4,
.h4 {
  font-size: 17px;
}
h5,
.h5 {
  font-size: 13px;
}
h6,
.h6 {
  font-size: 12px;
}
p {
  margin: 0 0 9px;
}
.lead {
  margin-bottom: 18px;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.4;
}
@media (min-width: 768px) {
  .lead {
    font-size: 19.5px;
  }
}
small,
.small {
  font-size: 92%;
}
mark,
.mark {
  background-color: #fcf8e3;
  padding: .2em;
}
.text-left {
  text-align: left;
}
.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}
.text-justify {
  text-align: justify;
}
.text-nowrap {
  white-space: nowrap;
}
.text-lowercase {
  text-transform: lowercase;
}
.text-uppercase {
  text-transform: uppercase;
}
.text-capitalize {
  text-transform: capitalize;
}
.text-muted {
  color: #777777;
}
.text-primary {
  color: #337ab7;
}
a.text-primary:hover,
a.text-primary:focus {
  color: #286090;
}
.text-success {
  color: #3c763d;
}
a.text-success:hover,
a.text-success:focus {
  color: #2b542c;
}
.text-info {
  color: #31708f;
}
a.text-info:hover,
a.text-info:focus {
  color: #245269;
}
.text-warning {
  color: #8a6d3b;
}
a.text-warning:hover,
a.text-warning:focus {
  color: #66512c;
}
.text-danger {
  color: #a94442;
}
a.text-danger:hover,
a.text-danger:focus {
  color: #843534;
}
.bg-primary {
  color: #fff;
  background-color: #337ab7;
}
a.bg-primary:hover,
a.bg-primary:focus {
  background-color: #286090;
}
.bg-success {
  background-color: #dff0d8;
}
a.bg-success:hover,
a.bg-success:focus {
  background-color: #c1e2b3;
}
.bg-info {
  background-color: #d9edf7;
}
a.bg-info:hover,
a.bg-info:focus {
  background-color: #afd9ee;
}
.bg-warning {
  background-color: #fcf8e3;
}
a.bg-warning:hover,
a.bg-warning:focus {
  background-color: #f7ecb5;
}
.bg-danger {
  background-color: #f2dede;
}
a.bg-danger:hover,
a.bg-danger:focus {
  background-color: #e4b9b9;
}
.page-header {
  padding-bottom: 8px;
  margin: 36px 0 18px;
  border-bottom: 1px solid #eeeeee;
}
ul,
ol {
  margin-top: 0;
  margin-bottom: 9px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}
.list-unstyled {
  padding-left: 0;
  list-style: none;
}
.list-inline {
  padding-left: 0;
  list-style: none;
  margin-left: -5px;
}
.list-inline > li {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
dl {
  margin-top: 0;
  margin-bottom: 18px;
}
dt,
dd {
  line-height: 1.42857143;
}
dt {
  font-weight: bold;
}
dd {
  margin-left: 0;
}
@media (min-width: 541px) {
  .dl-horizontal dt {
    float: left;
    width: 160px;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .dl-horizontal dd {
    margin-left: 180px;
  }
}
abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #777777;
}
.initialism {
  font-size: 90%;
  text-transform: uppercase;
}
blockquote {
  padding: 9px 18px;
  margin: 0 0 18px;
  font-size: inherit;
  border-left: 5px solid #eeeeee;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #777777;
}
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #eeeeee;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}
address {
  margin-bottom: 18px;
  font-style: normal;
  line-height: 1.42857143;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 2px;
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #888;
  background-color: transparent;
  border-radius: 1px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  box-shadow: none;
}
pre {
  display: block;
  padding: 8.5px;
  margin: 0 0 9px;
  font-size: 12px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 2px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}
.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll;
}
.container {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
@media (min-width: 768px) {
  .container {
    width: 768px;
  }
}
@media (min-width: 992px) {
  .container {
    width: 940px;
  }
}
@media (min-width: 1200px) {
  .container {
    width: 1140px;
  }
}
.container-fluid {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
.row {
  margin-left: 0px;
  margin-right: 0px;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
  position: relative;
  min-height: 1px;
  padding-left: 0px;
  padding-right: 0px;
}
.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
  float: left;
}
.col-xs-12 {
  width: 100%;
}
.col-xs-11 {
  width: 91.66666667%;
}
.col-xs-10 {
  width: 83.33333333%;
}
.col-xs-9 {
  width: 75%;
}
.col-xs-8 {
  width: 66.66666667%;
}
.col-xs-7 {
  width: 58.33333333%;
}
.col-xs-6 {
  width: 50%;
}
.col-xs-5 {
  width: 41.66666667%;
}
.col-xs-4 {
  width: 33.33333333%;
}
.col-xs-3 {
  width: 25%;
}
.col-xs-2 {
  width: 16.66666667%;
}
.col-xs-1 {
  width: 8.33333333%;
}
.col-xs-pull-12 {
  right: 100%;
}
.col-xs-pull-11 {
  right: 91.66666667%;
}
.col-xs-pull-10 {
  right: 83.33333333%;
}
.col-xs-pull-9 {
  right: 75%;
}
.col-xs-pull-8 {
  right: 66.66666667%;
}
.col-xs-pull-7 {
  right: 58.33333333%;
}
.col-xs-pull-6 {
  right: 50%;
}
.col-xs-pull-5 {
  right: 41.66666667%;
}
.col-xs-pull-4 {
  right: 33.33333333%;
}
.col-xs-pull-3 {
  right: 25%;
}
.col-xs-pull-2 {
  right: 16.66666667%;
}
.col-xs-pull-1 {
  right: 8.33333333%;
}
.col-xs-pull-0 {
  right: auto;
}
.col-xs-push-12 {
  left: 100%;
}
.col-xs-push-11 {
  left: 91.66666667%;
}
.col-xs-push-10 {
  left: 83.33333333%;
}
.col-xs-push-9 {
  left: 75%;
}
.col-xs-push-8 {
  left: 66.66666667%;
}
.col-xs-push-7 {
  left: 58.33333333%;
}
.col-xs-push-6 {
  left: 50%;
}
.col-xs-push-5 {
  left: 41.66666667%;
}
.col-xs-push-4 {
  left: 33.33333333%;
}
.col-xs-push-3 {
  left: 25%;
}
.col-xs-push-2 {
  left: 16.66666667%;
}
.col-xs-push-1 {
  left: 8.33333333%;
}
.col-xs-push-0 {
  left: auto;
}
.col-xs-offset-12 {
  margin-left: 100%;
}
.col-xs-offset-11 {
  margin-left: 91.66666667%;
}
.col-xs-offset-10 {
  margin-left: 83.33333333%;
}
.col-xs-offset-9 {
  margin-left: 75%;
}
.col-xs-offset-8 {
  margin-left: 66.66666667%;
}
.col-xs-offset-7 {
  margin-left: 58.33333333%;
}
.col-xs-offset-6 {
  margin-left: 50%;
}
.col-xs-offset-5 {
  margin-left: 41.66666667%;
}
.col-xs-offset-4 {
  margin-left: 33.33333333%;
}
.col-xs-offset-3 {
  margin-left: 25%;
}
.col-xs-offset-2 {
  margin-left: 16.66666667%;
}
.col-xs-offset-1 {
  margin-left: 8.33333333%;
}
.col-xs-offset-0 {
  margin-left: 0%;
}
@media (min-width: 768px) {
  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
    float: left;
  }
  .col-sm-12 {
    width: 100%;
  }
  .col-sm-11 {
    width: 91.66666667%;
  }
  .col-sm-10 {
    width: 83.33333333%;
  }
  .col-sm-9 {
    width: 75%;
  }
  .col-sm-8 {
    width: 66.66666667%;
  }
  .col-sm-7 {
    width: 58.33333333%;
  }
  .col-sm-6 {
    width: 50%;
  }
  .col-sm-5 {
    width: 41.66666667%;
  }
  .col-sm-4 {
    width: 33.33333333%;
  }
  .col-sm-3 {
    width: 25%;
  }
  .col-sm-2 {
    width: 16.66666667%;
  }
  .col-sm-1 {
    width: 8.33333333%;
  }
  .col-sm-pull-12 {
    right: 100%;
  }
  .col-sm-pull-11 {
    right: 91.66666667%;
  }
  .col-sm-pull-10 {
    right: 83.33333333%;
  }
  .col-sm-pull-9 {
    right: 75%;
  }
  .col-sm-pull-8 {
    right: 66.66666667%;
  }
  .col-sm-pull-7 {
    right: 58.33333333%;
  }
  .col-sm-pull-6 {
    right: 50%;
  }
  .col-sm-pull-5 {
    right: 41.66666667%;
  }
  .col-sm-pull-4 {
    right: 33.33333333%;
  }
  .col-sm-pull-3 {
    right: 25%;
  }
  .col-sm-pull-2 {
    right: 16.66666667%;
  }
  .col-sm-pull-1 {
    right: 8.33333333%;
  }
  .col-sm-pull-0 {
    right: auto;
  }
  .col-sm-push-12 {
    left: 100%;
  }
  .col-sm-push-11 {
    left: 91.66666667%;
  }
  .col-sm-push-10 {
    left: 83.33333333%;
  }
  .col-sm-push-9 {
    left: 75%;
  }
  .col-sm-push-8 {
    left: 66.66666667%;
  }
  .col-sm-push-7 {
    left: 58.33333333%;
  }
  .col-sm-push-6 {
    left: 50%;
  }
  .col-sm-push-5 {
    left: 41.66666667%;
  }
  .col-sm-push-4 {
    left: 33.33333333%;
  }
  .col-sm-push-3 {
    left: 25%;
  }
  .col-sm-push-2 {
    left: 16.66666667%;
  }
  .col-sm-push-1 {
    left: 8.33333333%;
  }
  .col-sm-push-0 {
    left: auto;
  }
  .col-sm-offset-12 {
    margin-left: 100%;
  }
  .col-sm-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-sm-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-sm-offset-9 {
    margin-left: 75%;
  }
  .col-sm-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-sm-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-sm-offset-6 {
    margin-left: 50%;
  }
  .col-sm-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-sm-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-sm-offset-3 {
    margin-left: 25%;
  }
  .col-sm-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-sm-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-sm-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 992px) {
  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
    float: left;
  }
  .col-md-12 {
    width: 100%;
  }
  .col-md-11 {
    width: 91.66666667%;
  }
  .col-md-10 {
    width: 83.33333333%;
  }
  .col-md-9 {
    width: 75%;
  }
  .col-md-8 {
    width: 66.66666667%;
  }
  .col-md-7 {
    width: 58.33333333%;
  }
  .col-md-6 {
    width: 50%;
  }
  .col-md-5 {
    width: 41.66666667%;
  }
  .col-md-4 {
    width: 33.33333333%;
  }
  .col-md-3 {
    width: 25%;
  }
  .col-md-2 {
    width: 16.66666667%;
  }
  .col-md-1 {
    width: 8.33333333%;
  }
  .col-md-pull-12 {
    right: 100%;
  }
  .col-md-pull-11 {
    right: 91.66666667%;
  }
  .col-md-pull-10 {
    right: 83.33333333%;
  }
  .col-md-pull-9 {
    right: 75%;
  }
  .col-md-pull-8 {
    right: 66.66666667%;
  }
  .col-md-pull-7 {
    right: 58.33333333%;
  }
  .col-md-pull-6 {
    right: 50%;
  }
  .col-md-pull-5 {
    right: 41.66666667%;
  }
  .col-md-pull-4 {
    right: 33.33333333%;
  }
  .col-md-pull-3 {
    right: 25%;
  }
  .col-md-pull-2 {
    right: 16.66666667%;
  }
  .col-md-pull-1 {
    right: 8.33333333%;
  }
  .col-md-pull-0 {
    right: auto;
  }
  .col-md-push-12 {
    left: 100%;
  }
  .col-md-push-11 {
    left: 91.66666667%;
  }
  .col-md-push-10 {
    left: 83.33333333%;
  }
  .col-md-push-9 {
    left: 75%;
  }
  .col-md-push-8 {
    left: 66.66666667%;
  }
  .col-md-push-7 {
    left: 58.33333333%;
  }
  .col-md-push-6 {
    left: 50%;
  }
  .col-md-push-5 {
    left: 41.66666667%;
  }
  .col-md-push-4 {
    left: 33.33333333%;
  }
  .col-md-push-3 {
    left: 25%;
  }
  .col-md-push-2 {
    left: 16.66666667%;
  }
  .col-md-push-1 {
    left: 8.33333333%;
  }
  .col-md-push-0 {
    left: auto;
  }
  .col-md-offset-12 {
    margin-left: 100%;
  }
  .col-md-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-md-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-md-offset-9 {
    margin-left: 75%;
  }
  .col-md-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-md-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-md-offset-6 {
    margin-left: 50%;
  }
  .col-md-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-md-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-md-offset-3 {
    margin-left: 25%;
  }
  .col-md-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-md-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-md-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 1200px) {
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {
    float: left;
  }
  .col-lg-12 {
    width: 100%;
  }
  .col-lg-11 {
    width: 91.66666667%;
  }
  .col-lg-10 {
    width: 83.33333333%;
  }
  .col-lg-9 {
    width: 75%;
  }
  .col-lg-8 {
    width: 66.66666667%;
  }
  .col-lg-7 {
    width: 58.33333333%;
  }
  .col-lg-6 {
    width: 50%;
  }
  .col-lg-5 {
    width: 41.66666667%;
  }
  .col-lg-4 {
    width: 33.33333333%;
  }
  .col-lg-3 {
    width: 25%;
  }
  .col-lg-2 {
    width: 16.66666667%;
  }
  .col-lg-1 {
    width: 8.33333333%;
  }
  .col-lg-pull-12 {
    right: 100%;
  }
  .col-lg-pull-11 {
    right: 91.66666667%;
  }
  .col-lg-pull-10 {
    right: 83.33333333%;
  }
  .col-lg-pull-9 {
    right: 75%;
  }
  .col-lg-pull-8 {
    right: 66.66666667%;
  }
  .col-lg-pull-7 {
    right: 58.33333333%;
  }
  .col-lg-pull-6 {
    right: 50%;
  }
  .col-lg-pull-5 {
    right: 41.66666667%;
  }
  .col-lg-pull-4 {
    right: 33.33333333%;
  }
  .col-lg-pull-3 {
    right: 25%;
  }
  .col-lg-pull-2 {
    right: 16.66666667%;
  }
  .col-lg-pull-1 {
    right: 8.33333333%;
  }
  .col-lg-pull-0 {
    right: auto;
  }
  .col-lg-push-12 {
    left: 100%;
  }
  .col-lg-push-11 {
    left: 91.66666667%;
  }
  .col-lg-push-10 {
    left: 83.33333333%;
  }
  .col-lg-push-9 {
    left: 75%;
  }
  .col-lg-push-8 {
    left: 66.66666667%;
  }
  .col-lg-push-7 {
    left: 58.33333333%;
  }
  .col-lg-push-6 {
    left: 50%;
  }
  .col-lg-push-5 {
    left: 41.66666667%;
  }
  .col-lg-push-4 {
    left: 33.33333333%;
  }
  .col-lg-push-3 {
    left: 25%;
  }
  .col-lg-push-2 {
    left: 16.66666667%;
  }
  .col-lg-push-1 {
    left: 8.33333333%;
  }
  .col-lg-push-0 {
    left: auto;
  }
  .col-lg-offset-12 {
    margin-left: 100%;
  }
  .col-lg-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-lg-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-lg-offset-9 {
    margin-left: 75%;
  }
  .col-lg-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-lg-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-lg-offset-6 {
    margin-left: 50%;
  }
  .col-lg-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-lg-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-lg-offset-3 {
    margin-left: 25%;
  }
  .col-lg-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-lg-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-lg-offset-0 {
    margin-left: 0%;
  }
}
table {
  background-color: transparent;
}
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #777777;
  text-align: left;
}
th {
  text-align: left;
}
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 18px;
}
.table > thead > tr > th,
.table > tbody > tr > th,
.table > tfoot > tr > th,
.table > thead > tr > td,
.table > tbody > tr > td,
.table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: top;
  border-top: 1px solid #ddd;
}
.table > thead > tr > th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table > caption + thead > tr:first-child > th,
.table > colgroup + thead > tr:first-child > th,
.table > thead:first-child > tr:first-child > th,
.table > caption + thead > tr:first-child > td,
.table > colgroup + thead > tr:first-child > td,
.table > thead:first-child > tr:first-child > td {
  border-top: 0;
}
.table > tbody + tbody {
  border-top: 2px solid #ddd;
}
.table .table {
  background-color: #fff;
}
.table-condensed > thead > tr > th,
.table-condensed > tbody > tr > th,
.table-condensed > tfoot > tr > th,
.table-condensed > thead > tr > td,
.table-condensed > tbody > tr > td,
.table-condensed > tfoot > tr > td {
  padding: 5px;
}
.table-bordered {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > tbody > tr > th,
.table-bordered > tfoot > tr > th,
.table-bordered > thead > tr > td,
.table-bordered > tbody > tr > td,
.table-bordered > tfoot > tr > td {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > thead > tr > td {
  border-bottom-width: 2px;
}
.table-striped > tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.table-hover > tbody > tr:hover {
  background-color: #f5f5f5;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}
.table > thead > tr > td.active,
.table > tbody > tr > td.active,
.table > tfoot > tr > td.active,
.table > thead > tr > th.active,
.table > tbody > tr > th.active,
.table > tfoot > tr > th.active,
.table > thead > tr.active > td,
.table > tbody > tr.active > td,
.table > tfoot > tr.active > td,
.table > thead > tr.active > th,
.table > tbody > tr.active > th,
.table > tfoot > tr.active > th {
  background-color: #f5f5f5;
}
.table-hover > tbody > tr > td.active:hover,
.table-hover > tbody > tr > th.active:hover,
.table-hover > tbody > tr.active:hover > td,
.table-hover > tbody > tr:hover > .active,
.table-hover > tbody > tr.active:hover > th {
  background-color: #e8e8e8;
}
.table > thead > tr > td.success,
.table > tbody > tr > td.success,
.table > tfoot > tr > td.success,
.table > thead > tr > th.success,
.table > tbody > tr > th.success,
.table > tfoot > tr > th.success,
.table > thead > tr.success > td,
.table > tbody > tr.success > td,
.table > tfoot > tr.success > td,
.table > thead > tr.success > th,
.table > tbody > tr.success > th,
.table > tfoot > tr.success > th {
  background-color: #dff0d8;
}
.table-hover > tbody > tr > td.success:hover,
.table-hover > tbody > tr > th.success:hover,
.table-hover > tbody > tr.success:hover > td,
.table-hover > tbody > tr:hover > .success,
.table-hover > tbody > tr.success:hover > th {
  background-color: #d0e9c6;
}
.table > thead > tr > td.info,
.table > tbody > tr > td.info,
.table > tfoot > tr > td.info,
.table > thead > tr > th.info,
.table > tbody > tr > th.info,
.table > tfoot > tr > th.info,
.table > thead > tr.info > td,
.table > tbody > tr.info > td,
.table > tfoot > tr.info > td,
.table > thead > tr.info > th,
.table > tbody > tr.info > th,
.table > tfoot > tr.info > th {
  background-color: #d9edf7;
}
.table-hover > tbody > tr > td.info:hover,
.table-hover > tbody > tr > th.info:hover,
.table-hover > tbody > tr.info:hover > td,
.table-hover > tbody > tr:hover > .info,
.table-hover > tbody > tr.info:hover > th {
  background-color: #c4e3f3;
}
.table > thead > tr > td.warning,
.table > tbody > tr > td.warning,
.table > tfoot > tr > td.warning,
.table > thead > tr > th.warning,
.table > tbody > tr > th.warning,
.table > tfoot > tr > th.warning,
.table > thead > tr.warning > td,
.table > tbody > tr.warning > td,
.table > tfoot > tr.warning > td,
.table > thead > tr.warning > th,
.table > tbody > tr.warning > th,
.table > tfoot > tr.warning > th {
  background-color: #fcf8e3;
}
.table-hover > tbody > tr > td.warning:hover,
.table-hover > tbody > tr > th.warning:hover,
.table-hover > tbody > tr.warning:hover > td,
.table-hover > tbody > tr:hover > .warning,
.table-hover > tbody > tr.warning:hover > th {
  background-color: #faf2cc;
}
.table > thead > tr > td.danger,
.table > tbody > tr > td.danger,
.table > tfoot > tr > td.danger,
.table > thead > tr > th.danger,
.table > tbody > tr > th.danger,
.table > tfoot > tr > th.danger,
.table > thead > tr.danger > td,
.table > tbody > tr.danger > td,
.table > tfoot > tr.danger > td,
.table > thead > tr.danger > th,
.table > tbody > tr.danger > th,
.table > tfoot > tr.danger > th {
  background-color: #f2dede;
}
.table-hover > tbody > tr > td.danger:hover,
.table-hover > tbody > tr > th.danger:hover,
.table-hover > tbody > tr.danger:hover > td,
.table-hover > tbody > tr:hover > .danger,
.table-hover > tbody > tr.danger:hover > th {
  background-color: #ebcccc;
}
.table-responsive {
  overflow-x: auto;
  min-height: 0.01%;
}
@media screen and (max-width: 767px) {
  .table-responsive {
    width: 100%;
    margin-bottom: 13.5px;
    overflow-y: hidden;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    border: 1px solid #ddd;
  }
  .table-responsive > .table {
    margin-bottom: 0;
  }
  .table-responsive > .table > thead > tr > th,
  .table-responsive > .table > tbody > tr > th,
  .table-responsive > .table > tfoot > tr > th,
  .table-responsive > .table > thead > tr > td,
  .table-responsive > .table > tbody > tr > td,
  .table-responsive > .table > tfoot > tr > td {
    white-space: nowrap;
  }
  .table-responsive > .table-bordered {
    border: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:first-child,
  .table-responsive > .table-bordered > tbody > tr > th:first-child,
  .table-responsive > .table-bordered > tfoot > tr > th:first-child,
  .table-responsive > .table-bordered > thead > tr > td:first-child,
  .table-responsive > .table-bordered > tbody > tr > td:first-child,
  .table-responsive > .table-bordered > tfoot > tr > td:first-child {
    border-left: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:last-child,
  .table-responsive > .table-bordered > tbody > tr > th:last-child,
  .table-responsive > .table-bordered > tfoot > tr > th:last-child,
  .table-responsive > .table-bordered > thead > tr > td:last-child,
  .table-responsive > .table-bordered > tbody > tr > td:last-child,
  .table-responsive > .table-bordered > tfoot > tr > td:last-child {
    border-right: 0;
  }
  .table-responsive > .table-bordered > tbody > tr:last-child > th,
  .table-responsive > .table-bordered > tfoot > tr:last-child > th,
  .table-responsive > .table-bordered > tbody > tr:last-child > td,
  .table-responsive > .table-bordered > tfoot > tr:last-child > td {
    border-bottom: 0;
  }
}
fieldset {
  padding: 0;
  margin: 0;
  border: 0;
  min-width: 0;
}
legend {
  display: block;
  width: 100%;
  padding: 0;
  margin-bottom: 18px;
  font-size: 19.5px;
  line-height: inherit;
  color: #333333;
  border: 0;
  border-bottom: 1px solid #e5e5e5;
}
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: bold;
}
input[type="search"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
input[type="radio"],
input[type="checkbox"] {
  margin: 4px 0 0;
  margin-top: 1px \9;
  line-height: normal;
}
input[type="file"] {
  display: block;
}
input[type="range"] {
  display: block;
  width: 100%;
}
select[multiple],
select[size] {
  height: auto;
}
input[type="file"]:focus,
input[type="radio"]:focus,
input[type="checkbox"]:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
output {
  display: block;
  padding-top: 7px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
}
.form-control {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
.form-control:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.form-control::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.form-control:-ms-input-placeholder {
  color: #999;
}
.form-control::-webkit-input-placeholder {
  color: #999;
}
.form-control::-ms-expand {
  border: 0;
  background-color: transparent;
}
.form-control[disabled],
.form-control[readonly],
fieldset[disabled] .form-control {
  background-color: #eeeeee;
  opacity: 1;
}
.form-control[disabled],
fieldset[disabled] .form-control {
  cursor: not-allowed;
}
textarea.form-control {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: none;
}
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  input[type="date"].form-control,
  input[type="time"].form-control,
  input[type="datetime-local"].form-control,
  input[type="month"].form-control {
    line-height: 32px;
  }
  input[type="date"].input-sm,
  input[type="time"].input-sm,
  input[type="datetime-local"].input-sm,
  input[type="month"].input-sm,
  .input-group-sm input[type="date"],
  .input-group-sm input[type="time"],
  .input-group-sm input[type="datetime-local"],
  .input-group-sm input[type="month"] {
    line-height: 30px;
  }
  input[type="date"].input-lg,
  input[type="time"].input-lg,
  input[type="datetime-local"].input-lg,
  input[type="month"].input-lg,
  .input-group-lg input[type="date"],
  .input-group-lg input[type="time"],
  .input-group-lg input[type="datetime-local"],
  .input-group-lg input[type="month"] {
    line-height: 45px;
  }
}
.form-group {
  margin-bottom: 15px;
}
.radio,
.checkbox {
  position: relative;
  display: block;
  margin-top: 10px;
  margin-bottom: 10px;
}
.radio label,
.checkbox label {
  min-height: 18px;
  padding-left: 20px;
  margin-bottom: 0;
  font-weight: normal;
  cursor: pointer;
}
.radio input[type="radio"],
.radio-inline input[type="radio"],
.checkbox input[type="checkbox"],
.checkbox-inline input[type="checkbox"] {
  position: absolute;
  margin-left: -20px;
  margin-top: 4px \9;
}
.radio + .radio,
.checkbox + .checkbox {
  margin-top: -5px;
}
.radio-inline,
.checkbox-inline {
  position: relative;
  display: inline-block;
  padding-left: 20px;
  margin-bottom: 0;
  vertical-align: middle;
  font-weight: normal;
  cursor: pointer;
}
.radio-inline + .radio-inline,
.checkbox-inline + .checkbox-inline {
  margin-top: 0;
  margin-left: 10px;
}
input[type="radio"][disabled],
input[type="checkbox"][disabled],
input[type="radio"].disabled,
input[type="checkbox"].disabled,
fieldset[disabled] input[type="radio"],
fieldset[disabled] input[type="checkbox"] {
  cursor: not-allowed;
}
.radio-inline.disabled,
.checkbox-inline.disabled,
fieldset[disabled] .radio-inline,
fieldset[disabled] .checkbox-inline {
  cursor: not-allowed;
}
.radio.disabled label,
.checkbox.disabled label,
fieldset[disabled] .radio label,
fieldset[disabled] .checkbox label {
  cursor: not-allowed;
}
.form-control-static {
  padding-top: 7px;
  padding-bottom: 7px;
  margin-bottom: 0;
  min-height: 31px;
}
.form-control-static.input-lg,
.form-control-static.input-sm {
  padding-left: 0;
  padding-right: 0;
}
.input-sm {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-sm {
  height: 30px;
  line-height: 30px;
}
textarea.input-sm,
select[multiple].input-sm {
  height: auto;
}
.form-group-sm .form-control {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.form-group-sm select.form-control {
  height: 30px;
  line-height: 30px;
}
.form-group-sm textarea.form-control,
.form-group-sm select[multiple].form-control {
  height: auto;
}
.form-group-sm .form-control-static {
  height: 30px;
  min-height: 30px;
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.input-lg {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-lg {
  height: 45px;
  line-height: 45px;
}
textarea.input-lg,
select[multiple].input-lg {
  height: auto;
}
.form-group-lg .form-control {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.form-group-lg select.form-control {
  height: 45px;
  line-height: 45px;
}
.form-group-lg textarea.form-control,
.form-group-lg select[multiple].form-control {
  height: auto;
}
.form-group-lg .form-control-static {
  height: 45px;
  min-height: 35px;
  padding: 11px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.has-feedback {
  position: relative;
}
.has-feedback .form-control {
  padding-right: 40px;
}
.form-control-feedback {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  display: block;
  width: 32px;
  height: 32px;
  line-height: 32px;
  text-align: center;
  pointer-events: none;
}
.input-lg + .form-control-feedback,
.input-group-lg + .form-control-feedback,
.form-group-lg .form-control + .form-control-feedback {
  width: 45px;
  height: 45px;
  line-height: 45px;
}
.input-sm + .form-control-feedback,
.input-group-sm + .form-control-feedback,
.form-group-sm .form-control + .form-control-feedback {
  width: 30px;
  height: 30px;
  line-height: 30px;
}
.has-success .help-block,
.has-success .control-label,
.has-success .radio,
.has-success .checkbox,
.has-success .radio-inline,
.has-success .checkbox-inline,
.has-success.radio label,
.has-success.checkbox label,
.has-success.radio-inline label,
.has-success.checkbox-inline label {
  color: #3c763d;
}
.has-success .form-control {
  border-color: #3c763d;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-success .form-control:focus {
  border-color: #2b542c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
}
.has-success .input-group-addon {
  color: #3c763d;
  border-color: #3c763d;
  background-color: #dff0d8;
}
.has-success .form-control-feedback {
  color: #3c763d;
}
.has-warning .help-block,
.has-warning .control-label,
.has-warning .radio,
.has-warning .checkbox,
.has-warning .radio-inline,
.has-warning .checkbox-inline,
.has-warning.radio label,
.has-warning.checkbox label,
.has-warning.radio-inline label,
.has-warning.checkbox-inline label {
  color: #8a6d3b;
}
.has-warning .form-control {
  border-color: #8a6d3b;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-warning .form-control:focus {
  border-color: #66512c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
}
.has-warning .input-group-addon {
  color: #8a6d3b;
  border-color: #8a6d3b;
  background-color: #fcf8e3;
}
.has-warning .form-control-feedback {
  color: #8a6d3b;
}
.has-error .help-block,
.has-error .control-label,
.has-error .radio,
.has-error .checkbox,
.has-error .radio-inline,
.has-error .checkbox-inline,
.has-error.radio label,
.has-error.checkbox label,
.has-error.radio-inline label,
.has-error.checkbox-inline label {
  color: #a94442;
}
.has-error .form-control {
  border-color: #a94442;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-error .form-control:focus {
  border-color: #843534;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
}
.has-error .input-group-addon {
  color: #a94442;
  border-color: #a94442;
  background-color: #f2dede;
}
.has-error .form-control-feedback {
  color: #a94442;
}
.has-feedback label ~ .form-control-feedback {
  top: 23px;
}
.has-feedback label.sr-only ~ .form-control-feedback {
  top: 0;
}
.help-block {
  display: block;
  margin-top: 5px;
  margin-bottom: 10px;
  color: #404040;
}
@media (min-width: 768px) {
  .form-inline .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .form-inline .form-control-static {
    display: inline-block;
  }
  .form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .form-inline .input-group .input-group-addon,
  .form-inline .input-group .input-group-btn,
  .form-inline .input-group .form-control {
    width: auto;
  }
  .form-inline .input-group > .form-control {
    width: 100%;
  }
  .form-inline .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio,
  .form-inline .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio label,
  .form-inline .checkbox label {
    padding-left: 0;
  }
  .form-inline .radio input[type="radio"],
  .form-inline .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .form-inline .has-feedback .form-control-feedback {
    top: 0;
  }
}
.form-horizontal .radio,
.form-horizontal .checkbox,
.form-horizontal .radio-inline,
.form-horizontal .checkbox-inline {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 7px;
}
.form-horizontal .radio,
.form-horizontal .checkbox {
  min-height: 25px;
}
.form-horizontal .form-group {
  margin-left: 0px;
  margin-right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .control-label {
    text-align: right;
    margin-bottom: 0;
    padding-top: 7px;
  }
}
.form-horizontal .has-feedback .form-control-feedback {
  right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .form-group-lg .control-label {
    padding-top: 11px;
    font-size: 17px;
  }
}
@media (min-width: 768px) {
  .form-horizontal .form-group-sm .control-label {
    padding-top: 6px;
    font-size: 12px;
  }
}
.btn {
  display: inline-block;
  margin-bottom: 0;
  font-weight: normal;
  text-align: center;
  vertical-align: middle;
  touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  white-space: nowrap;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  border-radius: 2px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #333;
  text-decoration: none;
}
.btn:active,
.btn.active {
  outline: 0;
  background-image: none;
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  opacity: 0.65;
  filter: alpha(opacity=65);
  -webkit-box-shadow: none;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn-default:focus,
.btn-default.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.btn-default:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active:hover,
.btn-default.active:hover,
.open > .dropdown-toggle.btn-default:hover,
.btn-default:active:focus,
.btn-default.active:focus,
.open > .dropdown-toggle.btn-default:focus,
.btn-default:active.focus,
.btn-default.active.focus,
.open > .dropdown-toggle.btn-default.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  background-image: none;
}
.btn-default.disabled:hover,
.btn-default[disabled]:hover,
fieldset[disabled] .btn-default:hover,
.btn-default.disabled:focus,
.btn-default[disabled]:focus,
fieldset[disabled] .btn-default:focus,
.btn-default.disabled.focus,
.btn-default[disabled].focus,
fieldset[disabled] .btn-default.focus {
  background-color: #fff;
  border-color: #ccc;
}
.btn-default .badge {
  color: #fff;
  background-color: #333;
}
.btn-primary {
  color: #fff;
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary:focus,
.btn-primary.focus {
  color: #fff;
  background-color: #286090;
  border-color: #122b40;
}
.btn-primary:hover {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active:hover,
.btn-primary.active:hover,
.open > .dropdown-toggle.btn-primary:hover,
.btn-primary:active:focus,
.btn-primary.active:focus,
.open > .dropdown-toggle.btn-primary:focus,
.btn-primary:active.focus,
.btn-primary.active.focus,
.open > .dropdown-toggle.btn-primary.focus {
  color: #fff;
  background-color: #204d74;
  border-color: #122b40;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  background-image: none;
}
.btn-primary.disabled:hover,
.btn-primary[disabled]:hover,
fieldset[disabled] .btn-primary:hover,
.btn-primary.disabled:focus,
.btn-primary[disabled]:focus,
fieldset[disabled] .btn-primary:focus,
.btn-primary.disabled.focus,
.btn-primary[disabled].focus,
fieldset[disabled] .btn-primary.focus {
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary .badge {
  color: #337ab7;
  background-color: #fff;
}
.btn-success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success:focus,
.btn-success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.btn-success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active:hover,
.btn-success.active:hover,
.open > .dropdown-toggle.btn-success:hover,
.btn-success:active:focus,
.btn-success.active:focus,
.open > .dropdown-toggle.btn-success:focus,
.btn-success:active.focus,
.btn-success.active.focus,
.open > .dropdown-toggle.btn-success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  background-image: none;
}
.btn-success.disabled:hover,
.btn-success[disabled]:hover,
fieldset[disabled] .btn-success:hover,
.btn-success.disabled:focus,
.btn-success[disabled]:focus,
fieldset[disabled] .btn-success:focus,
.btn-success.disabled.focus,
.btn-success[disabled].focus,
fieldset[disabled] .btn-success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.btn-info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info:focus,
.btn-info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.btn-info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active:hover,
.btn-info.active:hover,
.open > .dropdown-toggle.btn-info:hover,
.btn-info:active:focus,
.btn-info.active:focus,
.open > .dropdown-toggle.btn-info:focus,
.btn-info:active.focus,
.btn-info.active.focus,
.open > .dropdown-toggle.btn-info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  background-image: none;
}
.btn-info.disabled:hover,
.btn-info[disabled]:hover,
fieldset[disabled] .btn-info:hover,
.btn-info.disabled:focus,
.btn-info[disabled]:focus,
fieldset[disabled] .btn-info:focus,
.btn-info.disabled.focus,
.btn-info[disabled].focus,
fieldset[disabled] .btn-info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.btn-warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning:focus,
.btn-warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.btn-warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active:hover,
.btn-warning.active:hover,
.open > .dropdown-toggle.btn-warning:hover,
.btn-warning:active:focus,
.btn-warning.active:focus,
.open > .dropdown-toggle.btn-warning:focus,
.btn-warning:active.focus,
.btn-warning.active.focus,
.open > .dropdown-toggle.btn-warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  background-image: none;
}
.btn-warning.disabled:hover,
.btn-warning[disabled]:hover,
fieldset[disabled] .btn-warning:hover,
.btn-warning.disabled:focus,
.btn-warning[disabled]:focus,
fieldset[disabled] .btn-warning:focus,
.btn-warning.disabled.focus,
.btn-warning[disabled].focus,
fieldset[disabled] .btn-warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.btn-danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger:focus,
.btn-danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.btn-danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active:hover,
.btn-danger.active:hover,
.open > .dropdown-toggle.btn-danger:hover,
.btn-danger:active:focus,
.btn-danger.active:focus,
.open > .dropdown-toggle.btn-danger:focus,
.btn-danger:active.focus,
.btn-danger.active.focus,
.open > .dropdown-toggle.btn-danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  background-image: none;
}
.btn-danger.disabled:hover,
.btn-danger[disabled]:hover,
fieldset[disabled] .btn-danger:hover,
.btn-danger.disabled:focus,
.btn-danger[disabled]:focus,
fieldset[disabled] .btn-danger:focus,
.btn-danger.disabled.focus,
.btn-danger[disabled].focus,
fieldset[disabled] .btn-danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger .badge {
  color: #d9534f;
  background-color: #fff;
}
.btn-link {
  color: #337ab7;
  font-weight: normal;
  border-radius: 0;
}
.btn-link,
.btn-link:active,
.btn-link.active,
.btn-link[disabled],
fieldset[disabled] .btn-link {
  background-color: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn-link,
.btn-link:hover,
.btn-link:focus,
.btn-link:active {
  border-color: transparent;
}
.btn-link:hover,
.btn-link:focus {
  color: #23527c;
  text-decoration: underline;
  background-color: transparent;
}
.btn-link[disabled]:hover,
fieldset[disabled] .btn-link:hover,
.btn-link[disabled]:focus,
fieldset[disabled] .btn-link:focus {
  color: #777777;
  text-decoration: none;
}
.btn-lg,
.btn-group-lg > .btn {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.btn-sm,
.btn-group-sm > .btn {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-xs,
.btn-group-xs > .btn {
  padding: 1px 5px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-block {
  display: block;
  width: 100%;
}
.btn-block + .btn-block {
  margin-top: 5px;
}
input[type="submit"].btn-block,
input[type="reset"].btn-block,
input[type="button"].btn-block {
  width: 100%;
}
.fade {
  opacity: 0;
  -webkit-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
}
.fade.in {
  opacity: 1;
}
.collapse {
  display: none;
}
.collapse.in {
  display: block;
}
tr.collapse.in {
  display: table-row;
}
tbody.collapse.in {
  display: table-row-group;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  -webkit-transition-property: height, visibility;
  transition-property: height, visibility;
  -webkit-transition-duration: 0.35s;
  transition-duration: 0.35s;
  -webkit-transition-timing-function: ease;
  transition-timing-function: ease;
}
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  margin-left: 2px;
  vertical-align: middle;
  border-top: 4px dashed;
  border-top: 4px solid \9;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
}
.dropup,
.dropdown {
  position: relative;
}
.dropdown-toggle:focus {
  outline: 0;
}
.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  float: left;
  min-width: 160px;
  padding: 5px 0;
  margin: 2px 0 0;
  list-style: none;
  font-size: 13px;
  text-align: left;
  background-color: #fff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  background-clip: padding-box;
}
.dropdown-menu.pull-right {
  right: 0;
  left: auto;
}
.dropdown-menu .divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: normal;
  line-height: 1.42857143;
  color: #333333;
  white-space: nowrap;
}
.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  text-decoration: none;
  color: #262626;
  background-color: #f5f5f5;
}
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #fff;
  text-decoration: none;
  outline: 0;
  background-color: #337ab7;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #777777;
}
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  cursor: not-allowed;
}
.open > .dropdown-menu {
  display: block;
}
.open > a {
  outline: 0;
}
.dropdown-menu-right {
  left: auto;
  right: 0;
}
.dropdown-menu-left {
  left: 0;
  right: auto;
}
.dropdown-header {
  display: block;
  padding: 3px 20px;
  font-size: 12px;
  line-height: 1.42857143;
  color: #777777;
  white-space: nowrap;
}
.dropdown-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 990;
}
.pull-right > .dropdown-menu {
  right: 0;
  left: auto;
}
.dropup .caret,
.navbar-fixed-bottom .dropdown .caret {
  border-top: 0;
  border-bottom: 4px dashed;
  border-bottom: 4px solid \9;
  content: "";
}
.dropup .dropdown-menu,
.navbar-fixed-bottom .dropdown .dropdown-menu {
  top: auto;
  bottom: 100%;
  margin-bottom: 2px;
}
@media (min-width: 541px) {
  .navbar-right .dropdown-menu {
    left: auto;
    right: 0;
  }
  .navbar-right .dropdown-menu-left {
    left: 0;
    right: auto;
  }
}
.btn-group,
.btn-group-vertical {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}
.btn-group > .btn,
.btn-group-vertical > .btn {
  position: relative;
  float: left;
}
.btn-group > .btn:hover,
.btn-group-vertical > .btn:hover,
.btn-group > .btn:focus,
.btn-group-vertical > .btn:focus,
.btn-group > .btn:active,
.btn-group-vertical > .btn:active,
.btn-group > .btn.active,
.btn-group-vertical > .btn.active {
  z-index: 2;
}
.btn-group .btn + .btn,
.btn-group .btn + .btn-group,
.btn-group .btn-group + .btn,
.btn-group .btn-group + .btn-group {
  margin-left: -1px;
}
.btn-toolbar {
  margin-left: -5px;
}
.btn-toolbar .btn,
.btn-toolbar .btn-group,
.btn-toolbar .input-group {
  float: left;
}
.btn-toolbar > .btn,
.btn-toolbar > .btn-group,
.btn-toolbar > .input-group {
  margin-left: 5px;
}
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-left: 8px;
  padding-right: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-left: 12px;
  padding-right: 12px;
}
.btn-group.open .dropdown-toggle {
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn .caret {
  margin-left: 0;
}
.btn-lg .caret {
  border-width: 5px 5px 0;
  border-bottom-width: 0;
}
.dropup .btn-lg .caret {
  border-width: 0 5px 5px;
}
.btn-group-vertical > .btn,
.btn-group-vertical > .btn-group,
.btn-group-vertical > .btn-group > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
}
.btn-group-vertical > .btn-group > .btn {
  float: none;
}
.btn-group-vertical > .btn + .btn,
.btn-group-vertical > .btn + .btn-group,
.btn-group-vertical > .btn-group + .btn,
.btn-group-vertical > .btn-group + .btn-group {
  margin-top: -1px;
  margin-left: 0;
}
.btn-group-vertical > .btn:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.btn-group-vertical > .btn:first-child:not(:last-child) {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn:last-child:not(:first-child) {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.btn-group-justified {
  display: table;
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
}
.btn-group-justified > .btn,
.btn-group-justified > .btn-group {
  float: none;
  display: table-cell;
  width: 1%;
}
.btn-group-justified > .btn-group .btn {
  width: 100%;
}
.btn-group-justified > .btn-group .dropdown-menu {
  left: auto;
}
[data-toggle="buttons"] > .btn input[type="radio"],
[data-toggle="buttons"] > .btn-group > .btn input[type="radio"],
[data-toggle="buttons"] > .btn input[type="checkbox"],
[data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {
  position: absolute;
  clip: rect(0, 0, 0, 0);
  pointer-events: none;
}
.input-group {
  position: relative;
  display: table;
  border-collapse: separate;
}
.input-group[class*="col-"] {
  float: none;
  padding-left: 0;
  padding-right: 0;
}
.input-group .form-control {
  position: relative;
  z-index: 2;
  float: left;
  width: 100%;
  margin-bottom: 0;
}
.input-group .form-control:focus {
  z-index: 3;
}
.input-group-lg > .form-control,
.input-group-lg > .input-group-addon,
.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-group-lg > .form-control,
select.input-group-lg > .input-group-addon,
select.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  line-height: 45px;
}
textarea.input-group-lg > .form-control,
textarea.input-group-lg > .input-group-addon,
textarea.input-group-lg > .input-group-btn > .btn,
select[multiple].input-group-lg > .form-control,
select[multiple].input-group-lg > .input-group-addon,
select[multiple].input-group-lg > .input-group-btn > .btn {
  height: auto;
}
.input-group-sm > .form-control,
.input-group-sm > .input-group-addon,
.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-group-sm > .form-control,
select.input-group-sm > .input-group-addon,
select.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  line-height: 30px;
}
textarea.input-group-sm > .form-control,
textarea.input-group-sm > .input-group-addon,
textarea.input-group-sm > .input-group-btn > .btn,
select[multiple].input-group-sm > .form-control,
select[multiple].input-group-sm > .input-group-addon,
select[multiple].input-group-sm > .input-group-btn > .btn {
  height: auto;
}
.input-group-addon,
.input-group-btn,
.input-group .form-control {
  display: table-cell;
}
.input-group-addon:not(:first-child):not(:last-child),
.input-group-btn:not(:first-child):not(:last-child),
.input-group .form-control:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.input-group-addon,
.input-group-btn {
  width: 1%;
  white-space: nowrap;
  vertical-align: middle;
}
.input-group-addon {
  padding: 6px 12px;
  font-size: 13px;
  font-weight: normal;
  line-height: 1;
  color: #555555;
  text-align: center;
  background-color: #eeeeee;
  border: 1px solid #ccc;
  border-radius: 2px;
}
.input-group-addon.input-sm {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 1px;
}
.input-group-addon.input-lg {
  padding: 10px 16px;
  font-size: 17px;
  border-radius: 3px;
}
.input-group-addon input[type="radio"],
.input-group-addon input[type="checkbox"] {
  margin-top: 0;
}
.input-group .form-control:first-child,
.input-group-addon:first-child,
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group > .btn,
.input-group-btn:first-child > .dropdown-toggle,
.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),
.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.input-group-addon:first-child {
  border-right: 0;
}
.input-group .form-control:last-child,
.input-group-addon:last-child,
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group > .btn,
.input-group-btn:last-child > .dropdown-toggle,
.input-group-btn:first-child > .btn:not(:first-child),
.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.input-group-addon:last-child {
  border-left: 0;
}
.input-group-btn {
  position: relative;
  font-size: 0;
  white-space: nowrap;
}
.input-group-btn > .btn {
  position: relative;
}
.input-group-btn > .btn + .btn {
  margin-left: -1px;
}
.input-group-btn > .btn:hover,
.input-group-btn > .btn:focus,
.input-group-btn > .btn:active {
  z-index: 2;
}
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group {
  margin-right: -1px;
}
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group {
  z-index: 2;
  margin-left: -1px;
}
.nav {
  margin-bottom: 0;
  padding-left: 0;
  list-style: none;
}
.nav > li {
  position: relative;
  display: block;
}
.nav > li > a {
  position: relative;
  display: block;
  padding: 10px 15px;
}
.nav > li > a:hover,
.nav > li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.nav > li.disabled > a {
  color: #777777;
}
.nav > li.disabled > a:hover,
.nav > li.disabled > a:focus {
  color: #777777;
  text-decoration: none;
  background-color: transparent;
  cursor: not-allowed;
}
.nav .open > a,
.nav .open > a:hover,
.nav .open > a:focus {
  background-color: #eeeeee;
  border-color: #337ab7;
}
.nav .nav-divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.nav > li > a > img {
  max-width: none;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  float: left;
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  margin-right: 2px;
  line-height: 1.42857143;
  border: 1px solid transparent;
  border-radius: 2px 2px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #ddd;
}
.nav-tabs > li.active > a,
.nav-tabs > li.active > a:hover,
.nav-tabs > li.active > a:focus {
  color: #555555;
  background-color: #fff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}
.nav-tabs.nav-justified {
  width: 100%;
  border-bottom: 0;
}
.nav-tabs.nav-justified > li {
  float: none;
}
.nav-tabs.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-tabs.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-tabs.nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs.nav-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs.nav-justified > .active > a,
.nav-tabs.nav-justified > .active > a:hover,
.nav-tabs.nav-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs.nav-justified > .active > a,
  .nav-tabs.nav-justified > .active > a:hover,
  .nav-tabs.nav-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.nav-pills > li {
  float: left;
}
.nav-pills > li > a {
  border-radius: 2px;
}
.nav-pills > li + li {
  margin-left: 2px;
}
.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  color: #fff;
  background-color: #337ab7;
}
.nav-stacked > li {
  float: none;
}
.nav-stacked > li + li {
  margin-top: 2px;
  margin-left: 0;
}
.nav-justified {
  width: 100%;
}
.nav-justified > li {
  float: none;
}
.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs-justified {
  border-bottom: 0;
}
.nav-tabs-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs-justified > .active > a,
.nav-tabs-justified > .active > a:hover,
.nav-tabs-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs-justified > .active > a,
  .nav-tabs-justified > .active > a:hover,
  .nav-tabs-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.tab-content > .tab-pane {
  display: none;
}
.tab-content > .active {
  display: block;
}
.nav-tabs .dropdown-menu {
  margin-top: -1px;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar {
  position: relative;
  min-height: 30px;
  margin-bottom: 18px;
  border: 1px solid transparent;
}
@media (min-width: 541px) {
  .navbar {
    border-radius: 2px;
  }
}
@media (min-width: 541px) {
  .navbar-header {
    float: left;
  }
}
.navbar-collapse {
  overflow-x: visible;
  padding-right: 0px;
  padding-left: 0px;
  border-top: 1px solid transparent;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
  -webkit-overflow-scrolling: touch;
}
.navbar-collapse.in {
  overflow-y: auto;
}
@media (min-width: 541px) {
  .navbar-collapse {
    width: auto;
    border-top: 0;
    box-shadow: none;
  }
  .navbar-collapse.collapse {
    display: block !important;
    height: auto !important;
    padding-bottom: 0;
    overflow: visible !important;
  }
  .navbar-collapse.in {
    overflow-y: visible;
  }
  .navbar-fixed-top .navbar-collapse,
  .navbar-static-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    padding-left: 0;
    padding-right: 0;
  }
}
.navbar-fixed-top .navbar-collapse,
.navbar-fixed-bottom .navbar-collapse {
  max-height: 340px;
}
@media (max-device-width: 540px) and (orientation: landscape) {
  .navbar-fixed-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    max-height: 200px;
  }
}
.container > .navbar-header,
.container-fluid > .navbar-header,
.container > .navbar-collapse,
.container-fluid > .navbar-collapse {
  margin-right: 0px;
  margin-left: 0px;
}
@media (min-width: 541px) {
  .container > .navbar-header,
  .container-fluid > .navbar-header,
  .container > .navbar-collapse,
  .container-fluid > .navbar-collapse {
    margin-right: 0;
    margin-left: 0;
  }
}
.navbar-static-top {
  z-index: 1000;
  border-width: 0 0 1px;
}
@media (min-width: 541px) {
  .navbar-static-top {
    border-radius: 0;
  }
}
.navbar-fixed-top,
.navbar-fixed-bottom {
  position: fixed;
  right: 0;
  left: 0;
  z-index: 1030;
}
@media (min-width: 541px) {
  .navbar-fixed-top,
  .navbar-fixed-bottom {
    border-radius: 0;
  }
}
.navbar-fixed-top {
  top: 0;
  border-width: 0 0 1px;
}
.navbar-fixed-bottom {
  bottom: 0;
  margin-bottom: 0;
  border-width: 1px 0 0;
}
.navbar-brand {
  float: left;
  padding: 6px 0px;
  font-size: 17px;
  line-height: 18px;
  height: 30px;
}
.navbar-brand:hover,
.navbar-brand:focus {
  text-decoration: none;
}
.navbar-brand > img {
  display: block;
}
@media (min-width: 541px) {
  .navbar > .container .navbar-brand,
  .navbar > .container-fluid .navbar-brand {
    margin-left: 0px;
  }
}
.navbar-toggle {
  position: relative;
  float: right;
  margin-right: 0px;
  padding: 9px 10px;
  margin-top: -2px;
  margin-bottom: -2px;
  background-color: transparent;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 2px;
}
.navbar-toggle:focus {
  outline: 0;
}
.navbar-toggle .icon-bar {
  display: block;
  width: 22px;
  height: 2px;
  border-radius: 1px;
}
.navbar-toggle .icon-bar + .icon-bar {
  margin-top: 4px;
}
@media (min-width: 541px) {
  .navbar-toggle {
    display: none;
  }
}
.navbar-nav {
  margin: 3px 0px;
}
.navbar-nav > li > a {
  padding-top: 10px;
  padding-bottom: 10px;
  line-height: 18px;
}
@media (max-width: 540px) {
  .navbar-nav .open .dropdown-menu {
    position: static;
    float: none;
    width: auto;
    margin-top: 0;
    background-color: transparent;
    border: 0;
    box-shadow: none;
  }
  .navbar-nav .open .dropdown-menu > li > a,
  .navbar-nav .open .dropdown-menu .dropdown-header {
    padding: 5px 15px 5px 25px;
  }
  .navbar-nav .open .dropdown-menu > li > a {
    line-height: 18px;
  }
  .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-nav .open .dropdown-menu > li > a:focus {
    background-image: none;
  }
}
@media (min-width: 541px) {
  .navbar-nav {
    float: left;
    margin: 0;
  }
  .navbar-nav > li {
    float: left;
  }
  .navbar-nav > li > a {
    padding-top: 6px;
    padding-bottom: 6px;
  }
}
.navbar-form {
  margin-left: 0px;
  margin-right: 0px;
  padding: 10px 0px;
  border-top: 1px solid transparent;
  border-bottom: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  margin-top: -1px;
  margin-bottom: -1px;
}
@media (min-width: 768px) {
  .navbar-form .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .navbar-form .form-control-static {
    display: inline-block;
  }
  .navbar-form .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .navbar-form .input-group .input-group-addon,
  .navbar-form .input-group .input-group-btn,
  .navbar-form .input-group .form-control {
    width: auto;
  }
  .navbar-form .input-group > .form-control {
    width: 100%;
  }
  .navbar-form .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio,
  .navbar-form .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio label,
  .navbar-form .checkbox label {
    padding-left: 0;
  }
  .navbar-form .radio input[type="radio"],
  .navbar-form .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .navbar-form .has-feedback .form-control-feedback {
    top: 0;
  }
}
@media (max-width: 540px) {
  .navbar-form .form-group {
    margin-bottom: 5px;
  }
  .navbar-form .form-group:last-child {
    margin-bottom: 0;
  }
}
@media (min-width: 541px) {
  .navbar-form {
    width: auto;
    border: 0;
    margin-left: 0;
    margin-right: 0;
    padding-top: 0;
    padding-bottom: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}
.navbar-nav > li > .dropdown-menu {
  margin-top: 0;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {
  margin-bottom: 0;
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.navbar-btn {
  margin-top: -1px;
  margin-bottom: -1px;
}
.navbar-btn.btn-sm {
  margin-top: 0px;
  margin-bottom: 0px;
}
.navbar-btn.btn-xs {
  margin-top: 4px;
  margin-bottom: 4px;
}
.navbar-text {
  margin-top: 6px;
  margin-bottom: 6px;
}
@media (min-width: 541px) {
  .navbar-text {
    float: left;
    margin-left: 0px;
    margin-right: 0px;
  }
}
@media (min-width: 541px) {
  .navbar-left {
    float: left !important;
    float: left;
  }
  .navbar-right {
    float: right !important;
    float: right;
    margin-right: 0px;
  }
  .navbar-right ~ .navbar-right {
    margin-right: 0;
  }
}
.navbar-default {
  background-color: #f8f8f8;
  border-color: #e7e7e7;
}
.navbar-default .navbar-brand {
  color: #777;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #5e5e5e;
  background-color: transparent;
}
.navbar-default .navbar-text {
  color: #777;
}
.navbar-default .navbar-nav > li > a {
  color: #777;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #333;
  background-color: transparent;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #555;
  background-color: #e7e7e7;
}
.navbar-default .navbar-nav > .disabled > a,
.navbar-default .navbar-nav > .disabled > a:hover,
.navbar-default .navbar-nav > .disabled > a:focus {
  color: #ccc;
  background-color: transparent;
}
.navbar-default .navbar-toggle {
  border-color: #ddd;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #ddd;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #888;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #e7e7e7;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  background-color: #e7e7e7;
  color: #555;
}
@media (max-width: 540px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #777;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #333;
    background-color: transparent;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #555;
    background-color: #e7e7e7;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #ccc;
    background-color: transparent;
  }
}
.navbar-default .navbar-link {
  color: #777;
}
.navbar-default .navbar-link:hover {
  color: #333;
}
.navbar-default .btn-link {
  color: #777;
}
.navbar-default .btn-link:hover,
.navbar-default .btn-link:focus {
  color: #333;
}
.navbar-default .btn-link[disabled]:hover,
fieldset[disabled] .navbar-default .btn-link:hover,
.navbar-default .btn-link[disabled]:focus,
fieldset[disabled] .navbar-default .btn-link:focus {
  color: #ccc;
}
.navbar-inverse {
  background-color: #222;
  border-color: #080808;
}
.navbar-inverse .navbar-brand {
  color: #9d9d9d;
}
.navbar-inverse .navbar-brand:hover,
.navbar-inverse .navbar-brand:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-text {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: #fff;
  background-color: #080808;
}
.navbar-inverse .navbar-nav > .disabled > a,
.navbar-inverse .navbar-nav > .disabled > a:hover,
.navbar-inverse .navbar-nav > .disabled > a:focus {
  color: #444;
  background-color: transparent;
}
.navbar-inverse .navbar-toggle {
  border-color: #333;
}
.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #333;
}
.navbar-inverse .navbar-toggle .icon-bar {
  background-color: #fff;
}
.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #101010;
}
.navbar-inverse .navbar-nav > .open > a,
.navbar-inverse .navbar-nav > .open > a:hover,
.navbar-inverse .navbar-nav > .open > a:focus {
  background-color: #080808;
  color: #fff;
}
@media (max-width: 540px) {
  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {
    border-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {
    color: #9d9d9d;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #fff;
    background-color: transparent;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #fff;
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #444;
    background-color: transparent;
  }
}
.navbar-inverse .navbar-link {
  color: #9d9d9d;
}
.navbar-inverse .navbar-link:hover {
  color: #fff;
}
.navbar-inverse .btn-link {
  color: #9d9d9d;
}
.navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link:focus {
  color: #fff;
}
.navbar-inverse .btn-link[disabled]:hover,
fieldset[disabled] .navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link[disabled]:focus,
fieldset[disabled] .navbar-inverse .btn-link:focus {
  color: #444;
}
.breadcrumb {
  padding: 8px 15px;
  margin-bottom: 18px;
  list-style: none;
  background-color: #f5f5f5;
  border-radius: 2px;
}
.breadcrumb > li {
  display: inline-block;
}
.breadcrumb > li + li:before {
  content: "/\00a0";
  padding: 0 5px;
  color: #5e5e5e;
}
.breadcrumb > .active {
  color: #777777;
}
.pagination {
  display: inline-block;
  padding-left: 0;
  margin: 18px 0;
  border-radius: 2px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  line-height: 1.42857143;
  text-decoration: none;
  color: #337ab7;
  background-color: #fff;
  border: 1px solid #ddd;
  margin-left: -1px;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-bottom-right-radius: 2px;
  border-top-right-radius: 2px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eeeeee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
  cursor: default;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777777;
  background-color: #fff;
  border-color: #ddd;
  cursor: not-allowed;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-bottom-left-radius: 3px;
  border-top-left-radius: 3px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-bottom-right-radius: 3px;
  border-top-right-radius: 3px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-bottom-left-radius: 1px;
  border-top-left-radius: 1px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-bottom-right-radius: 1px;
  border-top-right-radius: 1px;
}
.pager {
  padding-left: 0;
  margin: 18px 0;
  list-style: none;
  text-align: center;
}
.pager li {
  display: inline;
}
.pager li > a,
.pager li > span {
  display: inline-block;
  padding: 5px 14px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 15px;
}
.pager li > a:hover,
.pager li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.pager .next > a,
.pager .next > span {
  float: right;
}
.pager .previous > a,
.pager .previous > span {
  float: left;
}
.pager .disabled > a,
.pager .disabled > a:hover,
.pager .disabled > a:focus,
.pager .disabled > span {
  color: #777777;
  background-color: #fff;
  cursor: not-allowed;
}
.label {
  display: inline;
  padding: .2em .6em .3em;
  font-size: 75%;
  font-weight: bold;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: .25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
.badge {
  display: inline-block;
  min-width: 10px;
  padding: 3px 7px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  line-height: 1;
  vertical-align: middle;
  white-space: nowrap;
  text-align: center;
  background-color: #777777;
  border-radius: 10px;
}
.badge:empty {
  display: none;
}
.btn .badge {
  position: relative;
  top: -1px;
}
.btn-xs .badge,
.btn-group-xs > .btn .badge {
  top: 0;
  padding: 1px 5px;
}
a.badge:hover,
a.badge:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.list-group-item.active > .badge,
.nav-pills > .active > a > .badge {
  color: #337ab7;
  background-color: #fff;
}
.list-group-item > .badge {
  float: right;
}
.list-group-item > .badge + .badge {
  margin-right: 5px;
}
.nav-pills > li > a > .badge {
  margin-left: 3px;
}
.jumbotron {
  padding-top: 30px;
  padding-bottom: 30px;
  margin-bottom: 30px;
  color: inherit;
  background-color: #eeeeee;
}
.jumbotron h1,
.jumbotron .h1 {
  color: inherit;
}
.jumbotron p {
  margin-bottom: 15px;
  font-size: 20px;
  font-weight: 200;
}
.jumbotron > hr {
  border-top-color: #d5d5d5;
}
.container .jumbotron,
.container-fluid .jumbotron {
  border-radius: 3px;
  padding-left: 0px;
  padding-right: 0px;
}
.jumbotron .container {
  max-width: 100%;
}
@media screen and (min-width: 768px) {
  .jumbotron {
    padding-top: 48px;
    padding-bottom: 48px;
  }
  .container .jumbotron,
  .container-fluid .jumbotron {
    padding-left: 60px;
    padding-right: 60px;
  }
  .jumbotron h1,
  .jumbotron .h1 {
    font-size: 59px;
  }
}
.thumbnail {
  display: block;
  padding: 4px;
  margin-bottom: 18px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: border 0.2s ease-in-out;
  -o-transition: border 0.2s ease-in-out;
  transition: border 0.2s ease-in-out;
}
.thumbnail > img,
.thumbnail a > img {
  margin-left: auto;
  margin-right: auto;
}
a.thumbnail:hover,
a.thumbnail:focus,
a.thumbnail.active {
  border-color: #337ab7;
}
.thumbnail .caption {
  padding: 9px;
  color: #000;
}
.alert {
  padding: 15px;
  margin-bottom: 18px;
  border: 1px solid transparent;
  border-radius: 2px;
}
.alert h4 {
  margin-top: 0;
  color: inherit;
}
.alert .alert-link {
  font-weight: bold;
}
.alert > p,
.alert > ul {
  margin-bottom: 0;
}
.alert > p + p {
  margin-top: 5px;
}
.alert-dismissable,
.alert-dismissible {
  padding-right: 35px;
}
.alert-dismissable .close,
.alert-dismissible .close {
  position: relative;
  top: -2px;
  right: -21px;
  color: inherit;
}
.alert-success {
  background-color: #dff0d8;
  border-color: #d6e9c6;
  color: #3c763d;
}
.alert-success hr {
  border-top-color: #c9e2b3;
}
.alert-success .alert-link {
  color: #2b542c;
}
.alert-info {
  background-color: #d9edf7;
  border-color: #bce8f1;
  color: #31708f;
}
.alert-info hr {
  border-top-color: #a6e1ec;
}
.alert-info .alert-link {
  color: #245269;
}
.alert-warning {
  background-color: #fcf8e3;
  border-color: #faebcc;
  color: #8a6d3b;
}
.alert-warning hr {
  border-top-color: #f7e1b5;
}
.alert-warning .alert-link {
  color: #66512c;
}
.alert-danger {
  background-color: #f2dede;
  border-color: #ebccd1;
  color: #a94442;
}
.alert-danger hr {
  border-top-color: #e4b9c0;
}
.alert-danger .alert-link {
  color: #843534;
}
@-webkit-keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
@keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
.progress {
  overflow: hidden;
  height: 18px;
  margin-bottom: 18px;
  background-color: #f5f5f5;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 18px;
  color: #fff;
  text-align: center;
  background-color: #337ab7;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  -webkit-transition: width 0.6s ease;
  -o-transition: width 0.6s ease;
  transition: width 0.6s ease;
}
.progress-striped .progress-bar,
.progress-bar-striped {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-size: 40px 40px;
}
.progress.active .progress-bar,
.progress-bar.active {
  -webkit-animation: progress-bar-stripes 2s linear infinite;
  -o-animation: progress-bar-stripes 2s linear infinite;
  animation: progress-bar-stripes 2s linear infinite;
}
.progress-bar-success {
  background-color: #5cb85c;
}
.progress-striped .progress-bar-success {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-info {
  background-color: #5bc0de;
}
.progress-striped .progress-bar-info {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-warning {
  background-color: #f0ad4e;
}
.progress-striped .progress-bar-warning {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-danger {
  background-color: #d9534f;
}
.progress-striped .progress-bar-danger {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.media {
  margin-top: 15px;
}
.media:first-child {
  margin-top: 0;
}
.media,
.media-body {
  zoom: 1;
  overflow: hidden;
}
.media-body {
  width: 10000px;
}
.media-object {
  display: block;
}
.media-object.img-thumbnail {
  max-width: none;
}
.media-right,
.media > .pull-right {
  padding-left: 10px;
}
.media-left,
.media > .pull-left {
  padding-right: 10px;
}
.media-left,
.media-right,
.media-body {
  display: table-cell;
  vertical-align: top;
}
.media-middle {
  vertical-align: middle;
}
.media-bottom {
  vertical-align: bottom;
}
.media-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.media-list {
  padding-left: 0;
  list-style: none;
}
.list-group {
  margin-bottom: 20px;
  padding-left: 0;
}
.list-group-item {
  position: relative;
  display: block;
  padding: 10px 15px;
  margin-bottom: -1px;
  background-color: #fff;
  border: 1px solid #ddd;
}
.list-group-item:first-child {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
}
.list-group-item:last-child {
  margin-bottom: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
a.list-group-item,
button.list-group-item {
  color: #555;
}
a.list-group-item .list-group-item-heading,
button.list-group-item .list-group-item-heading {
  color: #333;
}
a.list-group-item:hover,
button.list-group-item:hover,
a.list-group-item:focus,
button.list-group-item:focus {
  text-decoration: none;
  color: #555;
  background-color: #f5f5f5;
}
button.list-group-item {
  width: 100%;
  text-align: left;
}
.list-group-item.disabled,
.list-group-item.disabled:hover,
.list-group-item.disabled:focus {
  background-color: #eeeeee;
  color: #777777;
  cursor: not-allowed;
}
.list-group-item.disabled .list-group-item-heading,
.list-group-item.disabled:hover .list-group-item-heading,
.list-group-item.disabled:focus .list-group-item-heading {
  color: inherit;
}
.list-group-item.disabled .list-group-item-text,
.list-group-item.disabled:hover .list-group-item-text,
.list-group-item.disabled:focus .list-group-item-text {
  color: #777777;
}
.list-group-item.active,
.list-group-item.active:hover,
.list-group-item.active:focus {
  z-index: 2;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.list-group-item.active .list-group-item-heading,
.list-group-item.active:hover .list-group-item-heading,
.list-group-item.active:focus .list-group-item-heading,
.list-group-item.active .list-group-item-heading > small,
.list-group-item.active:hover .list-group-item-heading > small,
.list-group-item.active:focus .list-group-item-heading > small,
.list-group-item.active .list-group-item-heading > .small,
.list-group-item.active:hover .list-group-item-heading > .small,
.list-group-item.active:focus .list-group-item-heading > .small {
  color: inherit;
}
.list-group-item.active .list-group-item-text,
.list-group-item.active:hover .list-group-item-text,
.list-group-item.active:focus .list-group-item-text {
  color: #c7ddef;
}
.list-group-item-success {
  color: #3c763d;
  background-color: #dff0d8;
}
a.list-group-item-success,
button.list-group-item-success {
  color: #3c763d;
}
a.list-group-item-success .list-group-item-heading,
button.list-group-item-success .list-group-item-heading {
  color: inherit;
}
a.list-group-item-success:hover,
button.list-group-item-success:hover,
a.list-group-item-success:focus,
button.list-group-item-success:focus {
  color: #3c763d;
  background-color: #d0e9c6;
}
a.list-group-item-success.active,
button.list-group-item-success.active,
a.list-group-item-success.active:hover,
button.list-group-item-success.active:hover,
a.list-group-item-success.active:focus,
button.list-group-item-success.active:focus {
  color: #fff;
  background-color: #3c763d;
  border-color: #3c763d;
}
.list-group-item-info {
  color: #31708f;
  background-color: #d9edf7;
}
a.list-group-item-info,
button.list-group-item-info {
  color: #31708f;
}
a.list-group-item-info .list-group-item-heading,
button.list-group-item-info .list-group-item-heading {
  color: inherit;
}
a.list-group-item-info:hover,
button.list-group-item-info:hover,
a.list-group-item-info:focus,
button.list-group-item-info:focus {
  color: #31708f;
  background-color: #c4e3f3;
}
a.list-group-item-info.active,
button.list-group-item-info.active,
a.list-group-item-info.active:hover,
button.list-group-item-info.active:hover,
a.list-group-item-info.active:focus,
button.list-group-item-info.active:focus {
  color: #fff;
  background-color: #31708f;
  border-color: #31708f;
}
.list-group-item-warning {
  color: #8a6d3b;
  background-color: #fcf8e3;
}
a.list-group-item-warning,
button.list-group-item-warning {
  color: #8a6d3b;
}
a.list-group-item-warning .list-group-item-heading,
button.list-group-item-warning .list-group-item-heading {
  color: inherit;
}
a.list-group-item-warning:hover,
button.list-group-item-warning:hover,
a.list-group-item-warning:focus,
button.list-group-item-warning:focus {
  color: #8a6d3b;
  background-color: #faf2cc;
}
a.list-group-item-warning.active,
button.list-group-item-warning.active,
a.list-group-item-warning.active:hover,
button.list-group-item-warning.active:hover,
a.list-group-item-warning.active:focus,
button.list-group-item-warning.active:focus {
  color: #fff;
  background-color: #8a6d3b;
  border-color: #8a6d3b;
}
.list-group-item-danger {
  color: #a94442;
  background-color: #f2dede;
}
a.list-group-item-danger,
button.list-group-item-danger {
  color: #a94442;
}
a.list-group-item-danger .list-group-item-heading,
button.list-group-item-danger .list-group-item-heading {
  color: inherit;
}
a.list-group-item-danger:hover,
button.list-group-item-danger:hover,
a.list-group-item-danger:focus,
button.list-group-item-danger:focus {
  color: #a94442;
  background-color: #ebcccc;
}
a.list-group-item-danger.active,
button.list-group-item-danger.active,
a.list-group-item-danger.active:hover,
button.list-group-item-danger.active:hover,
a.list-group-item-danger.active:focus,
button.list-group-item-danger.active:focus {
  color: #fff;
  background-color: #a94442;
  border-color: #a94442;
}
.list-group-item-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.list-group-item-text {
  margin-bottom: 0;
  line-height: 1.3;
}
.panel {
  margin-bottom: 18px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 2px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 15px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-left: 15px;
  padding-right: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 1px;
  border-top-right-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 1px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-left-radius: 1px;
  border-bottom-right-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 1px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  border: 0;
  margin-bottom: 0;
}
.panel-group {
  margin-bottom: 18px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 2px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.embed-responsive {
  position: relative;
  display: block;
  height: 0;
  padding: 0;
  overflow: hidden;
}
.embed-responsive .embed-responsive-item,
.embed-responsive iframe,
.embed-responsive embed,
.embed-responsive object,
.embed-responsive video {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
  border: 0;
}
.embed-responsive-16by9 {
  padding-bottom: 56.25%;
}
.embed-responsive-4by3 {
  padding-bottom: 75%;
}
.well {
  min-height: 20px;
  padding: 19px;
  margin-bottom: 20px;
  background-color: #f5f5f5;
  border: 1px solid #e3e3e3;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}
.well blockquote {
  border-color: #ddd;
  border-color: rgba(0, 0, 0, 0.15);
}
.well-lg {
  padding: 24px;
  border-radius: 3px;
}
.well-sm {
  padding: 9px;
  border-radius: 1px;
}
.close {
  float: right;
  font-size: 19.5px;
  font-weight: bold;
  line-height: 1;
  color: #000;
  text-shadow: 0 1px 0 #fff;
  opacity: 0.2;
  filter: alpha(opacity=20);
}
.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
  opacity: 0.5;
  filter: alpha(opacity=50);
}
button.close {
  padding: 0;
  cursor: pointer;
  background: transparent;
  border: 0;
  -webkit-appearance: none;
}
.modal-open {
  overflow: hidden;
}
.modal {
  display: none;
  overflow: hidden;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1050;
  -webkit-overflow-scrolling: touch;
  outline: 0;
}
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  -o-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
}
.modal.in .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
.modal-open .modal {
  overflow-x: hidden;
  overflow-y: auto;
}
.modal-dialog {
  position: relative;
  width: auto;
  margin: 10px;
}
.modal-content {
  position: relative;
  background-color: #fff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  background-clip: padding-box;
  outline: 0;
}
.modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
}
.modal-backdrop.fade {
  opacity: 0;
  filter: alpha(opacity=0);
}
.modal-backdrop.in {
  opacity: 0.5;
  filter: alpha(opacity=50);
}
.modal-header {
  padding: 15px;
  border-bottom: 1px solid #e5e5e5;
}
.modal-header .close {
  margin-top: -2px;
}
.modal-title {
  margin: 0;
  line-height: 1.42857143;
}
.modal-body {
  position: relative;
  padding: 15px;
}
.modal-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #e5e5e5;
}
.modal-footer .btn + .btn {
  margin-left: 5px;
  margin-bottom: 0;
}
.modal-footer .btn-group .btn + .btn {
  margin-left: -1px;
}
.modal-footer .btn-block + .btn-block {
  margin-left: 0;
}
.modal-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll;
}
@media (min-width: 768px) {
  .modal-dialog {
    width: 600px;
    margin: 30px auto;
  }
  .modal-content {
    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  }
  .modal-sm {
    width: 300px;
  }
}
@media (min-width: 992px) {
  .modal-lg {
    width: 900px;
  }
}
.tooltip {
  position: absolute;
  z-index: 1070;
  display: block;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 12px;
  opacity: 0;
  filter: alpha(opacity=0);
}
.tooltip.in {
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.tooltip.top {
  margin-top: -3px;
  padding: 5px 0;
}
.tooltip.right {
  margin-left: 3px;
  padding: 0 5px;
}
.tooltip.bottom {
  margin-top: 3px;
  padding: 5px 0;
}
.tooltip.left {
  margin-left: -3px;
  padding: 0 5px;
}
.tooltip-inner {
  max-width: 200px;
  padding: 3px 8px;
  color: #fff;
  text-align: center;
  background-color: #000;
  border-radius: 2px;
}
.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-left .tooltip-arrow {
  bottom: 0;
  right: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-right .tooltip-arrow {
  bottom: 0;
  left: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-width: 5px 5px 5px 0;
  border-right-color: #000;
}
.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-width: 5px 0 5px 5px;
  border-left-color: #000;
}
.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-left .tooltip-arrow {
  top: 0;
  right: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-right .tooltip-arrow {
  top: 0;
  left: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1060;
  display: none;
  max-width: 276px;
  padding: 1px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 13px;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}
.popover.top {
  margin-top: -10px;
}
.popover.right {
  margin-left: 10px;
}
.popover.bottom {
  margin-top: 10px;
}
.popover.left {
  margin-left: -10px;
}
.popover-title {
  margin: 0;
  padding: 8px 14px;
  font-size: 13px;
  background-color: #f7f7f7;
  border-bottom: 1px solid #ebebeb;
  border-radius: 2px 2px 0 0;
}
.popover-content {
  padding: 9px 14px;
}
.popover > .arrow,
.popover > .arrow:after {
  position: absolute;
  display: block;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.popover > .arrow {
  border-width: 11px;
}
.popover > .arrow:after {
  border-width: 10px;
  content: "";
}
.popover.top > .arrow {
  left: 50%;
  margin-left: -11px;
  border-bottom-width: 0;
  border-top-color: #999999;
  border-top-color: rgba(0, 0, 0, 0.25);
  bottom: -11px;
}
.popover.top > .arrow:after {
  content: " ";
  bottom: 1px;
  margin-left: -10px;
  border-bottom-width: 0;
  border-top-color: #fff;
}
.popover.right > .arrow {
  top: 50%;
  left: -11px;
  margin-top: -11px;
  border-left-width: 0;
  border-right-color: #999999;
  border-right-color: rgba(0, 0, 0, 0.25);
}
.popover.right > .arrow:after {
  content: " ";
  left: 1px;
  bottom: -10px;
  border-left-width: 0;
  border-right-color: #fff;
}
.popover.bottom > .arrow {
  left: 50%;
  margin-left: -11px;
  border-top-width: 0;
  border-bottom-color: #999999;
  border-bottom-color: rgba(0, 0, 0, 0.25);
  top: -11px;
}
.popover.bottom > .arrow:after {
  content: " ";
  top: 1px;
  margin-left: -10px;
  border-top-width: 0;
  border-bottom-color: #fff;
}
.popover.left > .arrow {
  top: 50%;
  right: -11px;
  margin-top: -11px;
  border-right-width: 0;
  border-left-color: #999999;
  border-left-color: rgba(0, 0, 0, 0.25);
}
.popover.left > .arrow:after {
  content: " ";
  right: 1px;
  border-right-width: 0;
  border-left-color: #fff;
  bottom: -10px;
}
.carousel {
  position: relative;
}
.carousel-inner {
  position: relative;
  overflow: hidden;
  width: 100%;
}
.carousel-inner > .item {
  display: none;
  position: relative;
  -webkit-transition: 0.6s ease-in-out left;
  -o-transition: 0.6s ease-in-out left;
  transition: 0.6s ease-in-out left;
}
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  line-height: 1;
}
@media all and (transform-3d), (-webkit-transform-3d) {
  .carousel-inner > .item {
    -webkit-transition: -webkit-transform 0.6s ease-in-out;
    -moz-transition: -moz-transform 0.6s ease-in-out;
    -o-transition: -o-transform 0.6s ease-in-out;
    transition: transform 0.6s ease-in-out;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    perspective: 1000px;
  }
  .carousel-inner > .item.next,
  .carousel-inner > .item.active.right {
    -webkit-transform: translate3d(100%, 0, 0);
    transform: translate3d(100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.prev,
  .carousel-inner > .item.active.left {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.next.left,
  .carousel-inner > .item.prev.right,
  .carousel-inner > .item.active {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    left: 0;
  }
}
.carousel-inner > .active,
.carousel-inner > .next,
.carousel-inner > .prev {
  display: block;
}
.carousel-inner > .active {
  left: 0;
}
.carousel-inner > .next,
.carousel-inner > .prev {
  position: absolute;
  top: 0;
  width: 100%;
}
.carousel-inner > .next {
  left: 100%;
}
.carousel-inner > .prev {
  left: -100%;
}
.carousel-inner > .next.left,
.carousel-inner > .prev.right {
  left: 0;
}
.carousel-inner > .active.left {
  left: -100%;
}
.carousel-inner > .active.right {
  left: 100%;
}
.carousel-control {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: 15%;
  opacity: 0.5;
  filter: alpha(opacity=50);
  font-size: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  background-color: rgba(0, 0, 0, 0);
}
.carousel-control.left {
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);
}
.carousel-control.right {
  left: auto;
  right: 0;
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);
}
.carousel-control:hover,
.carousel-control:focus {
  outline: 0;
  color: #fff;
  text-decoration: none;
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.carousel-control .icon-prev,
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-left,
.carousel-control .glyphicon-chevron-right {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  z-index: 5;
  display: inline-block;
}
.carousel-control .icon-prev,
.carousel-control .glyphicon-chevron-left {
  left: 50%;
  margin-left: -10px;
}
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-right {
  right: 50%;
  margin-right: -10px;
}
.carousel-control .icon-prev,
.carousel-control .icon-next {
  width: 20px;
  height: 20px;
  line-height: 1;
  font-family: serif;
}
.carousel-control .icon-prev:before {
  content: '\2039';
}
.carousel-control .icon-next:before {
  content: '\203a';
}
.carousel-indicators {
  position: absolute;
  bottom: 10px;
  left: 50%;
  z-index: 15;
  width: 60%;
  margin-left: -30%;
  padding-left: 0;
  list-style: none;
  text-align: center;
}
.carousel-indicators li {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 1px;
  text-indent: -999px;
  border: 1px solid #fff;
  border-radius: 10px;
  cursor: pointer;
  background-color: #000 \9;
  background-color: rgba(0, 0, 0, 0);
}
.carousel-indicators .active {
  margin: 0;
  width: 12px;
  height: 12px;
  background-color: #fff;
}
.carousel-caption {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 20px;
  z-index: 10;
  padding-top: 20px;
  padding-bottom: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}
.carousel-caption .btn {
  text-shadow: none;
}
@media screen and (min-width: 768px) {
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-prev,
  .carousel-control .icon-next {
    width: 30px;
    height: 30px;
    margin-top: -10px;
    font-size: 30px;
  }
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .icon-prev {
    margin-left: -10px;
  }
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-next {
    margin-right: -10px;
  }
  .carousel-caption {
    left: 20%;
    right: 20%;
    padding-bottom: 30px;
  }
  .carousel-indicators {
    bottom: 20px;
  }
}
.clearfix:before,
.clearfix:after,
.dl-horizontal dd:before,
.dl-horizontal dd:after,
.container:before,
.container:after,
.container-fluid:before,
.container-fluid:after,
.row:before,
.row:after,
.form-horizontal .form-group:before,
.form-horizontal .form-group:after,
.btn-toolbar:before,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:before,
.btn-group-vertical > .btn-group:after,
.nav:before,
.nav:after,
.navbar:before,
.navbar:after,
.navbar-header:before,
.navbar-header:after,
.navbar-collapse:before,
.navbar-collapse:after,
.pager:before,
.pager:after,
.panel-body:before,
.panel-body:after,
.modal-header:before,
.modal-header:after,
.modal-footer:before,
.modal-footer:after,
.item_buttons:before,
.item_buttons:after {
  content: " ";
  display: table;
}
.clearfix:after,
.dl-horizontal dd:after,
.container:after,
.container-fluid:after,
.row:after,
.form-horizontal .form-group:after,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:after,
.nav:after,
.navbar:after,
.navbar-header:after,
.navbar-collapse:after,
.pager:after,
.panel-body:after,
.modal-header:after,
.modal-footer:after,
.item_buttons:after {
  clear: both;
}
.center-block {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.pull-right {
  float: right !important;
}
.pull-left {
  float: left !important;
}
.hide {
  display: none !important;
}
.show {
  display: block !important;
}
.invisible {
  visibility: hidden;
}
.text-hide {
  font: 0/0 a;
  color: transparent;
  text-shadow: none;
  background-color: transparent;
  border: 0;
}
.hidden {
  display: none !important;
}
.affix {
  position: fixed;
}
@-ms-viewport {
  width: device-width;
}
.visible-xs,
.visible-sm,
.visible-md,
.visible-lg {
  display: none !important;
}
.visible-xs-block,
.visible-xs-inline,
.visible-xs-inline-block,
.visible-sm-block,
.visible-sm-inline,
.visible-sm-inline-block,
.visible-md-block,
.visible-md-inline,
.visible-md-inline-block,
.visible-lg-block,
.visible-lg-inline,
.visible-lg-inline-block {
  display: none !important;
}
@media (max-width: 767px) {
  .visible-xs {
    display: block !important;
  }
  table.visible-xs {
    display: table !important;
  }
  tr.visible-xs {
    display: table-row !important;
  }
  th.visible-xs,
  td.visible-xs {
    display: table-cell !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-block {
    display: block !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline {
    display: inline !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm {
    display: block !important;
  }
  table.visible-sm {
    display: table !important;
  }
  tr.visible-sm {
    display: table-row !important;
  }
  th.visible-sm,
  td.visible-sm {
    display: table-cell !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-block {
    display: block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline {
    display: inline !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md {
    display: block !important;
  }
  table.visible-md {
    display: table !important;
  }
  tr.visible-md {
    display: table-row !important;
  }
  th.visible-md,
  td.visible-md {
    display: table-cell !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-block {
    display: block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline {
    display: inline !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg {
    display: block !important;
  }
  table.visible-lg {
    display: table !important;
  }
  tr.visible-lg {
    display: table-row !important;
  }
  th.visible-lg,
  td.visible-lg {
    display: table-cell !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-block {
    display: block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline {
    display: inline !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline-block {
    display: inline-block !important;
  }
}
@media (max-width: 767px) {
  .hidden-xs {
    display: none !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .hidden-sm {
    display: none !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .hidden-md {
    display: none !important;
  }
}
@media (min-width: 1200px) {
  .hidden-lg {
    display: none !important;
  }
}
.visible-print {
  display: none !important;
}
@media print {
  .visible-print {
    display: block !important;
  }
  table.visible-print {
    display: table !important;
  }
  tr.visible-print {
    display: table-row !important;
  }
  th.visible-print,
  td.visible-print {
    display: table-cell !important;
  }
}
.visible-print-block {
  display: none !important;
}
@media print {
  .visible-print-block {
    display: block !important;
  }
}
.visible-print-inline {
  display: none !important;
}
@media print {
  .visible-print-inline {
    display: inline !important;
  }
}
.visible-print-inline-block {
  display: none !important;
}
@media print {
  .visible-print-inline-block {
    display: inline-block !important;
  }
}
@media print {
  .hidden-print {
    display: none !important;
  }
}
/*!
*
* Font Awesome
*
*/
/*!
 *  Font Awesome 4.7.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */
/* FONT PATH
 * -------------------------- */
@font-face {
  font-family: 'FontAwesome';
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.7.0');
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.7.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff2?v=4.7.0') format('woff2'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.7.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.7.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.7.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* makes the font 33% larger relative to the icon container */
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  vertical-align: -15%;
}
.fa-2x {
  font-size: 2em;
}
.fa-3x {
  font-size: 3em;
}
.fa-4x {
  font-size: 4em;
}
.fa-5x {
  font-size: 5em;
}
.fa-fw {
  width: 1.28571429em;
  text-align: center;
}
.fa-ul {
  padding-left: 0;
  margin-left: 2.14285714em;
  list-style-type: none;
}
.fa-ul > li {
  position: relative;
}
.fa-li {
  position: absolute;
  left: -2.14285714em;
  width: 2.14285714em;
  top: 0.14285714em;
  text-align: center;
}
.fa-li.fa-lg {
  left: -1.85714286em;
}
.fa-border {
  padding: .2em .25em .15em;
  border: solid 0.08em #eee;
  border-radius: .1em;
}
.fa-pull-left {
  float: left;
}
.fa-pull-right {
  float: right;
}
.fa.fa-pull-left {
  margin-right: .3em;
}
.fa.fa-pull-right {
  margin-left: .3em;
}
/* Deprecated as of 4.4.0 */
.pull-right {
  float: right;
}
.pull-left {
  float: left;
}
.fa.pull-left {
  margin-right: .3em;
}
.fa.pull-right {
  margin-left: .3em;
}
.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
  animation: fa-spin 2s infinite linear;
}
.fa-pulse {
  -webkit-animation: fa-spin 1s infinite steps(8);
  animation: fa-spin 1s infinite steps(8);
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
.fa-rotate-90 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";
  -webkit-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  transform: rotate(90deg);
}
.fa-rotate-180 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";
  -webkit-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  transform: rotate(180deg);
}
.fa-rotate-270 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
}
.fa-flip-horizontal {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";
  -webkit-transform: scale(-1, 1);
  -ms-transform: scale(-1, 1);
  transform: scale(-1, 1);
}
.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  transform: scale(1, -1);
}
:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical {
  filter: none;
}
.fa-stack {
  position: relative;
  display: inline-block;
  width: 2em;
  height: 2em;
  line-height: 2em;
  vertical-align: middle;
}
.fa-stack-1x,
.fa-stack-2x {
  position: absolute;
  left: 0;
  width: 100%;
  text-align: center;
}
.fa-stack-1x {
  line-height: inherit;
}
.fa-stack-2x {
  font-size: 2em;
}
.fa-inverse {
  color: #fff;
}
/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen
   readers do not read off random characters that represent icons */
.fa-glass:before {
  content: "\f000";
}
.fa-music:before {
  content: "\f001";
}
.fa-search:before {
  content: "\f002";
}
.fa-envelope-o:before {
  content: "\f003";
}
.fa-heart:before {
  content: "\f004";
}
.fa-star:before {
  content: "\f005";
}
.fa-star-o:before {
  content: "\f006";
}
.fa-user:before {
  content: "\f007";
}
.fa-film:before {
  content: "\f008";
}
.fa-th-large:before {
  content: "\f009";
}
.fa-th:before {
  content: "\f00a";
}
.fa-th-list:before {
  content: "\f00b";
}
.fa-check:before {
  content: "\f00c";
}
.fa-remove:before,
.fa-close:before,
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-power-off:before {
  content: "\f011";
}
.fa-signal:before {
  content: "\f012";
}
.fa-gear:before,
.fa-cog:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-home:before {
  content: "\f015";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-clock-o:before {
  content: "\f017";
}
.fa-road:before {
  content: "\f018";
}
.fa-download:before {
  content: "\f019";
}
.fa-arrow-circle-o-down:before {
  content: "\f01a";
}
.fa-arrow-circle-o-up:before {
  content: "\f01b";
}
.fa-inbox:before {
  content: "\f01c";
}
.fa-play-circle-o:before {
  content: "\f01d";
}
.fa-rotate-right:before,
.fa-repeat:before {
  content: "\f01e";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-list-alt:before {
  content: "\f022";
}
.fa-lock:before {
  content: "\f023";
}
.fa-flag:before {
  content: "\f024";
}
.fa-headphones:before {
  content: "\f025";
}
.fa-volume-off:before {
  content: "\f026";
}
.fa-volume-down:before {
  content: "\f027";
}
.fa-volume-up:before {
  content: "\f028";
}
.fa-qrcode:before {
  content: "\f029";
}
.fa-barcode:before {
  content: "\f02a";
}
.fa-tag:before {
  content: "\f02b";
}
.fa-tags:before {
  content: "\f02c";
}
.fa-book:before {
  content: "\f02d";
}
.fa-bookmark:before {
  content: "\f02e";
}
.fa-print:before {
  content: "\f02f";
}
.fa-camera:before {
  content: "\f030";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-text-height:before {
  content: "\f034";
}
.fa-text-width:before {
  content: "\f035";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-align-justify:before {
  content: "\f039";
}
.fa-list:before {
  content: "\f03a";
}
.fa-dedent:before,
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-video-camera:before {
  content: "\f03d";
}
.fa-photo:before,
.fa-image:before,
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-map-marker:before {
  content: "\f041";
}
.fa-adjust:before {
  content: "\f042";
}
.fa-tint:before {
  content: "\f043";
}
.fa-edit:before,
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-check-square-o:before {
  content: "\f046";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-step-backward:before {
  content: "\f048";
}
.fa-fast-backward:before {
  content: "\f049";
}
.fa-backward:before {
  content: "\f04a";
}
.fa-play:before {
  content: "\f04b";
}
.fa-pause:before {
  content: "\f04c";
}
.fa-stop:before {
  content: "\f04d";
}
.fa-forward:before {
  content: "\f04e";
}
.fa-fast-forward:before {
  content: "\f050";
}
.fa-step-forward:before {
  content: "\f051";
}
.fa-eject:before {
  content: "\f052";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-plus-circle:before {
  content: "\f055";
}
.fa-minus-circle:before {
  content: "\f056";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-check-circle:before {
  content: "\f058";
}
.fa-question-circle:before {
  content: "\f059";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-crosshairs:before {
  content: "\f05b";
}
.fa-times-circle-o:before {
  content: "\f05c";
}
.fa-check-circle-o:before {
  content: "\f05d";
}
.fa-ban:before {
  content: "\f05e";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before,
.fa-share:before {
  content: "\f064";
}
.fa-expand:before {
  content: "\f065";
}
.fa-compress:before {
  content: "\f066";
}
.fa-plus:before {
  content: "\f067";
}
.fa-minus:before {
  content: "\f068";
}
.fa-asterisk:before {
  content: "\f069";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-gift:before {
  content: "\f06b";
}
.fa-leaf:before {
  content: "\f06c";
}
.fa-fire:before {
  content: "\f06d";
}
.fa-eye:before {
  content: "\f06e";
}
.fa-eye-slash:before {
  content: "\f070";
}
.fa-warning:before,
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-plane:before {
  content: "\f072";
}
.fa-calendar:before {
  content: "\f073";
}
.fa-random:before {
  content: "\f074";
}
.fa-comment:before {
  content: "\f075";
}
.fa-magnet:before {
  content: "\f076";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-retweet:before {
  content: "\f079";
}
.fa-shopping-cart:before {
  content: "\f07a";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-arrows-v:before {
  content: "\f07d";
}
.fa-arrows-h:before {
  content: "\f07e";
}
.fa-bar-chart-o:before,
.fa-bar-chart:before {
  content: "\f080";
}
.fa-twitter-square:before {
  content: "\f081";
}
.fa-facebook-square:before {
  content: "\f082";
}
.fa-camera-retro:before {
  content: "\f083";
}
.fa-key:before {
  content: "\f084";
}
.fa-gears:before,
.fa-cogs:before {
  content: "\f085";
}
.fa-comments:before {
  content: "\f086";
}
.fa-thumbs-o-up:before {
  content: "\f087";
}
.fa-thumbs-o-down:before {
  content: "\f088";
}
.fa-star-half:before {
  content: "\f089";
}
.fa-heart-o:before {
  content: "\f08a";
}
.fa-sign-out:before {
  content: "\f08b";
}
.fa-linkedin-square:before {
  content: "\f08c";
}
.fa-thumb-tack:before {
  content: "\f08d";
}
.fa-external-link:before {
  content: "\f08e";
}
.fa-sign-in:before {
  content: "\f090";
}
.fa-trophy:before {
  content: "\f091";
}
.fa-github-square:before {
  content: "\f092";
}
.fa-upload:before {
  content: "\f093";
}
.fa-lemon-o:before {
  content: "\f094";
}
.fa-phone:before {
  content: "\f095";
}
.fa-square-o:before {
  content: "\f096";
}
.fa-bookmark-o:before {
  content: "\f097";
}
.fa-phone-square:before {
  content: "\f098";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-facebook-f:before,
.fa-facebook:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-unlock:before {
  content: "\f09c";
}
.fa-credit-card:before {
  content: "\f09d";
}
.fa-feed:before,
.fa-rss:before {
  content: "\f09e";
}
.fa-hdd-o:before {
  content: "\f0a0";
}
.fa-bullhorn:before {
  content: "\f0a1";
}
.fa-bell:before {
  content: "\f0f3";
}
.fa-certificate:before {
  content: "\f0a3";
}
.fa-hand-o-right:before {
  content: "\f0a4";
}
.fa-hand-o-left:before {
  content: "\f0a5";
}
.fa-hand-o-up:before {
  content: "\f0a6";
}
.fa-hand-o-down:before {
  content: "\f0a7";
}
.fa-arrow-circle-left:before {
  content: "\f0a8";
}
.fa-arrow-circle-right:before {
  content: "\f0a9";
}
.fa-arrow-circle-up:before {
  content: "\f0aa";
}
.fa-arrow-circle-down:before {
  content: "\f0ab";
}
.fa-globe:before {
  content: "\f0ac";
}
.fa-wrench:before {
  content: "\f0ad";
}
.fa-tasks:before {
  content: "\f0ae";
}
.fa-filter:before {
  content: "\f0b0";
}
.fa-briefcase:before {
  content: "\f0b1";
}
.fa-arrows-alt:before {
  content: "\f0b2";
}
.fa-group:before,
.fa-users:before {
  content: "\f0c0";
}
.fa-chain:before,
.fa-link:before {
  content: "\f0c1";
}
.fa-cloud:before {
  content: "\f0c2";
}
.fa-flask:before {
  content: "\f0c3";
}
.fa-cut:before,
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before,
.fa-files-o:before {
  content: "\f0c5";
}
.fa-paperclip:before {
  content: "\f0c6";
}
.fa-save:before,
.fa-floppy-o:before {
  content: "\f0c7";
}
.fa-square:before {
  content: "\f0c8";
}
.fa-navicon:before,
.fa-reorder:before,
.fa-bars:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-truck:before {
  content: "\f0d1";
}
.fa-pinterest:before {
  content: "\f0d2";
}
.fa-pinterest-square:before {
  content: "\f0d3";
}
.fa-google-plus-square:before {
  content: "\f0d4";
}
.fa-google-plus:before {
  content: "\f0d5";
}
.fa-money:before {
  content: "\f0d6";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-up:before {
  content: "\f0d8";
}
.fa-caret-left:before {
  content: "\f0d9";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-columns:before {
  content: "\f0db";
}
.fa-unsorted:before,
.fa-sort:before {
  content: "\f0dc";
}
.fa-sort-down:before,
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-up:before,
.fa-sort-asc:before {
  content: "\f0de";
}
.fa-envelope:before {
  content: "\f0e0";
}
.fa-linkedin:before {
  content: "\f0e1";
}
.fa-rotate-left:before,
.fa-undo:before {
  content: "\f0e2";
}
.fa-legal:before,
.fa-gavel:before {
  content: "\f0e3";
}
.fa-dashboard:before,
.fa-tachometer:before {
  content: "\f0e4";
}
.fa-comment-o:before {
  content: "\f0e5";
}
.fa-comments-o:before {
  content: "\f0e6";
}
.fa-flash:before,
.fa-bolt:before {
  content: "\f0e7";
}
.fa-sitemap:before {
  content: "\f0e8";
}
.fa-umbrella:before {
  content: "\f0e9";
}
.fa-paste:before,
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-lightbulb-o:before {
  content: "\f0eb";
}
.fa-exchange:before {
  content: "\f0ec";
}
.fa-cloud-download:before {
  content: "\f0ed";
}
.fa-cloud-upload:before {
  content: "\f0ee";
}
.fa-user-md:before {
  content: "\f0f0";
}
.fa-stethoscope:before {
  content: "\f0f1";
}
.fa-suitcase:before {
  content: "\f0f2";
}
.fa-bell-o:before {
  content: "\f0a2";
}
.fa-coffee:before {
  content: "\f0f4";
}
.fa-cutlery:before {
  content: "\f0f5";
}
.fa-file-text-o:before {
  content: "\f0f6";
}
.fa-building-o:before {
  content: "\f0f7";
}
.fa-hospital-o:before {
  content: "\f0f8";
}
.fa-ambulance:before {
  content: "\f0f9";
}
.fa-medkit:before {
  content: "\f0fa";
}
.fa-fighter-jet:before {
  content: "\f0fb";
}
.fa-beer:before {
  content: "\f0fc";
}
.fa-h-square:before {
  content: "\f0fd";
}
.fa-plus-square:before {
  content: "\f0fe";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-angle-left:before {
  content: "\f104";
}
.fa-angle-right:before {
  content: "\f105";
}
.fa-angle-up:before {
  content: "\f106";
}
.fa-angle-down:before {
  content: "\f107";
}
.fa-desktop:before {
  content: "\f108";
}
.fa-laptop:before {
  content: "\f109";
}
.fa-tablet:before {
  content: "\f10a";
}
.fa-mobile-phone:before,
.fa-mobile:before {
  content: "\f10b";
}
.fa-circle-o:before {
  content: "\f10c";
}
.fa-quote-left:before {
  content: "\f10d";
}
.fa-quote-right:before {
  content: "\f10e";
}
.fa-spinner:before {
  content: "\f110";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before,
.fa-reply:before {
  content: "\f112";
}
.fa-github-alt:before {
  content: "\f113";
}
.fa-folder-o:before {
  content: "\f114";
}
.fa-folder-open-o:before {
  content: "\f115";
}
.fa-smile-o:before {
  content: "\f118";
}
.fa-frown-o:before {
  content: "\f119";
}
.fa-meh-o:before {
  content: "\f11a";
}
.fa-gamepad:before {
  content: "\f11b";
}
.fa-keyboard-o:before {
  content: "\f11c";
}
.fa-flag-o:before {
  content: "\f11d";
}
.fa-flag-checkered:before {
  content: "\f11e";
}
.fa-terminal:before {
  content: "\f120";
}
.fa-code:before {
  content: "\f121";
}
.fa-mail-reply-all:before,
.fa-reply-all:before {
  content: "\f122";
}
.fa-star-half-empty:before,
.fa-star-half-full:before,
.fa-star-half-o:before {
  content: "\f123";
}
.fa-location-arrow:before {
  content: "\f124";
}
.fa-crop:before {
  content: "\f125";
}
.fa-code-fork:before {
  content: "\f126";
}
.fa-unlink:before,
.fa-chain-broken:before {
  content: "\f127";
}
.fa-question:before {
  content: "\f128";
}
.fa-info:before {
  content: "\f129";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-superscript:before {
  content: "\f12b";
}
.fa-subscript:before {
  content: "\f12c";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-puzzle-piece:before {
  content: "\f12e";
}
.fa-microphone:before {
  content: "\f130";
}
.fa-microphone-slash:before {
  content: "\f131";
}
.fa-shield:before {
  content: "\f132";
}
.fa-calendar-o:before {
  content: "\f133";
}
.fa-fire-extinguisher:before {
  content: "\f134";
}
.fa-rocket:before {
  content: "\f135";
}
.fa-maxcdn:before {
  content: "\f136";
}
.fa-chevron-circle-left:before {
  content: "\f137";
}
.fa-chevron-circle-right:before {
  content: "\f138";
}
.fa-chevron-circle-up:before {
  content: "\f139";
}
.fa-chevron-circle-down:before {
  content: "\f13a";
}
.fa-html5:before {
  content: "\f13b";
}
.fa-css3:before {
  content: "\f13c";
}
.fa-anchor:before {
  content: "\f13d";
}
.fa-unlock-alt:before {
  content: "\f13e";
}
.fa-bullseye:before {
  content: "\f140";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-rss-square:before {
  content: "\f143";
}
.fa-play-circle:before {
  content: "\f144";
}
.fa-ticket:before {
  content: "\f145";
}
.fa-minus-square:before {
  content: "\f146";
}
.fa-minus-square-o:before {
  content: "\f147";
}
.fa-level-up:before {
  content: "\f148";
}
.fa-level-down:before {
  content: "\f149";
}
.fa-check-square:before {
  content: "\f14a";
}
.fa-pencil-square:before {
  content: "\f14b";
}
.fa-external-link-square:before {
  content: "\f14c";
}
.fa-share-square:before {
  content: "\f14d";
}
.fa-compass:before {
  content: "\f14e";
}
.fa-toggle-down:before,
.fa-caret-square-o-down:before {
  content: "\f150";
}
.fa-toggle-up:before,
.fa-caret-square-o-up:before {
  content: "\f151";
}
.fa-toggle-right:before,
.fa-caret-square-o-right:before {
  content: "\f152";
}
.fa-euro:before,
.fa-eur:before {
  content: "\f153";
}
.fa-gbp:before {
  content: "\f154";
}
.fa-dollar:before,
.fa-usd:before {
  content: "\f155";
}
.fa-rupee:before,
.fa-inr:before {
  content: "\f156";
}
.fa-cny:before,
.fa-rmb:before,
.fa-yen:before,
.fa-jpy:before {
  content: "\f157";
}
.fa-ruble:before,
.fa-rouble:before,
.fa-rub:before {
  content: "\f158";
}
.fa-won:before,
.fa-krw:before {
  content: "\f159";
}
.fa-bitcoin:before,
.fa-btc:before {
  content: "\f15a";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-sort-alpha-asc:before {
  content: "\f15d";
}
.fa-sort-alpha-desc:before {
  content: "\f15e";
}
.fa-sort-amount-asc:before {
  content: "\f160";
}
.fa-sort-amount-desc:before {
  content: "\f161";
}
.fa-sort-numeric-asc:before {
  content: "\f162";
}
.fa-sort-numeric-desc:before {
  content: "\f163";
}
.fa-thumbs-up:before {
  content: "\f164";
}
.fa-thumbs-down:before {
  content: "\f165";
}
.fa-youtube-square:before {
  content: "\f166";
}
.fa-youtube:before {
  content: "\f167";
}
.fa-xing:before {
  content: "\f168";
}
.fa-xing-square:before {
  content: "\f169";
}
.fa-youtube-play:before {
  content: "\f16a";
}
.fa-dropbox:before {
  content: "\f16b";
}
.fa-stack-overflow:before {
  content: "\f16c";
}
.fa-instagram:before {
  content: "\f16d";
}
.fa-flickr:before {
  content: "\f16e";
}
.fa-adn:before {
  content: "\f170";
}
.fa-bitbucket:before {
  content: "\f171";
}
.fa-bitbucket-square:before {
  content: "\f172";
}
.fa-tumblr:before {
  content: "\f173";
}
.fa-tumblr-square:before {
  content: "\f174";
}
.fa-long-arrow-down:before {
  content: "\f175";
}
.fa-long-arrow-up:before {
  content: "\f176";
}
.fa-long-arrow-left:before {
  content: "\f177";
}
.fa-long-arrow-right:before {
  content: "\f178";
}
.fa-apple:before {
  content: "\f179";
}
.fa-windows:before {
  content: "\f17a";
}
.fa-android:before {
  content: "\f17b";
}
.fa-linux:before {
  content: "\f17c";
}
.fa-dribbble:before {
  content: "\f17d";
}
.fa-skype:before {
  content: "\f17e";
}
.fa-foursquare:before {
  content: "\f180";
}
.fa-trello:before {
  content: "\f181";
}
.fa-female:before {
  content: "\f182";
}
.fa-male:before {
  content: "\f183";
}
.fa-gittip:before,
.fa-gratipay:before {
  content: "\f184";
}
.fa-sun-o:before {
  content: "\f185";
}
.fa-moon-o:before {
  content: "\f186";
}
.fa-archive:before {
  content: "\f187";
}
.fa-bug:before {
  content: "\f188";
}
.fa-vk:before {
  content: "\f189";
}
.fa-weibo:before {
  content: "\f18a";
}
.fa-renren:before {
  content: "\f18b";
}
.fa-pagelines:before {
  content: "\f18c";
}
.fa-stack-exchange:before {
  content: "\f18d";
}
.fa-arrow-circle-o-right:before {
  content: "\f18e";
}
.fa-arrow-circle-o-left:before {
  content: "\f190";
}
.fa-toggle-left:before,
.fa-caret-square-o-left:before {
  content: "\f191";
}
.fa-dot-circle-o:before {
  content: "\f192";
}
.fa-wheelchair:before {
  content: "\f193";
}
.fa-vimeo-square:before {
  content: "\f194";
}
.fa-turkish-lira:before,
.fa-try:before {
  content: "\f195";
}
.fa-plus-square-o:before {
  content: "\f196";
}
.fa-space-shuttle:before {
  content: "\f197";
}
.fa-slack:before {
  content: "\f198";
}
.fa-envelope-square:before {
  content: "\f199";
}
.fa-wordpress:before {
  content: "\f19a";
}
.fa-openid:before {
  content: "\f19b";
}
.fa-institution:before,
.fa-bank:before,
.fa-university:before {
  content: "\f19c";
}
.fa-mortar-board:before,
.fa-graduation-cap:before {
  content: "\f19d";
}
.fa-yahoo:before {
  content: "\f19e";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-reddit:before {
  content: "\f1a1";
}
.fa-reddit-square:before {
  content: "\f1a2";
}
.fa-stumbleupon-circle:before {
  content: "\f1a3";
}
.fa-stumbleupon:before {
  content: "\f1a4";
}
.fa-delicious:before {
  content: "\f1a5";
}
.fa-digg:before {
  content: "\f1a6";
}
.fa-pied-piper-pp:before {
  content: "\f1a7";
}
.fa-pied-piper-alt:before {
  content: "\f1a8";
}
.fa-drupal:before {
  content: "\f1a9";
}
.fa-joomla:before {
  content: "\f1aa";
}
.fa-language:before {
  content: "\f1ab";
}
.fa-fax:before {
  content: "\f1ac";
}
.fa-building:before {
  content: "\f1ad";
}
.fa-child:before {
  content: "\f1ae";
}
.fa-paw:before {
  content: "\f1b0";
}
.fa-spoon:before {
  content: "\f1b1";
}
.fa-cube:before {
  content: "\f1b2";
}
.fa-cubes:before {
  content: "\f1b3";
}
.fa-behance:before {
  content: "\f1b4";
}
.fa-behance-square:before {
  content: "\f1b5";
}
.fa-steam:before {
  content: "\f1b6";
}
.fa-steam-square:before {
  content: "\f1b7";
}
.fa-recycle:before {
  content: "\f1b8";
}
.fa-automobile:before,
.fa-car:before {
  content: "\f1b9";
}
.fa-cab:before,
.fa-taxi:before {
  content: "\f1ba";
}
.fa-tree:before {
  content: "\f1bb";
}
.fa-spotify:before {
  content: "\f1bc";
}
.fa-deviantart:before {
  content: "\f1bd";
}
.fa-soundcloud:before {
  content: "\f1be";
}
.fa-database:before {
  content: "\f1c0";
}
.fa-file-pdf-o:before {
  content: "\f1c1";
}
.fa-file-word-o:before {
  content: "\f1c2";
}
.fa-file-excel-o:before {
  content: "\f1c3";
}
.fa-file-powerpoint-o:before {
  content: "\f1c4";
}
.fa-file-photo-o:before,
.fa-file-picture-o:before,
.fa-file-image-o:before {
  content: "\f1c5";
}
.fa-file-zip-o:before,
.fa-file-archive-o:before {
  content: "\f1c6";
}
.fa-file-sound-o:before,
.fa-file-audio-o:before {
  content: "\f1c7";
}
.fa-file-movie-o:before,
.fa-file-video-o:before {
  content: "\f1c8";
}
.fa-file-code-o:before {
  content: "\f1c9";
}
.fa-vine:before {
  content: "\f1ca";
}
.fa-codepen:before {
  content: "\f1cb";
}
.fa-jsfiddle:before {
  content: "\f1cc";
}
.fa-life-bouy:before,
.fa-life-buoy:before,
.fa-life-saver:before,
.fa-support:before,
.fa-life-ring:before {
  content: "\f1cd";
}
.fa-circle-o-notch:before {
  content: "\f1ce";
}
.fa-ra:before,
.fa-resistance:before,
.fa-rebel:before {
  content: "\f1d0";
}
.fa-ge:before,
.fa-empire:before {
  content: "\f1d1";
}
.fa-git-square:before {
  content: "\f1d2";
}
.fa-git:before {
  content: "\f1d3";
}
.fa-y-combinator-square:before,
.fa-yc-square:before,
.fa-hacker-news:before {
  content: "\f1d4";
}
.fa-tencent-weibo:before {
  content: "\f1d5";
}
.fa-qq:before {
  content: "\f1d6";
}
.fa-wechat:before,
.fa-weixin:before {
  content: "\f1d7";
}
.fa-send:before,
.fa-paper-plane:before {
  content: "\f1d8";
}
.fa-send-o:before,
.fa-paper-plane-o:before {
  content: "\f1d9";
}
.fa-history:before {
  content: "\f1da";
}
.fa-circle-thin:before {
  content: "\f1db";
}
.fa-header:before {
  content: "\f1dc";
}
.fa-paragraph:before {
  content: "\f1dd";
}
.fa-sliders:before {
  content: "\f1de";
}
.fa-share-alt:before {
  content: "\f1e0";
}
.fa-share-alt-square:before {
  content: "\f1e1";
}
.fa-bomb:before {
  content: "\f1e2";
}
.fa-soccer-ball-o:before,
.fa-futbol-o:before {
  content: "\f1e3";
}
.fa-tty:before {
  content: "\f1e4";
}
.fa-binoculars:before {
  content: "\f1e5";
}
.fa-plug:before {
  content: "\f1e6";
}
.fa-slideshare:before {
  content: "\f1e7";
}
.fa-twitch:before {
  content: "\f1e8";
}
.fa-yelp:before {
  content: "\f1e9";
}
.fa-newspaper-o:before {
  content: "\f1ea";
}
.fa-wifi:before {
  content: "\f1eb";
}
.fa-calculator:before {
  content: "\f1ec";
}
.fa-paypal:before {
  content: "\f1ed";
}
.fa-google-wallet:before {
  content: "\f1ee";
}
.fa-cc-visa:before {
  content: "\f1f0";
}
.fa-cc-mastercard:before {
  content: "\f1f1";
}
.fa-cc-discover:before {
  content: "\f1f2";
}
.fa-cc-amex:before {
  content: "\f1f3";
}
.fa-cc-paypal:before {
  content: "\f1f4";
}
.fa-cc-stripe:before {
  content: "\f1f5";
}
.fa-bell-slash:before {
  content: "\f1f6";
}
.fa-bell-slash-o:before {
  content: "\f1f7";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-copyright:before {
  content: "\f1f9";
}
.fa-at:before {
  content: "\f1fa";
}
.fa-eyedropper:before {
  content: "\f1fb";
}
.fa-paint-brush:before {
  content: "\f1fc";
}
.fa-birthday-cake:before {
  content: "\f1fd";
}
.fa-area-chart:before {
  content: "\f1fe";
}
.fa-pie-chart:before {
  content: "\f200";
}
.fa-line-chart:before {
  content: "\f201";
}
.fa-lastfm:before {
  content: "\f202";
}
.fa-lastfm-square:before {
  content: "\f203";
}
.fa-toggle-off:before {
  content: "\f204";
}
.fa-toggle-on:before {
  content: "\f205";
}
.fa-bicycle:before {
  content: "\f206";
}
.fa-bus:before {
  content: "\f207";
}
.fa-ioxhost:before {
  content: "\f208";
}
.fa-angellist:before {
  content: "\f209";
}
.fa-cc:before {
  content: "\f20a";
}
.fa-shekel:before,
.fa-sheqel:before,
.fa-ils:before {
  content: "\f20b";
}
.fa-meanpath:before {
  content: "\f20c";
}
.fa-buysellads:before {
  content: "\f20d";
}
.fa-connectdevelop:before {
  content: "\f20e";
}
.fa-dashcube:before {
  content: "\f210";
}
.fa-forumbee:before {
  content: "\f211";
}
.fa-leanpub:before {
  content: "\f212";
}
.fa-sellsy:before {
  content: "\f213";
}
.fa-shirtsinbulk:before {
  content: "\f214";
}
.fa-simplybuilt:before {
  content: "\f215";
}
.fa-skyatlas:before {
  content: "\f216";
}
.fa-cart-plus:before {
  content: "\f217";
}
.fa-cart-arrow-down:before {
  content: "\f218";
}
.fa-diamond:before {
  content: "\f219";
}
.fa-ship:before {
  content: "\f21a";
}
.fa-user-secret:before {
  content: "\f21b";
}
.fa-motorcycle:before {
  content: "\f21c";
}
.fa-street-view:before {
  content: "\f21d";
}
.fa-heartbeat:before {
  content: "\f21e";
}
.fa-venus:before {
  content: "\f221";
}
.fa-mars:before {
  content: "\f222";
}
.fa-mercury:before {
  content: "\f223";
}
.fa-intersex:before,
.fa-transgender:before {
  content: "\f224";
}
.fa-transgender-alt:before {
  content: "\f225";
}
.fa-venus-double:before {
  content: "\f226";
}
.fa-mars-double:before {
  content: "\f227";
}
.fa-venus-mars:before {
  content: "\f228";
}
.fa-mars-stroke:before {
  content: "\f229";
}
.fa-mars-stroke-v:before {
  content: "\f22a";
}
.fa-mars-stroke-h:before {
  content: "\f22b";
}
.fa-neuter:before {
  content: "\f22c";
}
.fa-genderless:before {
  content: "\f22d";
}
.fa-facebook-official:before {
  content: "\f230";
}
.fa-pinterest-p:before {
  content: "\f231";
}
.fa-whatsapp:before {
  content: "\f232";
}
.fa-server:before {
  content: "\f233";
}
.fa-user-plus:before {
  content: "\f234";
}
.fa-user-times:before {
  content: "\f235";
}
.fa-hotel:before,
.fa-bed:before {
  content: "\f236";
}
.fa-viacoin:before {
  content: "\f237";
}
.fa-train:before {
  content: "\f238";
}
.fa-subway:before {
  content: "\f239";
}
.fa-medium:before {
  content: "\f23a";
}
.fa-yc:before,
.fa-y-combinator:before {
  content: "\f23b";
}
.fa-optin-monster:before {
  content: "\f23c";
}
.fa-opencart:before {
  content: "\f23d";
}
.fa-expeditedssl:before {
  content: "\f23e";
}
.fa-battery-4:before,
.fa-battery:before,
.fa-battery-full:before {
  content: "\f240";
}
.fa-battery-3:before,
.fa-battery-three-quarters:before {
  content: "\f241";
}
.fa-battery-2:before,
.fa-battery-half:before {
  content: "\f242";
}
.fa-battery-1:before,
.fa-battery-quarter:before {
  content: "\f243";
}
.fa-battery-0:before,
.fa-battery-empty:before {
  content: "\f244";
}
.fa-mouse-pointer:before {
  content: "\f245";
}
.fa-i-cursor:before {
  content: "\f246";
}
.fa-object-group:before {
  content: "\f247";
}
.fa-object-ungroup:before {
  content: "\f248";
}
.fa-sticky-note:before {
  content: "\f249";
}
.fa-sticky-note-o:before {
  content: "\f24a";
}
.fa-cc-jcb:before {
  content: "\f24b";
}
.fa-cc-diners-club:before {
  content: "\f24c";
}
.fa-clone:before {
  content: "\f24d";
}
.fa-balance-scale:before {
  content: "\f24e";
}
.fa-hourglass-o:before {
  content: "\f250";
}
.fa-hourglass-1:before,
.fa-hourglass-start:before {
  content: "\f251";
}
.fa-hourglass-2:before,
.fa-hourglass-half:before {
  content: "\f252";
}
.fa-hourglass-3:before,
.fa-hourglass-end:before {
  content: "\f253";
}
.fa-hourglass:before {
  content: "\f254";
}
.fa-hand-grab-o:before,
.fa-hand-rock-o:before {
  content: "\f255";
}
.fa-hand-stop-o:before,
.fa-hand-paper-o:before {
  content: "\f256";
}
.fa-hand-scissors-o:before {
  content: "\f257";
}
.fa-hand-lizard-o:before {
  content: "\f258";
}
.fa-hand-spock-o:before {
  content: "\f259";
}
.fa-hand-pointer-o:before {
  content: "\f25a";
}
.fa-hand-peace-o:before {
  content: "\f25b";
}
.fa-trademark:before {
  content: "\f25c";
}
.fa-registered:before {
  content: "\f25d";
}
.fa-creative-commons:before {
  content: "\f25e";
}
.fa-gg:before {
  content: "\f260";
}
.fa-gg-circle:before {
  content: "\f261";
}
.fa-tripadvisor:before {
  content: "\f262";
}
.fa-odnoklassniki:before {
  content: "\f263";
}
.fa-odnoklassniki-square:before {
  content: "\f264";
}
.fa-get-pocket:before {
  content: "\f265";
}
.fa-wikipedia-w:before {
  content: "\f266";
}
.fa-safari:before {
  content: "\f267";
}
.fa-chrome:before {
  content: "\f268";
}
.fa-firefox:before {
  content: "\f269";
}
.fa-opera:before {
  content: "\f26a";
}
.fa-internet-explorer:before {
  content: "\f26b";
}
.fa-tv:before,
.fa-television:before {
  content: "\f26c";
}
.fa-contao:before {
  content: "\f26d";
}
.fa-500px:before {
  content: "\f26e";
}
.fa-amazon:before {
  content: "\f270";
}
.fa-calendar-plus-o:before {
  content: "\f271";
}
.fa-calendar-minus-o:before {
  content: "\f272";
}
.fa-calendar-times-o:before {
  content: "\f273";
}
.fa-calendar-check-o:before {
  content: "\f274";
}
.fa-industry:before {
  content: "\f275";
}
.fa-map-pin:before {
  content: "\f276";
}
.fa-map-signs:before {
  content: "\f277";
}
.fa-map-o:before {
  content: "\f278";
}
.fa-map:before {
  content: "\f279";
}
.fa-commenting:before {
  content: "\f27a";
}
.fa-commenting-o:before {
  content: "\f27b";
}
.fa-houzz:before {
  content: "\f27c";
}
.fa-vimeo:before {
  content: "\f27d";
}
.fa-black-tie:before {
  content: "\f27e";
}
.fa-fonticons:before {
  content: "\f280";
}
.fa-reddit-alien:before {
  content: "\f281";
}
.fa-edge:before {
  content: "\f282";
}
.fa-credit-card-alt:before {
  content: "\f283";
}
.fa-codiepie:before {
  content: "\f284";
}
.fa-modx:before {
  content: "\f285";
}
.fa-fort-awesome:before {
  content: "\f286";
}
.fa-usb:before {
  content: "\f287";
}
.fa-product-hunt:before {
  content: "\f288";
}
.fa-mixcloud:before {
  content: "\f289";
}
.fa-scribd:before {
  content: "\f28a";
}
.fa-pause-circle:before {
  content: "\f28b";
}
.fa-pause-circle-o:before {
  content: "\f28c";
}
.fa-stop-circle:before {
  content: "\f28d";
}
.fa-stop-circle-o:before {
  content: "\f28e";
}
.fa-shopping-bag:before {
  content: "\f290";
}
.fa-shopping-basket:before {
  content: "\f291";
}
.fa-hashtag:before {
  content: "\f292";
}
.fa-bluetooth:before {
  content: "\f293";
}
.fa-bluetooth-b:before {
  content: "\f294";
}
.fa-percent:before {
  content: "\f295";
}
.fa-gitlab:before {
  content: "\f296";
}
.fa-wpbeginner:before {
  content: "\f297";
}
.fa-wpforms:before {
  content: "\f298";
}
.fa-envira:before {
  content: "\f299";
}
.fa-universal-access:before {
  content: "\f29a";
}
.fa-wheelchair-alt:before {
  content: "\f29b";
}
.fa-question-circle-o:before {
  content: "\f29c";
}
.fa-blind:before {
  content: "\f29d";
}
.fa-audio-description:before {
  content: "\f29e";
}
.fa-volume-control-phone:before {
  content: "\f2a0";
}
.fa-braille:before {
  content: "\f2a1";
}
.fa-assistive-listening-systems:before {
  content: "\f2a2";
}
.fa-asl-interpreting:before,
.fa-american-sign-language-interpreting:before {
  content: "\f2a3";
}
.fa-deafness:before,
.fa-hard-of-hearing:before,
.fa-deaf:before {
  content: "\f2a4";
}
.fa-glide:before {
  content: "\f2a5";
}
.fa-glide-g:before {
  content: "\f2a6";
}
.fa-signing:before,
.fa-sign-language:before {
  content: "\f2a7";
}
.fa-low-vision:before {
  content: "\f2a8";
}
.fa-viadeo:before {
  content: "\f2a9";
}
.fa-viadeo-square:before {
  content: "\f2aa";
}
.fa-snapchat:before {
  content: "\f2ab";
}
.fa-snapchat-ghost:before {
  content: "\f2ac";
}
.fa-snapchat-square:before {
  content: "\f2ad";
}
.fa-pied-piper:before {
  content: "\f2ae";
}
.fa-first-order:before {
  content: "\f2b0";
}
.fa-yoast:before {
  content: "\f2b1";
}
.fa-themeisle:before {
  content: "\f2b2";
}
.fa-google-plus-circle:before,
.fa-google-plus-official:before {
  content: "\f2b3";
}
.fa-fa:before,
.fa-font-awesome:before {
  content: "\f2b4";
}
.fa-handshake-o:before {
  content: "\f2b5";
}
.fa-envelope-open:before {
  content: "\f2b6";
}
.fa-envelope-open-o:before {
  content: "\f2b7";
}
.fa-linode:before {
  content: "\f2b8";
}
.fa-address-book:before {
  content: "\f2b9";
}
.fa-address-book-o:before {
  content: "\f2ba";
}
.fa-vcard:before,
.fa-address-card:before {
  content: "\f2bb";
}
.fa-vcard-o:before,
.fa-address-card-o:before {
  content: "\f2bc";
}
.fa-user-circle:before {
  content: "\f2bd";
}
.fa-user-circle-o:before {
  content: "\f2be";
}
.fa-user-o:before {
  content: "\f2c0";
}
.fa-id-badge:before {
  content: "\f2c1";
}
.fa-drivers-license:before,
.fa-id-card:before {
  content: "\f2c2";
}
.fa-drivers-license-o:before,
.fa-id-card-o:before {
  content: "\f2c3";
}
.fa-quora:before {
  content: "\f2c4";
}
.fa-free-code-camp:before {
  content: "\f2c5";
}
.fa-telegram:before {
  content: "\f2c6";
}
.fa-thermometer-4:before,
.fa-thermometer:before,
.fa-thermometer-full:before {
  content: "\f2c7";
}
.fa-thermometer-3:before,
.fa-thermometer-three-quarters:before {
  content: "\f2c8";
}
.fa-thermometer-2:before,
.fa-thermometer-half:before {
  content: "\f2c9";
}
.fa-thermometer-1:before,
.fa-thermometer-quarter:before {
  content: "\f2ca";
}
.fa-thermometer-0:before,
.fa-thermometer-empty:before {
  content: "\f2cb";
}
.fa-shower:before {
  content: "\f2cc";
}
.fa-bathtub:before,
.fa-s15:before,
.fa-bath:before {
  content: "\f2cd";
}
.fa-podcast:before {
  content: "\f2ce";
}
.fa-window-maximize:before {
  content: "\f2d0";
}
.fa-window-minimize:before {
  content: "\f2d1";
}
.fa-window-restore:before {
  content: "\f2d2";
}
.fa-times-rectangle:before,
.fa-window-close:before {
  content: "\f2d3";
}
.fa-times-rectangle-o:before,
.fa-window-close-o:before {
  content: "\f2d4";
}
.fa-bandcamp:before {
  content: "\f2d5";
}
.fa-grav:before {
  content: "\f2d6";
}
.fa-etsy:before {
  content: "\f2d7";
}
.fa-imdb:before {
  content: "\f2d8";
}
.fa-ravelry:before {
  content: "\f2d9";
}
.fa-eercast:before {
  content: "\f2da";
}
.fa-microchip:before {
  content: "\f2db";
}
.fa-snowflake-o:before {
  content: "\f2dc";
}
.fa-superpowers:before {
  content: "\f2dd";
}
.fa-wpexplorer:before {
  content: "\f2de";
}
.fa-meetup:before {
  content: "\f2e0";
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
/*!
*
* IPython base
*
*/
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
code {
  color: #000;
}
pre {
  font-size: inherit;
  line-height: inherit;
}
label {
  font-weight: normal;
}
/* Make the page background atleast 100% the height of the view port */
/* Make the page itself atleast 70% the height of the view port */
.border-box-sizing {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.corner-all {
  border-radius: 2px;
}
.no-padding {
  padding: 0px;
}
/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
/* This file is a compatability layer.  It allows the usage of flexible box 
model layouts accross multiple browsers, including older browsers.  The newest,
universal implementation of the flexible box model is used when available (see
`Modern browsers` comments below).  Browsers that are known to implement this 
new spec completely include:

    Firefox 28.0+
    Chrome 29.0+
    Internet Explorer 11+ 
    Opera 17.0+

Browsers not listed, including Safari, are supported via the styling under the
`Old browsers` comments below.
*/
.hbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
.hbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.vbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.vbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.hbox.reverse,
.vbox.reverse,
.reverse {
  /* Old browsers */
  -webkit-box-direction: reverse;
  -moz-box-direction: reverse;
  box-direction: reverse;
  /* Modern browsers */
  flex-direction: row-reverse;
}
.hbox.box-flex0,
.vbox.box-flex0,
.box-flex0 {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
  width: auto;
}
.hbox.box-flex1,
.vbox.box-flex1,
.box-flex1 {
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex,
.vbox.box-flex,
.box-flex {
  /* Old browsers */
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex2,
.vbox.box-flex2,
.box-flex2 {
  /* Old browsers */
  -webkit-box-flex: 2;
  -moz-box-flex: 2;
  box-flex: 2;
  /* Modern browsers */
  flex: 2;
}
.box-group1 {
  /*  Deprecated */
  -webkit-box-flex-group: 1;
  -moz-box-flex-group: 1;
  box-flex-group: 1;
}
.box-group2 {
  /* Deprecated */
  -webkit-box-flex-group: 2;
  -moz-box-flex-group: 2;
  box-flex-group: 2;
}
.hbox.start,
.vbox.start,
.start {
  /* Old browsers */
  -webkit-box-pack: start;
  -moz-box-pack: start;
  box-pack: start;
  /* Modern browsers */
  justify-content: flex-start;
}
.hbox.end,
.vbox.end,
.end {
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
}
.hbox.center,
.vbox.center,
.center {
  /* Old browsers */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  box-pack: center;
  /* Modern browsers */
  justify-content: center;
}
.hbox.baseline,
.vbox.baseline,
.baseline {
  /* Old browsers */
  -webkit-box-pack: baseline;
  -moz-box-pack: baseline;
  box-pack: baseline;
  /* Modern browsers */
  justify-content: baseline;
}
.hbox.stretch,
.vbox.stretch,
.stretch {
  /* Old browsers */
  -webkit-box-pack: stretch;
  -moz-box-pack: stretch;
  box-pack: stretch;
  /* Modern browsers */
  justify-content: stretch;
}
.hbox.align-start,
.vbox.align-start,
.align-start {
  /* Old browsers */
  -webkit-box-align: start;
  -moz-box-align: start;
  box-align: start;
  /* Modern browsers */
  align-items: flex-start;
}
.hbox.align-end,
.vbox.align-end,
.align-end {
  /* Old browsers */
  -webkit-box-align: end;
  -moz-box-align: end;
  box-align: end;
  /* Modern browsers */
  align-items: flex-end;
}
.hbox.align-center,
.vbox.align-center,
.align-center {
  /* Old browsers */
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
  /* Modern browsers */
  align-items: center;
}
.hbox.align-baseline,
.vbox.align-baseline,
.align-baseline {
  /* Old browsers */
  -webkit-box-align: baseline;
  -moz-box-align: baseline;
  box-align: baseline;
  /* Modern browsers */
  align-items: baseline;
}
.hbox.align-stretch,
.vbox.align-stretch,
.align-stretch {
  /* Old browsers */
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  box-align: stretch;
  /* Modern browsers */
  align-items: stretch;
}
div.error {
  margin: 2em;
  text-align: center;
}
div.error > h1 {
  font-size: 500%;
  line-height: normal;
}
div.error > p {
  font-size: 200%;
  line-height: normal;
}
div.traceback-wrapper {
  text-align: left;
  max-width: 800px;
  margin: auto;
}
div.traceback-wrapper pre.traceback {
  max-height: 600px;
  overflow: auto;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
body {
  background-color: #fff;
  /* This makes sure that the body covers the entire window and needs to
       be in a different element than the display: box in wrapper below */
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
  overflow: visible;
}
body > #header {
  /* Initially hidden to prevent FLOUC */
  display: none;
  background-color: #fff;
  /* Display over codemirror */
  position: relative;
  z-index: 100;
}
body > #header #header-container {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  padding: 5px;
  padding-bottom: 5px;
  padding-top: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
body > #header .header-bar {
  width: 100%;
  height: 1px;
  background: #e7e7e7;
  margin-bottom: -1px;
}
@media print {
  body > #header {
    display: none !important;
  }
}
#header-spacer {
  width: 100%;
  visibility: hidden;
}
@media print {
  #header-spacer {
    display: none;
  }
}
#ipython_notebook {
  padding-left: 0px;
  padding-top: 1px;
  padding-bottom: 1px;
}
[dir="rtl"] #ipython_notebook {
  margin-right: 10px;
  margin-left: 0;
}
[dir="rtl"] #ipython_notebook.pull-left {
  float: right !important;
  float: right;
}
.flex-spacer {
  flex: 1;
}
#noscript {
  width: auto;
  padding-top: 16px;
  padding-bottom: 16px;
  text-align: center;
  font-size: 22px;
  color: red;
  font-weight: bold;
}
#ipython_notebook img {
  height: 28px;
}
#site {
  width: 100%;
  display: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  overflow: auto;
}
@media print {
  #site {
    height: auto !important;
  }
}
/* Smaller buttons */
.ui-button .ui-button-text {
  padding: 0.2em 0.8em;
  font-size: 77%;
}
input.ui-button {
  padding: 0.3em 0.9em;
}
span#kernel_logo_widget {
  margin: 0 10px;
}
span#login_widget {
  float: right;
}
[dir="rtl"] span#login_widget {
  float: left;
}
span#login_widget > .button,
#logout {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button:focus,
#logout:focus,
span#login_widget > .button.focus,
#logout.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
span#login_widget > .button:hover,
#logout:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active:hover,
#logout:active:hover,
span#login_widget > .button.active:hover,
#logout.active:hover,
.open > .dropdown-togglespan#login_widget > .button:hover,
.open > .dropdown-toggle#logout:hover,
span#login_widget > .button:active:focus,
#logout:active:focus,
span#login_widget > .button.active:focus,
#logout.active:focus,
.open > .dropdown-togglespan#login_widget > .button:focus,
.open > .dropdown-toggle#logout:focus,
span#login_widget > .button:active.focus,
#logout:active.focus,
span#login_widget > .button.active.focus,
#logout.active.focus,
.open > .dropdown-togglespan#login_widget > .button.focus,
.open > .dropdown-toggle#logout.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  background-image: none;
}
span#login_widget > .button.disabled:hover,
#logout.disabled:hover,
span#login_widget > .button[disabled]:hover,
#logout[disabled]:hover,
fieldset[disabled] span#login_widget > .button:hover,
fieldset[disabled] #logout:hover,
span#login_widget > .button.disabled:focus,
#logout.disabled:focus,
span#login_widget > .button[disabled]:focus,
#logout[disabled]:focus,
fieldset[disabled] span#login_widget > .button:focus,
fieldset[disabled] #logout:focus,
span#login_widget > .button.disabled.focus,
#logout.disabled.focus,
span#login_widget > .button[disabled].focus,
#logout[disabled].focus,
fieldset[disabled] span#login_widget > .button.focus,
fieldset[disabled] #logout.focus {
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button .badge,
#logout .badge {
  color: #fff;
  background-color: #333;
}
.nav-header {
  text-transform: none;
}
#header > span {
  margin-top: 10px;
}
.modal_stretch .modal-dialog {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 80vh;
}
.modal_stretch .modal-dialog .modal-body {
  max-height: calc(100vh - 200px);
  overflow: auto;
  flex: 1;
}
.modal-header {
  cursor: move;
}
@media (min-width: 768px) {
  .modal .modal-dialog {
    width: 700px;
  }
}
@media (min-width: 768px) {
  select.form-control {
    margin-left: 12px;
    margin-right: 12px;
  }
}
/*!
*
* IPython auth
*
*/
.center-nav {
  display: inline-block;
  margin-bottom: -4px;
}
[dir="rtl"] .center-nav form.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] .center-nav .navbar-text {
  float: right;
}
[dir="rtl"] .navbar-inner {
  text-align: right;
}
[dir="rtl"] div.text-left {
  text-align: right;
}
/*!
*
* IPython tree view
*
*/
/* We need an invisible input field on top of the sentense*/
/* "Drag file onto the list ..." */
.alternate_upload {
  background-color: none;
  display: inline;
}
.alternate_upload.form {
  padding: 0;
  margin: 0;
}
.alternate_upload input.fileinput {
  position: absolute;
  display: block;
  width: 100%;
  height: 100%;
  overflow: hidden;
  cursor: pointer;
  opacity: 0;
  z-index: 2;
}
.alternate_upload .btn-xs > input.fileinput {
  margin: -1px -5px;
}
.alternate_upload .btn-upload {
  position: relative;
  height: 22px;
}
::-webkit-file-upload-button {
  cursor: pointer;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
ul#tabs {
  margin-bottom: 4px;
}
ul#tabs a {
  padding-top: 6px;
  padding-bottom: 4px;
}
[dir="rtl"] ul#tabs.nav-tabs > li {
  float: right;
}
[dir="rtl"] ul#tabs.nav.nav-tabs {
  padding-right: 0;
}
ul.breadcrumb a:focus,
ul.breadcrumb a:hover {
  text-decoration: none;
}
ul.breadcrumb i.icon-home {
  font-size: 16px;
  margin-right: 4px;
}
ul.breadcrumb span {
  color: #5e5e5e;
}
.list_toolbar {
  padding: 4px 0 4px 0;
  vertical-align: middle;
}
.list_toolbar .tree-buttons {
  padding-top: 1px;
}
[dir="rtl"] .list_toolbar .tree-buttons .pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .list_toolbar .col-sm-4,
[dir="rtl"] .list_toolbar .col-sm-8 {
  float: right;
}
.dynamic-buttons {
  padding-top: 3px;
  display: inline-block;
}
.list_toolbar [class*="span"] {
  min-height: 24px;
}
.list_header {
  font-weight: bold;
  background-color: #EEE;
}
.list_placeholder {
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
}
.list_container {
  margin-top: 4px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 2px;
}
.list_container > div {
  border-bottom: 1px solid #ddd;
}
.list_container > div:hover .list-item {
  background-color: red;
}
.list_container > div:last-child {
  border: none;
}
.list_item:hover .list_item {
  background-color: #ddd;
}
.list_item a {
  text-decoration: none;
}
.list_item:hover {
  background-color: #fafafa;
}
.list_header > div,
.list_item > div {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
.list_header > div input,
.list_item > div input {
  margin-right: 7px;
  margin-left: 14px;
  vertical-align: text-bottom;
  line-height: 22px;
  position: relative;
  top: -1px;
}
.list_header > div .item_link,
.list_item > div .item_link {
  margin-left: -1px;
  vertical-align: baseline;
  line-height: 22px;
}
[dir="rtl"] .list_item > div input {
  margin-right: 0;
}
.new-file input[type=checkbox] {
  visibility: hidden;
}
.item_name {
  line-height: 22px;
  height: 24px;
}
.item_icon {
  font-size: 14px;
  color: #5e5e5e;
  margin-right: 7px;
  margin-left: 7px;
  line-height: 22px;
  vertical-align: baseline;
}
.item_modified {
  margin-right: 7px;
  margin-left: 7px;
}
[dir="rtl"] .item_modified.pull-right {
  float: left !important;
  float: left;
}
.item_buttons {
  line-height: 1em;
  margin-left: -5px;
}
.item_buttons .btn,
.item_buttons .btn-group,
.item_buttons .input-group {
  float: left;
}
.item_buttons > .btn,
.item_buttons > .btn-group,
.item_buttons > .input-group {
  margin-left: 5px;
}
.item_buttons .btn {
  min-width: 13ex;
}
.item_buttons .running-indicator {
  padding-top: 4px;
  color: #5cb85c;
}
.item_buttons .kernel-name {
  padding-top: 4px;
  color: #5bc0de;
  margin-right: 7px;
  float: left;
}
[dir="rtl"] .item_buttons.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .item_buttons .kernel-name {
  margin-left: 7px;
  float: right;
}
.toolbar_info {
  height: 24px;
  line-height: 24px;
}
.list_item input:not([type=checkbox]) {
  padding-top: 3px;
  padding-bottom: 3px;
  height: 22px;
  line-height: 14px;
  margin: 0px;
}
.highlight_text {
  color: blue;
}
#project_name {
  display: inline-block;
  padding-left: 7px;
  margin-left: -2px;
}
#project_name > .breadcrumb {
  padding: 0px;
  margin-bottom: 0px;
  background-color: transparent;
  font-weight: bold;
}
.sort_button {
  display: inline-block;
  padding-left: 7px;
}
[dir="rtl"] .sort_button.pull-right {
  float: left !important;
  float: left;
}
#tree-selector {
  padding-right: 0px;
}
#button-select-all {
  min-width: 50px;
}
[dir="rtl"] #button-select-all.btn {
  float: right ;
}
#select-all {
  margin-left: 7px;
  margin-right: 2px;
  margin-top: 2px;
  height: 16px;
}
[dir="rtl"] #select-all.pull-left {
  float: right !important;
  float: right;
}
.menu_icon {
  margin-right: 2px;
}
.tab-content .row {
  margin-left: 0px;
  margin-right: 0px;
}
.folder_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f114";
}
.folder_icon:before.fa-pull-left {
  margin-right: .3em;
}
.folder_icon:before.fa-pull-right {
  margin-left: .3em;
}
.folder_icon:before.pull-left {
  margin-right: .3em;
}
.folder_icon:before.pull-right {
  margin-left: .3em;
}
.notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
}
.notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.notebook_icon:before.pull-left {
  margin-right: .3em;
}
.notebook_icon:before.pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
  color: #5cb85c;
}
.running_notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before.pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.pull-right {
  margin-left: .3em;
}
.file_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f016";
  position: relative;
  top: -2px;
}
.file_icon:before.fa-pull-left {
  margin-right: .3em;
}
.file_icon:before.fa-pull-right {
  margin-left: .3em;
}
.file_icon:before.pull-left {
  margin-right: .3em;
}
.file_icon:before.pull-right {
  margin-left: .3em;
}
#notebook_toolbar .pull-right {
  padding-top: 0px;
  margin-right: -1px;
}
ul#new-menu {
  left: auto;
  right: 0;
}
#new-menu .dropdown-header {
  font-size: 10px;
  border-bottom: 1px solid #e5e5e5;
  padding: 0 0 3px;
  margin: -3px 20px 0;
}
.kernel-menu-icon {
  padding-right: 12px;
  width: 24px;
  content: "\f096";
}
.kernel-menu-icon:before {
  content: "\f096";
}
.kernel-menu-icon-current:before {
  content: "\f00c";
}
#tab_content {
  padding-top: 20px;
}
#running .panel-group .panel {
  margin-top: 3px;
  margin-bottom: 1em;
}
#running .panel-group .panel .panel-heading {
  background-color: #EEE;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
#running .panel-group .panel .panel-heading a:focus,
#running .panel-group .panel .panel-heading a:hover {
  text-decoration: none;
}
#running .panel-group .panel .panel-body {
  padding: 0px;
}
#running .panel-group .panel .panel-body .list_container {
  margin-top: 0px;
  margin-bottom: 0px;
  border: 0px;
  border-radius: 0px;
}
#running .panel-group .panel .panel-body .list_container .list_item {
  border-bottom: 1px solid #ddd;
}
#running .panel-group .panel .panel-body .list_container .list_item:last-child {
  border-bottom: 0px;
}
.delete-button {
  display: none;
}
.duplicate-button {
  display: none;
}
.rename-button {
  display: none;
}
.move-button {
  display: none;
}
.download-button {
  display: none;
}
.shutdown-button {
  display: none;
}
.dynamic-instructions {
  display: inline-block;
  padding-top: 4px;
}
/*!
*
* IPython text editor webapp
*
*/
.selected-keymap i.fa {
  padding: 0px 5px;
}
.selected-keymap i.fa:before {
  content: "\f00c";
}
#mode-menu {
  overflow: auto;
  max-height: 20em;
}
.edit_app #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.edit_app #menubar .navbar {
  /* Use a negative 1 bottom margin, so the border overlaps the border of the
    header */
  margin-bottom: -1px;
}
.dirty-indicator {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator.pull-left {
  margin-right: .3em;
}
.dirty-indicator.pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-dirty.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty.pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-clean.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f00c";
}
.dirty-indicator-clean:before.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.pull-right {
  margin-left: .3em;
}
#filename {
  font-size: 16pt;
  display: table;
  padding: 0px 5px;
}
#current-mode {
  padding-left: 5px;
  padding-right: 5px;
}
#texteditor-backdrop {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media not print {
  #texteditor-backdrop {
    background-color: #EEE;
  }
}
@media print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container {
    padding: 0px;
    background-color: #fff;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
.CodeMirror-dialog {
  background-color: #fff;
}
/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area .rendered_html table {
  margin-left: 0;
  margin-right: 0;
}
div.output_area .rendered_html img {
  margin-left: 0;
  margin-right: 0;
}
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}
.rendered_html em {
  font-style: italic;
}
.rendered_html strong {
  font-weight: bold;
}
.rendered_html u {
  text-decoration: underline;
}
.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}
.rendered_html h1 {
  font-size: 185.7%;
  margin: 1.08em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h2 {
  font-size: 157.1%;
  margin: 1.27em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h3 {
  font-size: 128.6%;
  margin: 1.55em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h4 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h5 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h6 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}
.rendered_html ul {
  list-style: disc;
}
.rendered_html ul ul {
  list-style: square;
  margin-top: 0;
}
.rendered_html ul ul ul {
  list-style: circle;
}
.rendered_html ol {
  list-style: decimal;
}
.rendered_html ol ol {
  list-style: upper-alpha;
  margin-top: 0;
}
.rendered_html ol ol ol {
  list-style: lower-alpha;
}
.rendered_html ol ol ol ol {
  list-style: lower-roman;
}
.rendered_html ol ol ol ol ol {
  list-style: decimal;
}
.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}
.rendered_html hr {
  color: black;
  background-color: black;
}
.rendered_html pre {
  margin: 1em 2em;
  padding: 0px;
  background-color: #fff;
}
.rendered_html code {
  background-color: #eff0f1;
}
.rendered_html p code {
  padding: 1px 5px;
}
.rendered_html pre code {
  background-color: #fff;
}
.rendered_html pre,
.rendered_html code {
  border: 0;
  color: #000;
  font-size: 100%;
}
.rendered_html blockquote {
  margin: 1em 2em;
}
.rendered_html table {
  margin-left: auto;
  margin-right: auto;
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.rendered_html th {
  font-weight: bold;
}
.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}
.rendered_html p {
  text-align: left;
}
.rendered_html * + p {
  margin-top: 1em;
}
.rendered_html img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,
.rendered_html svg {
  max-width: 100%;
  height: auto;
}
.rendered_html img.unconfined,
.rendered_html svg.unconfined {
  max-width: none;
}
.rendered_html .alert {
  margin-bottom: initial;
}
.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] .rendered_html p {
  text-align: right;
}
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered .rendered_html {
  overflow-x: auto;
  overflow-y: hidden;
}
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered .rendered_html td {
  max-width: none;
}
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
/*!
*
* IPython notebook webapp
*
*/
@media (max-width: 767px) {
  .notebook_app {
    padding-left: 0px;
    padding-right: 0px;
  }
}
#ipython-main-app {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook_panel {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook {
  font-size: 14px;
  line-height: 20px;
  overflow-y: hidden;
  overflow-x: auto;
  width: 100%;
  /* This spaces the page away from the edge of the notebook area */
  padding-top: 20px;
  margin: 0px;
  outline: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  min-height: 100%;
}
@media not print {
  #notebook-container {
    padding: 15px;
    background-color: #fff;
    min-height: 0;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
@media print {
  #notebook-container {
    width: 100%;
  }
}
div.ui-widget-content {
  border: 1px solid #ababab;
  outline: none;
}
pre.dialog {
  background-color: #f7f7f7;
  border: 1px solid #ddd;
  border-radius: 2px;
  padding: 0.4em;
  padding-left: 2em;
}
p.dialog {
  padding: 0.2em;
}
/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre,
code,
kbd,
samp {
  white-space: pre-wrap;
}
#fonttest {
  font-family: monospace;
}
p {
  margin-bottom: 0;
}
.end_space {
  min-height: 100px;
  transition: height .2s ease;
}
.notebook_app > #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
@media not print {
  .notebook_app {
    background-color: #EEE;
  }
}
kbd {
  border-style: solid;
  border-width: 1px;
  box-shadow: none;
  margin: 2px;
  padding-left: 2px;
  padding-right: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
.jupyter-keybindings {
  padding: 1px;
  line-height: 24px;
  border-bottom: 1px solid gray;
}
.jupyter-keybindings input {
  margin: 0;
  padding: 0;
  border: none;
}
.jupyter-keybindings i {
  padding: 6px;
}
.well code {
  background-color: #ffffff;
  border-color: #ababab;
  border-width: 1px;
  border-style: solid;
  padding: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
/* CSS for the cell toolbar */
.celltoolbar {
  border: thin solid #CFCFCF;
  border-bottom: none;
  background: #EEE;
  border-radius: 2px 2px 0px 0px;
  width: 100%;
  height: 29px;
  padding-right: 4px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
  display: -webkit-flex;
}
@media print {
  .celltoolbar {
    display: none;
  }
}
.ctb_hideshow {
  display: none;
  vertical-align: bottom;
}
/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.
   Cell toolbars are only shown when the ctb_global_show class is also set.
*/
.ctb_global_show .ctb_show.ctb_hideshow {
  display: block;
}
.ctb_global_show .ctb_show + .input_area,
.ctb_global_show .ctb_show + div.text_cell_input,
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border-top-right-radius: 0px;
  border-top-left-radius: 0px;
}
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border: 1px solid #cfcfcf;
}
.celltoolbar {
  font-size: 87%;
  padding-top: 3px;
}
.celltoolbar select {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  width: inherit;
  font-size: inherit;
  height: 22px;
  padding: 0px;
  display: inline-block;
}
.celltoolbar select:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.celltoolbar select::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.celltoolbar select:-ms-input-placeholder {
  color: #999;
}
.celltoolbar select::-webkit-input-placeholder {
  color: #999;
}
.celltoolbar select::-ms-expand {
  border: 0;
  background-color: transparent;
}
.celltoolbar select[disabled],
.celltoolbar select[readonly],
fieldset[disabled] .celltoolbar select {
  background-color: #eeeeee;
  opacity: 1;
}
.celltoolbar select[disabled],
fieldset[disabled] .celltoolbar select {
  cursor: not-allowed;
}
textarea.celltoolbar select {
  height: auto;
}
select.celltoolbar select {
  height: 30px;
  line-height: 30px;
}
textarea.celltoolbar select,
select[multiple].celltoolbar select {
  height: auto;
}
.celltoolbar label {
  margin-left: 5px;
  margin-right: 5px;
}
.tags_button_container {
  width: 100%;
  display: flex;
}
.tag-container {
  display: flex;
  flex-direction: row;
  flex-grow: 1;
  overflow: hidden;
  position: relative;
}
.tag-container > * {
  margin: 0 4px;
}
.remove-tag-btn {
  margin-left: 4px;
}
.tags-input {
  display: flex;
}
.cell-tag:last-child:after {
  content: "";
  position: absolute;
  right: 0;
  width: 40px;
  height: 100%;
  /* Fade to background color of cell toolbar */
  background: linear-gradient(to right, rgba(0, 0, 0, 0), #EEE);
}
.tags-input > * {
  margin-left: 4px;
}
.cell-tag,
.tags-input input,
.tags-input button {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  box-shadow: none;
  width: inherit;
  font-size: inherit;
  height: 22px;
  line-height: 22px;
  padding: 0px 4px;
  display: inline-block;
}
.cell-tag:focus,
.tags-input input:focus,
.tags-input button:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.cell-tag::-moz-placeholder,
.tags-input input::-moz-placeholder,
.tags-input button::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.cell-tag:-ms-input-placeholder,
.tags-input input:-ms-input-placeholder,
.tags-input button:-ms-input-placeholder {
  color: #999;
}
.cell-tag::-webkit-input-placeholder,
.tags-input input::-webkit-input-placeholder,
.tags-input button::-webkit-input-placeholder {
  color: #999;
}
.cell-tag::-ms-expand,
.tags-input input::-ms-expand,
.tags-input button::-ms-expand {
  border: 0;
  background-color: transparent;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
.cell-tag[readonly],
.tags-input input[readonly],
.tags-input button[readonly],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  background-color: #eeeeee;
  opacity: 1;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  cursor: not-allowed;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button {
  height: auto;
}
select.cell-tag,
select.tags-input input,
select.tags-input button {
  height: 30px;
  line-height: 30px;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button,
select[multiple].cell-tag,
select[multiple].tags-input input,
select[multiple].tags-input button {
  height: auto;
}
.cell-tag,
.tags-input button {
  padding: 0px 4px;
}
.cell-tag {
  background-color: #fff;
  white-space: nowrap;
}
.tags-input input[type=text]:focus {
  outline: none;
  box-shadow: none;
  border-color: #ccc;
}
.completions {
  position: absolute;
  z-index: 110;
  overflow: hidden;
  border: 1px solid #ababab;
  border-radius: 2px;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  line-height: 1;
}
.completions select {
  background: white;
  outline: none;
  border: none;
  padding: 0px;
  margin: 0px;
  overflow: auto;
  font-family: monospace;
  font-size: 110%;
  color: #000;
  width: auto;
}
.completions select option.context {
  color: #286090;
}
#kernel_logo_widget .current_kernel_logo {
  display: none;
  margin-top: -1px;
  margin-bottom: -1px;
  width: 32px;
  height: 32px;
}
[dir="rtl"] #kernel_logo_widget {
  float: left !important;
  float: left;
}
.modal .modal-body .move-path {
  display: flex;
  flex-direction: row;
  justify-content: space;
  align-items: center;
}
.modal .modal-body .move-path .server-root {
  padding-right: 20px;
}
.modal .modal-body .move-path .path-input {
  flex: 1;
}
#menubar {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  margin-top: 1px;
}
#menubar .navbar {
  border-top: 1px;
  border-radius: 0px 0px 2px 2px;
  margin-bottom: 0px;
}
#menubar .navbar-toggle {
  float: left;
  padding-top: 7px;
  padding-bottom: 7px;
  border: none;
}
#menubar .navbar-collapse {
  clear: left;
}
[dir="rtl"] #menubar .navbar-toggle {
  float: right;
}
[dir="rtl"] #menubar .navbar-collapse {
  clear: right;
}
[dir="rtl"] #menubar .navbar-nav {
  float: right;
}
[dir="rtl"] #menubar .nav {
  padding-right: 0px;
}
[dir="rtl"] #menubar .navbar-nav > li {
  float: right;
}
[dir="rtl"] #menubar .navbar-right {
  float: left !important;
}
[dir="rtl"] ul.dropdown-menu {
  text-align: right;
  left: auto;
}
[dir="rtl"] ul#new-menu.dropdown-menu {
  right: auto;
  left: 0;
}
.nav-wrapper {
  border-bottom: 1px solid #e7e7e7;
}
i.menu-icon {
  padding-top: 4px;
}
[dir="rtl"] i.menu-icon.pull-right {
  float: left !important;
  float: left;
}
ul#help_menu li a {
  overflow: hidden;
  padding-right: 2.2em;
}
ul#help_menu li a i {
  margin-right: -1.2em;
}
[dir="rtl"] ul#help_menu li a {
  padding-left: 2.2em;
}
[dir="rtl"] ul#help_menu li a i {
  margin-right: 0;
  margin-left: -1.2em;
}
[dir="rtl"] ul#help_menu li a i.pull-right {
  float: left !important;
  float: left;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu > .dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
}
[dir="rtl"] .dropdown-submenu > .dropdown-menu {
  right: 100%;
  margin-right: -1px;
}
.dropdown-submenu:hover > .dropdown-menu {
  display: block;
}
.dropdown-submenu > a:after {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: block;
  content: "\f0da";
  float: right;
  color: #333333;
  margin-top: 2px;
  margin-right: -10px;
}
.dropdown-submenu > a:after.fa-pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.fa-pull-right {
  margin-left: .3em;
}
.dropdown-submenu > a:after.pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.pull-right {
  margin-left: .3em;
}
[dir="rtl"] .dropdown-submenu > a:after {
  float: left;
  content: "\f0d9";
  margin-right: 0;
  margin-left: -10px;
}
.dropdown-submenu:hover > a:after {
  color: #262626;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left > .dropdown-menu {
  left: -100%;
  margin-left: 10px;
}
#notification_area {
  float: right !important;
  float: right;
  z-index: 10;
}
[dir="rtl"] #notification_area {
  float: left !important;
  float: left;
}
.indicator_area {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] .indicator_area {
  float: left !important;
  float: left;
}
#kernel_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  border-left: 1px solid;
}
#kernel_indicator .kernel_indicator_name {
  padding-left: 5px;
  padding-right: 5px;
}
[dir="rtl"] #kernel_indicator {
  float: left !important;
  float: left;
  border-left: 0;
  border-right: 1px solid;
}
#modal_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] #modal_indicator {
  float: left !important;
  float: left;
}
#readonly-indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  margin-top: 2px;
  margin-bottom: 0px;
  margin-left: 0px;
  margin-right: 0px;
  display: none;
}
.modal_indicator:before {
  width: 1.28571429em;
  text-align: center;
}
.edit_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f040";
}
.edit_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.edit_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: ' ';
}
.command_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f10c";
}
.kernel_idle_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f111";
}
.kernel_busy_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f1e2";
}
.kernel_dead_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f127";
}
.kernel_disconnected_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.pull-right {
  margin-left: .3em;
}
.notification_widget {
  color: #777;
  z-index: 10;
  background: rgba(240, 240, 240, 0.5);
  margin-right: 4px;
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget:focus,
.notification_widget.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.notification_widget:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active:hover,
.notification_widget.active:hover,
.open > .dropdown-toggle.notification_widget:hover,
.notification_widget:active:focus,
.notification_widget.active:focus,
.open > .dropdown-toggle.notification_widget:focus,
.notification_widget:active.focus,
.notification_widget.active.focus,
.open > .dropdown-toggle.notification_widget.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  background-image: none;
}
.notification_widget.disabled:hover,
.notification_widget[disabled]:hover,
fieldset[disabled] .notification_widget:hover,
.notification_widget.disabled:focus,
.notification_widget[disabled]:focus,
fieldset[disabled] .notification_widget:focus,
.notification_widget.disabled.focus,
.notification_widget[disabled].focus,
fieldset[disabled] .notification_widget.focus {
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget .badge {
  color: #fff;
  background-color: #333;
}
.notification_widget.warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning:focus,
.notification_widget.warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.notification_widget.warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active:hover,
.notification_widget.warning.active:hover,
.open > .dropdown-toggle.notification_widget.warning:hover,
.notification_widget.warning:active:focus,
.notification_widget.warning.active:focus,
.open > .dropdown-toggle.notification_widget.warning:focus,
.notification_widget.warning:active.focus,
.notification_widget.warning.active.focus,
.open > .dropdown-toggle.notification_widget.warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  background-image: none;
}
.notification_widget.warning.disabled:hover,
.notification_widget.warning[disabled]:hover,
fieldset[disabled] .notification_widget.warning:hover,
.notification_widget.warning.disabled:focus,
.notification_widget.warning[disabled]:focus,
fieldset[disabled] .notification_widget.warning:focus,
.notification_widget.warning.disabled.focus,
.notification_widget.warning[disabled].focus,
fieldset[disabled] .notification_widget.warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.notification_widget.success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success:focus,
.notification_widget.success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.notification_widget.success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active:hover,
.notification_widget.success.active:hover,
.open > .dropdown-toggle.notification_widget.success:hover,
.notification_widget.success:active:focus,
.notification_widget.success.active:focus,
.open > .dropdown-toggle.notification_widget.success:focus,
.notification_widget.success:active.focus,
.notification_widget.success.active.focus,
.open > .dropdown-toggle.notification_widget.success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  background-image: none;
}
.notification_widget.success.disabled:hover,
.notification_widget.success[disabled]:hover,
fieldset[disabled] .notification_widget.success:hover,
.notification_widget.success.disabled:focus,
.notification_widget.success[disabled]:focus,
fieldset[disabled] .notification_widget.success:focus,
.notification_widget.success.disabled.focus,
.notification_widget.success[disabled].focus,
fieldset[disabled] .notification_widget.success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.notification_widget.info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info:focus,
.notification_widget.info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.notification_widget.info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active:hover,
.notification_widget.info.active:hover,
.open > .dropdown-toggle.notification_widget.info:hover,
.notification_widget.info:active:focus,
.notification_widget.info.active:focus,
.open > .dropdown-toggle.notification_widget.info:focus,
.notification_widget.info:active.focus,
.notification_widget.info.active.focus,
.open > .dropdown-toggle.notification_widget.info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  background-image: none;
}
.notification_widget.info.disabled:hover,
.notification_widget.info[disabled]:hover,
fieldset[disabled] .notification_widget.info:hover,
.notification_widget.info.disabled:focus,
.notification_widget.info[disabled]:focus,
fieldset[disabled] .notification_widget.info:focus,
.notification_widget.info.disabled.focus,
.notification_widget.info[disabled].focus,
fieldset[disabled] .notification_widget.info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.notification_widget.danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger:focus,
.notification_widget.danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.notification_widget.danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active:hover,
.notification_widget.danger.active:hover,
.open > .dropdown-toggle.notification_widget.danger:hover,
.notification_widget.danger:active:focus,
.notification_widget.danger.active:focus,
.open > .dropdown-toggle.notification_widget.danger:focus,
.notification_widget.danger:active.focus,
.notification_widget.danger.active.focus,
.open > .dropdown-toggle.notification_widget.danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  background-image: none;
}
.notification_widget.danger.disabled:hover,
.notification_widget.danger[disabled]:hover,
fieldset[disabled] .notification_widget.danger:hover,
.notification_widget.danger.disabled:focus,
.notification_widget.danger[disabled]:focus,
fieldset[disabled] .notification_widget.danger:focus,
.notification_widget.danger.disabled.focus,
.notification_widget.danger[disabled].focus,
fieldset[disabled] .notification_widget.danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger .badge {
  color: #d9534f;
  background-color: #fff;
}
div#pager {
  background-color: #fff;
  font-size: 14px;
  line-height: 20px;
  overflow: hidden;
  display: none;
  position: fixed;
  bottom: 0px;
  width: 100%;
  max-height: 50%;
  padding-top: 8px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  /* Display over codemirror */
  z-index: 100;
  /* Hack which prevents jquery ui resizable from changing top. */
  top: auto !important;
}
div#pager pre {
  line-height: 1.21429em;
  color: #000;
  background-color: #f7f7f7;
  padding: 0.4em;
}
div#pager #pager-button-area {
  position: absolute;
  top: 8px;
  right: 20px;
}
div#pager #pager-contents {
  position: relative;
  overflow: auto;
  width: 100%;
  height: 100%;
}
div#pager #pager-contents #pager-container {
  position: relative;
  padding: 15px 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
div#pager .ui-resizable-handle {
  top: 0px;
  height: 8px;
  background: #f7f7f7;
  border-top: 1px solid #cfcfcf;
  border-bottom: 1px solid #cfcfcf;
  /* This injects handle bars (a short, wide = symbol) for 
        the resize handle. */
}
div#pager .ui-resizable-handle::after {
  content: '';
  top: 2px;
  left: 50%;
  height: 3px;
  width: 30px;
  margin-left: -15px;
  position: absolute;
  border-top: 1px solid #cfcfcf;
}
.quickhelp {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  line-height: 1.8em;
}
.shortcut_key {
  display: inline-block;
  width: 21ex;
  text-align: right;
  font-family: monospace;
}
.shortcut_descr {
  display: inline-block;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
span.save_widget {
  height: 30px;
  margin-top: 4px;
  display: flex;
  justify-content: flex-start;
  align-items: baseline;
  width: 50%;
  flex: 1;
}
span.save_widget span.filename {
  height: 100%;
  line-height: 1em;
  margin-left: 16px;
  border: none;
  font-size: 146.5%;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  border-radius: 2px;
}
span.save_widget span.filename:hover {
  background-color: #e6e6e6;
}
[dir="rtl"] span.save_widget.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] span.save_widget span.filename {
  margin-left: 0;
  margin-right: 16px;
}
span.checkpoint_status,
span.autosave_status {
  font-size: small;
  white-space: nowrap;
  padding: 0 5px;
}
@media (max-width: 767px) {
  span.save_widget {
    font-size: small;
    padding: 0 0 0 5px;
  }
  span.checkpoint_status,
  span.autosave_status {
    display: none;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  span.checkpoint_status {
    display: none;
  }
  span.autosave_status {
    font-size: x-small;
  }
}
.toolbar {
  padding: 0px;
  margin-left: -5px;
  margin-top: 2px;
  margin-bottom: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.toolbar select,
.toolbar label {
  width: auto;
  vertical-align: middle;
  margin-right: 2px;
  margin-bottom: 0px;
  display: inline;
  font-size: 92%;
  margin-left: 0.3em;
  margin-right: 0.3em;
  padding: 0px;
  padding-top: 3px;
}
.toolbar .btn {
  padding: 2px 8px;
}
.toolbar .btn-group {
  margin-top: 0px;
  margin-left: 5px;
}
.toolbar-btn-label {
  margin-left: 6px;
}
#maintoolbar {
  margin-bottom: -3px;
  margin-top: -8px;
  border: 0px;
  min-height: 27px;
  margin-left: 0px;
  padding-top: 11px;
  padding-bottom: 3px;
}
#maintoolbar .navbar-text {
  float: none;
  vertical-align: middle;
  text-align: right;
  margin-left: 5px;
  margin-right: 0px;
  margin-top: 0px;
}
.select-xs {
  height: 24px;
}
[dir="rtl"] .btn-group > .btn,
.btn-group-vertical > .btn {
  float: right;
}
.pulse,
.dropdown-menu > li > a.pulse,
li.pulse > a.dropdown-toggle,
li.pulse.open > a.dropdown-toggle {
  background-color: #F37626;
  color: white;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
/** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot
 * of chance of beeing generated from the ../less/[samename].less file, you can
 * try to get back the less file by reverting somme commit in history
 **/
/*
 * We'll try to get something pretty, so we
 * have some strange css to have the scroll bar on
 * the left with fix button on the top right of the tooltip
 */
@-moz-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-webkit-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-moz-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/*properties of tooltip after "expand"*/
.bigtooltip {
  overflow: auto;
  height: 200px;
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
}
/*properties of tooltip before "expand"*/
.smalltooltip {
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 80px;
}
.tooltipbuttons {
  position: absolute;
  padding-right: 15px;
  top: 0px;
  right: 0px;
}
.tooltiptext {
  /*avoid the button to overlap on some docstring*/
  padding-right: 30px;
}
.ipython_tooltip {
  max-width: 700px;
  /*fade-in animation when inserted*/
  -webkit-animation: fadeOut 400ms;
  -moz-animation: fadeOut 400ms;
  animation: fadeOut 400ms;
  -webkit-animation: fadeIn 400ms;
  -moz-animation: fadeIn 400ms;
  animation: fadeIn 400ms;
  vertical-align: middle;
  background-color: #f7f7f7;
  overflow: visible;
  border: #ababab 1px solid;
  outline: none;
  padding: 3px;
  margin: 0px;
  padding-left: 7px;
  font-family: monospace;
  min-height: 50px;
  -moz-box-shadow: 0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
}
.ipython_tooltip a {
  float: right;
}
.ipython_tooltip .tooltiptext pre {
  border: 0;
  border-radius: 0;
  font-size: 100%;
  background-color: #f7f7f7;
}
.pretooltiparrow {
  left: 0px;
  margin: 0px;
  top: -16px;
  width: 40px;
  height: 16px;
  overflow: hidden;
  position: absolute;
}
.pretooltiparrow:before {
  background-color: #f7f7f7;
  border: 1px #ababab solid;
  z-index: 11;
  content: "";
  position: absolute;
  left: 15px;
  top: 10px;
  width: 25px;
  height: 25px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
ul.typeahead-list i {
  margin-left: -10px;
  width: 18px;
}
[dir="rtl"] ul.typeahead-list i {
  margin-left: 0;
  margin-right: -10px;
}
ul.typeahead-list {
  max-height: 80vh;
  overflow: auto;
}
ul.typeahead-list > li > a {
  /** Firefox bug **/
  /* see https://github.com/jupyter/notebook/issues/559 */
  white-space: normal;
}
ul.typeahead-list  > li > a.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .typeahead-list {
  text-align: right;
}
.cmd-palette .modal-body {
  padding: 7px;
}
.cmd-palette form {
  background: white;
}
.cmd-palette input {
  outline: none;
}
.no-shortcut {
  min-width: 20px;
  color: transparent;
}
[dir="rtl"] .no-shortcut.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .command-shortcut.pull-right {
  float: left !important;
  float: left;
}
.command-shortcut:before {
  content: "(command mode)";
  padding-right: 3px;
  color: #777777;
}
.edit-shortcut:before {
  content: "(edit)";
  padding-right: 3px;
  color: #777777;
}
[dir="rtl"] .edit-shortcut.pull-right {
  float: left !important;
  float: left;
}
#find-and-replace #replace-preview .match,
#find-and-replace #replace-preview .insert {
  background-color: #BBDEFB;
  border-color: #90CAF9;
  border-style: solid;
  border-width: 1px;
  border-radius: 0px;
}
[dir="ltr"] #find-and-replace .input-group-btn + .form-control {
  border-left: none;
}
[dir="rtl"] #find-and-replace .input-group-btn + .form-control {
  border-right: none;
}
#find-and-replace #replace-preview .replace .match {
  background-color: #FFCDD2;
  border-color: #EF9A9A;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .insert {
  background-color: #C8E6C9;
  border-color: #A5D6A7;
  border-radius: 0px;
}
#find-and-replace #replace-preview {
  max-height: 60vh;
  overflow: auto;
}
#find-and-replace #replace-preview pre {
  padding: 5px 10px;
}
.terminal-app {
  background: #EEE;
}
.terminal-app #header {
  background: #fff;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.terminal-app .terminal {
  width: 100%;
  float: left;
  font-family: monospace;
  color: white;
  background: black;
  padding: 0.4em;
  border-radius: 2px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
}
.terminal-app .terminal,
.terminal-app .terminal dummy-screen {
  line-height: 1em;
  font-size: 14px;
}
.terminal-app .terminal .xterm-rows {
  padding: 10px;
}
.terminal-app .terminal-cursor {
  color: black;
  background: white;
}
.terminal-app #terminado-container {
  margin-top: 20px;
}
/*# sourceMappingURL=style.min.css.map */
    </style>
<style type="text/css">
    .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>


<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>

 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css">

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>

<link rel="stylesheet" type="text/css" href="https://rawgit.com/ipython-contrib/jupyter_contrib_nbextensions/master/src/jupyter_contrib_nbextensions/nbextensions/toc2/main.css">

<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<script src="https://rawgit.com/ipython-contrib/jupyter_contrib_nbextensions/master/src/jupyter_contrib_nbextensions/nbextensions/toc2/toc2.js"></script>

<script>
$( document ).ready(function(){

            var cfg = {"base_numbering": 1, "nav_menu": {}, "number_sections": true, "sideBar": true, "skip_h1_title": false, "title_cell": "Table of Contents", "title_sidebar": "Contents", "toc_cell": false, "toc_position": {"height": "521.6px", "left": "86px", "top": "66.8px", "width": "165px"}, "toc_section_display": true, "toc_window_display": true};

            // fire the main function with these parameters
            require(['nbextensions/toc2/toc2'], function (toc2) {
                toc2.table_of_contents(cfg);
            });
    });
</script>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>CSCI 440 Machine Learning <br>
Spring 2021, Biola University <br>
Instructor : Genti Buzi <br></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Some-Python-Preliminaries-(Probability,-MatPlotLib,-NumPy,-etc)">Some Python Preliminaries (Probability, MatPlotLib, NumPy, etc)<a class="anchor-link" href="#Some-Python-Preliminaries-(Probability,-MatPlotLib,-NumPy,-etc)">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Importing-Libraries">Importing Libraries<a class="anchor-link" href="#Importing-Libraries">&#182;</a></h2>
<pre><code>matplotlib : used for plotting
numpy      : implementation of many useful mathematical operations</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plots-in-$\mathbb{R}^2$">Plots in $\mathbb{R}^2$<a class="anchor-link" href="#Plots-in-$\mathbb{R}^2$">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-plotting-simple-functions.">Example plotting simple functions.<a class="anchor-link" href="#Example-plotting-simple-functions.">&#182;</a></h3><p>The sign function 
\begin{equation*}
f(x)=\text{sign}(x)
\end{equation*}
can be approximated by the hyperbolic tangent function<br>
\begin{equation*}
f(x)=\tanh(kx)
\end{equation*}
for $k$ large enough. <br>
The numpy library has implementations of all the above functions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>  <span class="c1">#generates 200 equally spaced points in  [-5, 5),  starting from value -5 not including 5</span>
<span class="n">y1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>           <span class="c1">#gets the corresponding value for those points based on the sign function</span>

<span class="c1">#plot the sign function based on the points generated above</span>
<span class="n">f1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>            
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Approximations of the Sign function&quot;</span><span class="p">)</span>
<span class="c1">#plot the tanh function on the same plot, for 4 different k values</span>
<span class="n">k</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="s2">&quot;brown&quot;</span><span class="p">,</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">yk</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">yk</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="c1">#create a grid and a legend    </span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s2">&quot;sign(x)&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh(x/2)&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh(x)&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh(2x)&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh(10x)&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x24ec406e8c8&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_6_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Probability-and--Random-Variables">Probability and  Random Variables<a class="anchor-link" href="#Probability-and--Random-Variables">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Generating-random-values">Generating random values<a class="anchor-link" href="#Generating-random-values">&#182;</a></h3><p>One can use the <em>random</em> module of <em>numpy</em> to generate random numbers from different distributions. <br>
Lets try a few different distributions.</p>
<blockquote><ul>
<li>Simulating the roll of a die : randomnly generate $n$ numbers from the {1,2,3,4,5,6} set, each equally likely to be picked. <br> 
Use <strong>randint</strong> function in the <em>random</em> module of <em>numpy</em>, can be used to generate integer numbers from a uniform distribution.<blockquote><ul>
<li>Generate 10,000 random numbers. Count and plot the frequency of occurence for each value </li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span>
<span class="c1"># 1</span>
<span class="n">r</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 10 random values generated :&quot;</span><span class="p">,</span> <span class="n">r</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>

<span class="n">x</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">);</span>
<span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">frequency</span><span class="o">=</span><span class="p">[];</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
    <span class="n">frequency</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">();</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">frequency</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution of values for 10,000 rolls&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>First 10 random values generated : [4 4 1 6 2 5 2 1 2 4]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;Distribution of values for 10,000 rolls&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_9_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><ul>
<li><p>Randomly generate numbers uniformly in the $\left[0,1\right]$ interval. <br> 
Can use <strong>rand</strong> function in the <em>random</em> module of <em>numpy</em>.</p>
</li>
<li><p>Randomly generate numbers uniformly in the $\left[-5,5\right]$ interval.</p>
<blockquote><ol>
<li>Generate numbers uniformly in $\left[0,1\right]$</li>
<li>Scale the by 10 by multiplying by 10), so the numbers are distributed uniformly in  $\left[0,10\right]$</li>
<li>Shift by 5 by subtracting 5, so the numbers are distributed uniformly in  $\left[-5,5\right]$</li>
</ol>
</blockquote>
</li>
</ul>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">ru</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;random numbers between 0 and 1:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ru</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>

<span class="n">ru2</span><span class="o">=</span><span class="n">ru</span><span class="o">*</span><span class="mi">10</span><span class="o">-</span><span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The numbers above shifted to -5,5 range:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ru2</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>10 random numbers between 0 and 1:
 [0.91513287 0.2429633  0.22091642 0.70134504 0.81035603 0.87256332
 0.47538636 0.47408078 0.08027397 0.4694664 ]
The numbers above shifted to -5,5 range:
 [ 4.15132873 -2.57036701 -2.79083575  2.01345044  3.10356026  3.72563317
 -0.24613637 -0.25919219 -4.19726028 -0.305336  ]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><ul>
<li>Randomly generate 10,000 values from a Gaussian (normal) distribution with mean $\mu$ and standard deviation $\sigma$. <br>
Using <strong>normal</strong> function in the <em>random</em> module of <em>numpy</em>.<br>
Density function of the Gaussian is the bell-shaped curve given by 
\begin{equation*}
f(x)=\frac{1}{\sqrt{2\pi \sigma ^2}}e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}
\end{equation*}</li>
<li>Plot the empirical distribution</li>
</ul>
</blockquote>
<p>Note: <em>scipy.stats</em> library has a large amount of statistical functions and distributions implemented (<a href="https://docs.scipy.org/doc/scipy/reference/stats.html">https://docs.scipy.org/doc/scipy/reference/stats.html</a>)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span>

<span class="n">mu</span><span class="o">=</span><span class="mi">2</span>
<span class="n">sigma</span><span class="o">=</span><span class="mi">3</span>
<span class="n">rn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;gaussian random numbers with mean=&quot;</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s2">&quot; and std=&quot;</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rn</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#get histograms - play around with the number of bins etc.</span>
<span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">rn</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">f1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">x</span><span class="o">=</span><span class="n">b1</span><span class="p">[</span><span class="mi">1</span><span class="p">:];</span>
<span class="n">dx</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="n">y</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">dx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">a1</span><span class="o">/</span><span class="n">n</span><span class="o">/</span><span class="n">dx</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Gaussian Distribution&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;density&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">,</span><span class="s1">&#39;Empirical&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>10 gaussian random numbers with mean= 2  and std= 3 :
[ 4.88744063 -1.52529125  3.39675928  2.155589    4.64688286  2.40485209
  0.25920088 -1.19943666  0.64332945  0.83581829] 

</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x24ec511f2c8&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_13_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NumPy-Arrays">NumPy Arrays<a class="anchor-link" href="#NumPy-Arrays">&#182;</a></h2><p>NumPys main data structure is the (multidimensional) array.</p>
<p>Note: here is a good resource for learning more about NumPy arrays (<a href="https://www.oreilly.com/library/view/machine-learning-with/9781491989371/ch01.html">https://www.oreilly.com/library/view/machine-learning-with/9781491989371/ch01.html</a>)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Vectors-(1D-arrays)">Vectors (1D arrays)<a class="anchor-link" href="#Vectors-(1D-arrays)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span> <span class="c1">#generate a random array of size 10</span>

<span class="n">a</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>   <span class="c1">#the 4th element of v (element of index 3, counting starts at 0)</span>
<span class="n">b</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1">#the last element of v </span>
<span class="n">c</span><span class="o">=</span><span class="n">v</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>  <span class="c1">#the first 4 elements of v</span>
<span class="n">d</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>  <span class="c1">#the last elements of v starting from index 2</span>
<span class="n">e</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="c1">#the elements of v with index 1,2,3,4</span>
<span class="n">f</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">]</span> <span class="c1">#the elements of v that are greater than 50</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v :&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>v : [ 2 33  5 60 13 61 39 81 24 17] 

60
17
[ 2 33  5 60]
[ 5 60 13 61 39 81 24 17]
[33  5 60 13]
[60 61 81]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Operations">Operations<a class="anchor-link" href="#Operations">&#182;</a></h4><ol>
<li>operators +,-,* , /, ** (power) are defined as element by element operations</li>
<li>Given two vectors 
\begin{equation*}
\begin{matrix}
v &amp; = &amp; \left[ v_0,v_1, ...,v_n \right] \\
u &amp; = &amp; \left[ u_0,u_1, ...,u_n \right] \\
\end{matrix}
\end{equation*}
the <strong>dot product</strong>: $v\cdot u$ is defined 
\begin{equation*}
v\cdot u=v_0u_0+v_1u_1+...+v_nu_n=\sum_{i=0}^{n}v_iu_i
\end{equation*}</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">5</span>
<span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">))</span> <span class="c1">#generate a random array of size n</span>
<span class="n">a</span><span class="o">=</span><span class="n">v</span><span class="o">*</span><span class="mi">10</span>    <span class="c1">#the elements of v multiplied by 10</span>
<span class="n">b</span><span class="o">=</span><span class="n">v</span><span class="o">-</span><span class="mi">50</span>   <span class="c1">#the elements of v substracted 50</span>
<span class="n">c</span><span class="o">=</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span>   <span class="c1">#the square of the elements of v </span>
<span class="n">d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1">#the square root of the elements of v</span>
<span class="n">e</span><span class="o">=-</span><span class="n">v</span> <span class="c1">#the negation of v</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v :&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">u</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="n">n</span><span class="p">))</span> <span class="c1">#array consisting of n points between 0 and 16 inclusive</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">u :&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">f</span><span class="o">=</span><span class="n">v</span><span class="o">*</span><span class="n">u</span> <span class="c1">#element by element multiplication</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f=u*v : &quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">=</span><span class="n">v</span><span class="o">+</span><span class="n">u</span> <span class="c1">#element by element addition</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;g=u+v : &quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>  <span class="c1">#dot product of the array </span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;h= np.dot(u,v) : &quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#alternatives ways of doing the dot product</span>
<span class="n">h1</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">h2</span><span class="o">=</span><span class="n">u</span> <span class="o">@</span> <span class="n">v</span> <span class="c1">#python 3.5 and after only</span>

<span class="nb">print</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span><span class="n">h2</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>v : [22 39  4 79 74] 

[220 390  40 790 740]
[-28 -11 -46  29  24]
[ 484 1521   16 6241 5476]
[4.69041576 6.244998   2.         8.88819442 8.60232527]
[-22 -39  -4 -79 -74]


u : [ 0.  4.  8. 12. 16.] 

f=u*v :  [   0.  156.   32.  948. 1184.] 

g=u+v :  [22. 43. 12. 91. 90.] 

h= np.dot(u,v) :  2320.0 

2320.0
2320.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Two-dimensional-arrays">Two dimensional arrays<a class="anchor-link" href="#Two-dimensional-arrays">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">45</span><span class="p">]])</span> <span class="c1"># 1x4 array (you can think of as row vector)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">v2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">11</span><span class="p">],[</span><span class="mi">21</span><span class="p">],[</span><span class="mi">31</span><span class="p">],[</span><span class="mi">45</span><span class="p">]])</span> <span class="c1"># 4x1 array (you can think of as a column vector)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">v3</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span> <span class="c1">#2x4 array (you can think of as a matrix)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">v4</span><span class="o">=</span><span class="n">v3</span><span class="o">.</span><span class="n">T</span> <span class="c1">#the transpose of v3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[10 20 30 45]] 

[[11]
 [21]
 [31]
 [45]] 

[[1 2]
 [3 4]
 [5 6]
 [7 8]] 

[[1 3 5 7]
 [2 4 6 8]] 

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Operations">Operations<a class="anchor-link" href="#Operations">&#182;</a></h4><ol>
<li>Selection of elements etc. similar to vectors</li>
<li>operators +,-,* , /, ** (power) are defined as element by element operations (as in vectors)</li>
<li>Matrix multiplication:  use the dot product. </li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="c1">#generate a 5x3 array with random values in 0..1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">a21</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#the element with row index 2 and column index 1</span>
<span class="n">c1</span><span class="o">=</span><span class="n">A</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#the column with index 1</span>
<span class="n">r2</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="c1">#the row with index 2</span>
<span class="n">rl</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">:,</span> <span class="p">:]</span> <span class="c1">#the rows of A with index &gt;=3</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a21</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">rl</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span> <span class="c1">#generate a random row vector of size 5</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v :&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">u</span><span class="o">=</span><span class="n">v</span> <span class="o">@</span> <span class="n">A</span> <span class="c1">#vector-matrix multiplication</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u= v @ A : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>A : 
 [[0.74117468 0.74938218 0.10913808]
 [0.85646168 0.78471416 0.33491499]
 [0.43740461 0.92936231 0.27988694]
 [0.79743927 0.05017839 0.05364916]
 [0.41477954 0.11597268 0.03934672]] 

0.9293623055499857
[0.74938218 0.78471416 0.92936231 0.05017839 0.11597268]
[0.43740461 0.92936231 0.27988694]
[[0.79743927 0.05017839 0.05364916]
 [0.41477954 0.11597268 0.03934672]]
v : [92 63 13 61 85] 

u= v @ A : 
 [211.73147186 143.38042192  41.39594739] 

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="More-Operations-on-Arrays">More Operations on Arrays<a class="anchor-link" href="#More-Operations-on-Arrays">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="c1">#generate a 5x3 array with random values in 0..1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A : </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="c1"># average of all the elements</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#average of each column</span>
<span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#average of each row</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#sum, std (standard deviation) work similarly d=np.std(A), e=np.sum(A,axis=1), etc.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>A : 
 [[0.82215101 0.04872044 0.37227996]
 [0.63353584 0.00560583 0.96978225]
 [0.6205067  0.38662442 0.14682825]
 [0.47395164 0.86482195 0.89665995]
 [0.9554669  0.56638288 0.18379234]] 

0.529807357355747
[0.70112242 0.3744311  0.51386855]
[0.4143838  0.53630797 0.38465312 0.74514451 0.56854737]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-functions-in-$\mathbb{R}^2$">Linear functions in $\mathbb{R}^2$<a class="anchor-link" href="#Linear-functions-in-$\mathbb{R}^2$">&#182;</a></h2><p>Consider the function 
  \begin{equation*}
  f(x_1,x_2)=w_0 + w_1x_1 + w_2x_2
  \end{equation*}</p>
<p>What is the set of points $x_1,x_2$ where the function becomes 0?
  For $ w_2\neq 0 $
  \begin{equation*}
  \begin{matrix}
   0=f(x_1,x_2)=w_0 + w_1x_1 + w_2x_2 &amp; \implies &amp; x_2=-\frac{1}{w_2}\left(w_0 + w_1x_1\right)\\
   \end{matrix}
   \end{equation*}</p>
<p>Let's generate a few random values for $w_i$ and plot the results.  Without loss of generality $-1\leq w_i\leq 1$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>

<span class="n">f3</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">();</span>
<span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="s2">&quot;brown&quot;</span><span class="p">,</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">x2</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Drawing Random Lines on a Plane&quot;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[ 0.76452516 -0.26482083 -0.2367013 ]
[0.31825275 0.39374472 0.73847403]
[-0.63540484 -0.37342094  0.27154717]
[-0.50068398 -0.9481619   0.08255818]
[-0.64448417  0.83016368  0.86549156]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_26_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, interpreted this way, any set of 3 weights $(w_0,w_1,w_2)$ defines a line in the plane. Indeed since we can always normalize by $w_2$, any two weights define a line on the plane.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-points-in--$\mathbb{R}^2$">Random points in  $\mathbb{R}^2$<a class="anchor-link" href="#Random-points-in--$\mathbb{R}^2$">&#182;</a></h2><p>Let us now generate a list of $N$ random points in the plane, $(x_1,x_2)\in [-5,5]^2$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">20</span>
<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">-</span><span class="mi">5</span>
<span class="c1">#print(data)</span>
<span class="n">f4</span><span class="p">,</span><span class="n">ax4</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k+&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Random Points in $\mathbb</span><span class="si">{R}</span><span class="s2">^2$&quot;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_29_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Synthetic-Linearly-Separable-Data">Synthetic Linearly-Separable Data<a class="anchor-link" href="#Synthetic-Linearly-Separable-Data">&#182;</a></h2><p>Let us now generate a synthetic data set in  $\mathbb{R}^2$  following these steps:</p>
<p>1-Randomly generate a line (i.e., generate $w_0,w_1,w_2$)</p>
<p>2-Randomly generate $N$ data points as above</p>
<p>3-For each point $(x_2,x_1)$, calculate 
\begin{equation*}
f(x_1,x_2)= w_0+w_1x_1+w_2x_2
\end{equation*}
If $f(x_1,x_2)&gt;0$, label the point $+1$, otherwise label $-1$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">200</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">datax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">-</span><span class="mi">5</span>
<span class="c1">#print(w)</span>
<span class="c1">#print(datax)</span>

<span class="n">z</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">datax</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">datay</span><span class="o">=</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">datax</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">datax</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="c1">#print(datay)</span>
<span class="n">f5</span><span class="p">,</span> <span class="n">ax5</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datax</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">z</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Linearly Separable Points in  $\mathbb</span><span class="si">{R}</span><span class="s2">^2$&quot;</span><span class="p">);</span>
<span class="n">ax5</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">,</span><span class="o">-</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[-5.5, 5.5, -5.5, 5.5]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_31_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Files">Files<a class="anchor-link" href="#Files">&#182;</a></h2><h3 id="Save-the-data">Save the data<a class="anchor-link" href="#Save-the-data">&#182;</a></h3><p>Write the data in a simple csv format, using savetxt.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data2d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">data2d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">datax</span>
<span class="n">data2d</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">datay</span>
<span class="n">filename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Synthetic</span><span class="se">\\</span><span class="s2">Assig1data.txt&quot;</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data2d</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-the-data">Load the data<a class="anchor-link" href="#Load-the-data">&#182;</a></h3><p>Given the data stored in the file as csv (in the simple format: x1,x2,y), let us load it using loadtxt</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Synthetic</span><span class="se">\\</span><span class="s2">Assig1data.txt&quot;</span>
<span class="n">ddd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ddd</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ddd</span><span class="p">[:</span><span class="mi">10</span><span class="p">,:])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 3)
[[-0.48606028  2.61108304 -1.        ]
 [ 3.33751572 -4.31506895  1.        ]
 [ 4.08571543  3.67526521 -1.        ]
 [-3.14184104  1.86861585 -1.        ]
 [ 4.25815011 -3.84091065  1.        ]
 [ 4.95574765 -4.1083209   1.        ]
 [-2.99713837 -2.12738238  1.        ]
 [-1.62058093  4.14585521 -1.        ]
 [ 4.869891    3.67927395 -1.        ]
 [ 1.44277036  0.16665854 -1.        ]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plotting-in-3D">Plotting in 3D<a class="anchor-link" href="#Plotting-in-3D">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">mplot3d</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3D-Plots-and--Linear-functions-in-$\mathbb{R}^3$">3D Plots and  Linear functions in $\mathbb{R}^3$<a class="anchor-link" href="#3D-Plots-and--Linear-functions-in-$\mathbb{R}^3$">&#182;</a></h3><p>Consider 
  \begin{equation*}
  f(x_1,x_2,x_3)=w_0 + w_1x_1 + w_2x_2 +w_3x_3
  \end{equation*}
  Let's generate a few random values for $w_i$ and plot the results.  Wlog $-1\leq w_i\leq 1$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Z</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;A Separating Plane&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_39_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">angle</span><span class="o">=</span><span class="mi">90</span>
<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>




<div class="output_png output_subarea output_execute_result">
<img src="output_40_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, and set of 4 weights $(w_0,w_1,w_2,w_3)$ defines a plane in 3-D. In fact three weights are enough (the fourth one can be normalized away).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-points-in--$\mathbb{R}^3$">Random points in  $\mathbb{R}^3$<a class="anchor-link" href="#Random-points-in--$\mathbb{R}^3$">&#182;</a></h2><p>Let us now generate a list of $N$ random points, $(x_1,x_2,x_3)\in [-5,5]^3$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">40</span>
<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">-</span><span class="mi">5</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;k+&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&lt;mpl_toolkits.mplot3d.art3d.Line3D at 0x24ec54eee48&gt;]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_43_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Synthetic-Data-in-$\mathbb{R}^3$">Synthetic Data in $\mathbb{R}^3$<a class="anchor-link" href="#Synthetic-Data-in-$\mathbb{R}^3$">&#182;</a></h3><p>Let us now generate a synthetic data set in  $\mathbb{R}^3$  following these steps:
1-Randomly generate a plane (i.e., generate $w_0,w_1,w_2, w_3$)</p>
<p>2-Randomly generate $N$ data points as above</p>
<p>3-For each point $(x_1,x_2,x_3)$, calculate 
\begin{equation*}
f(x_1,x_2,x_3)= w_0+w_1x_1+w_2x_2+w_3x_3
\end{equation*}
If $f(x_1,x_2,x_3)&gt;0$, label the point $+1$, otherwise label $-1$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">100</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">datax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">-</span><span class="mi">5</span>
<span class="n">datay</span><span class="o">=</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">datax</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">datax</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">datax</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="c1">#plt.figure()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Y</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">datax</span><span class="p">[</span><span class="n">datay</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[20]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;mpl_toolkits.mplot3d.art3d.Poly3DCollection at 0x24ec668bb88&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_45_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Linear-classification-using--a-synthetic-data-set">Linear classification using  a synthetic data set<a class="anchor-link" href="#Linear-classification-using--a-synthetic-data-set">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Given the input $x=(x_1, x_2, \ldots , x_n)\in \mathbb{R}^n$  and </li>
<li>the output $y \in \left\{-1, +1\right\}$, </li>
<li>the goal is to find a function $g : \mathbb{R}^n \rightarrow \left\{-1, +1\right\}$, so that $g(x)$ <em>predicts</em> y correctly most of the time.<br></li>
</ul>
<p>One approach would be to take a weighted sum of the coordinates $x_1, x_2, \ldots, x_n$, and to check if the average is above a certain threshold $\theta$.  If it is above the threshold, it predicts the label +1, otherwise it predicts the label -1. <br> 
i.e.,</p>
\begin{equation*}
g(x) = \left\{
    \begin{matrix}
     -1 &amp; \text{if}\quad w_1x_1+w_2x_2+\ldots +w_nx_n &lt; \theta \\
     +1 &amp; \text{if}\quad w_1x_1+w_2x_2+\ldots +w_nx_n \geq \theta \\
    \end{matrix}
    \right.
\end{equation*}<p>This is called a <strong>linear classifier</strong>.</p>
<p>Lets do a bit of notation change by letting $w_0=-\theta$ <br>
Then 
\begin{equation*}
w_1x_1+w_2x_2+\ldots +w_nx_n &lt; \theta
\end{equation*}
becomes 
\begin{equation*}
w_0 + w_1x_1+w_2x_2+\ldots +w_nx_n &lt; 0
\end{equation*}</p>
<p>and $g(x)$ can be rewritten as</p>
\begin{equation*}
g(x)=\text{sign}\left(w_0 + w_1x_1+w_2x_2+\ldots +w_nx_n\right)
\end{equation*}<p><strong>Vector Notation</strong></p>
<ul>
<li><em>Augment</em> the input $x$, so that it has a <em>zero-th</em> coordinate $x_0$ which is always set to 1. <br>
i.e., $x=\left(x_0, x_1, x_2, \ldots , x_n\right)$, where $x_0=1$. <br></li>
<li>Let $w=\left(w_0,w_1,\ldots, w_n\right) $, then <br>
\begin{equation*}
g(x)=\text{sign}\left(x\cdot w\right)
\end{equation*}</li>
</ul>
<p><strong>Task of learning for linear classifiers</strong> : <em>Find $w$ so that $g$ is a good predictor of y given different inputs x</em>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">mplot3d</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong>Loading and plotting the data</strong> <br></p>
<ol>
<li>Given the data stored in the file as csv (in the simple format: $x_1,x_2,y$), let us load it using <code>loadtxt</code></li>
<li>Plot the data, making sure to label the axes and label the points appropriately (using different color/symbols for point +1 and -1).</li>
</ol>
<p>The data is in this format <br>
<code>x1           x2             y
 2.5055315,   3.1243139,     1
-3.8724829,  -4.55520539,   -1
-1.41786264, -3.9505169,    -1
-4.77589568,  3.61261014,    1
 0.54364724, -3.27139691,   -1
 ...</code></p>
<p>$N$ data points, loaded in the $N\times3$ array $D$</p>
<ul>
<li>vector $x_1$ will contain the values of the first coordinate of the data points</li>
<li>vector $x_2$ will contain the values of the second coordinate of the data points </li>
<li>vector $y$ will contain the labels for each of the data points</li>
</ul>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#1</span>
<span class="n">filename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Synthetic</span><span class="se">\\</span><span class="s2">data1.txt&quot;</span>
<span class="n">D</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> 
<span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">dim</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1">#2</span>
<span class="n">x1</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x2</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>100
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[22]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[-5.1, 5.1, -5.1, 5.1]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_51_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Classification-Error">Classification Error<a class="anchor-link" href="#Classification-Error">&#182;</a></h2><p>Given a linear classifier (i.e., given the weights that define the line), calculate the classification error.<br></p>
<ol>
<li>First, lets generate a random classifier for the data above (i.e, generate $w=(w_0,w_1,w_2)$)</li>
<li>Plot the classifier</li>
<li>Calculate the classification error </li>
</ol>
<p>To calculate the error, for each point $(x_1,x_2,y)$ :</p>
<blockquote><ul>
<li>Calculate  </li>
</ul>
</blockquote>
\begin{equation*}
h(x_1,x_2)=\text{sign}(w_0+w_1x_1+w_2x_2)
\end{equation*}<blockquote><ul>
<li>\begin{equation*}
error = \left\{
  \begin{matrix}
   1 &amp; \text{if}\quad h(x_1,x_2)\neq y \\
   0 &amp; \text{otherwise} \\
  \end{matrix}
  \right.
\end{equation*}</li>
</ul>
</blockquote>
<p><br> Sum over all the points and divide by $N$ to get the error</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#1 generating a random classifier</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>

<span class="c1">#plotting the points</span>
<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>

<span class="c1">#2 plotting the classifier</span>
<span class="n">z</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="c1">#3 calculating the error</span>
<span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span>
<span class="n">ey</span><span class="o">=</span><span class="p">(</span><span class="n">h</span><span class="o">!=</span><span class="n">y</span><span class="p">)</span>
<span class="n">error</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">ey</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Error:  35.0 %
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_53_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-Classifiers">Random Classifiers<a class="anchor-link" href="#Random-Classifiers">&#182;</a></h2><p>Given a performance bound (say error smaller than $\epsilon$), how many tries would it take to achieve said performance by generating random linear classifiers?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">epsilon</span><span class="o">=</span><span class="mi">10</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="n">error</span><span class="o">=</span><span class="mi">100</span>
<span class="k">while</span> <span class="p">(</span><span class="n">error</span><span class="o">&gt;</span><span class="n">epsilon</span><span class="p">):</span>
    <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span>
    <span class="n">ey</span><span class="o">=</span><span class="p">(</span><span class="n">h</span><span class="o">!=</span><span class="n">y</span><span class="p">)</span>
    <span class="n">error</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">ey</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
    <span class="c1">#print (i, &quot;Error: &quot;, error, &quot;%&quot; )</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Try #&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Error: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Classifier Weights :&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Try # 2 	Error:  5.0 %
Best Classifier Weights : [ 0.54802495 -0.15926753 -0.72048377]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plot-the-best-random-classifier">Plot the best random classifier<a class="anchor-link" href="#Plot-the-best-random-classifier">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">();</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>

<span class="n">z</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[-5.1, 5.1, -5.1, 5.1]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_57_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-matrix-notation">Using matrix notation<a class="anchor-link" href="#Using-matrix-notation">&#182;</a></h2><p>Let's try do do the same thing using matrix notation.</p>
<blockquote><p>The data is given by $D$, an $N \times 3$ array. <br>
The first $2$ columns is the input and the last column is the output. <br> 
Let's create an $N\times 3$ array $X$ for the input (the first column is all ones).</p>
<p>$X$ will look like  <br>
<code>1       x1            x2        
 1       2.5055315     3.1243139 
 1      -3.8724829    -4.55520539
 1      -1.41786264   -3.9505169 
 1      -4.77589568    3.61261014
 1       0.54364724   -3.27139691
 ...</code></p>
</blockquote>
<p>i.e, 
\begin{equation*}
X=
 \begin{bmatrix}
 1   &amp;    2.5055315  &amp;   3.1243139 \\
 1   &amp;  -3.8724829   &amp; -4.55520539 \\
 1   &amp;  -1.41786264  &amp; -3.9505169 \\
 1   &amp;  -4.77589568  &amp;  3.61261014 \\
 1   &amp;   0.54364724  &amp; -3.27139691 \\
 \vdots &amp; \vdots &amp; \vdots \\
\end{bmatrix}
\end{equation*}</p>
<blockquote><p>Then calculating $(_1,_2)=\text{sign}\left(_0+_1_1+_2_2\right)$ for all the points can be done in one shot by calculating the dot product of $X$ and $w$, so 
 \begin{equation*}
 h(x)=\text{sign}\left(Xw\right)
 \end{equation*}</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">epsilon</span><span class="o">=</span><span class="mi">10</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="n">error</span><span class="o">=</span><span class="mi">100</span>
<span class="k">while</span> <span class="p">(</span><span class="n">error</span><span class="o">&gt;</span><span class="n">epsilon</span><span class="p">):</span>
    <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">X</span> <span class="o">@</span> <span class="n">w</span><span class="p">)</span>
    <span class="n">ey</span><span class="o">=</span><span class="p">(</span><span class="n">h</span><span class="o">!=</span><span class="n">y</span><span class="p">)</span>
    <span class="n">error</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">ey</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
    <span class="c1">#print (i, &quot;Error: &quot;, error, &quot;%&quot; )</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Try #&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Error: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Classifier Weights :&quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Try # 4 	Error:  1.0 %
Best Classifier Weights : [ 0.41437938 -0.1022863  -0.27595974]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">();</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>

<span class="n">z</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[28]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[-5.1, 5.1, -5.1, 5.1]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_61_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Perceptron-Learning-Algorithm-(PLA)">Perceptron Learning Algorithm (PLA)<a class="anchor-link" href="#Perceptron-Learning-Algorithm-(PLA)">&#182;</a></h2><blockquote><p>Construct $X$  <br>
<code>1       x1            x2        
 1       2.5055315     3.1243139 
 1      -3.8724829    -4.55520539
 1      -1.41786264   -3.9505169 
 1      -4.77589568    3.61261014
 1       0.54364724   -3.27139691
 ...</code></p>
<p>$y$ is the vector will all the point labels stacked.</p>
<p>Get the classifier weights using the following algorithm: <br></p>
<ol>
<li>Start with a random w</li>
<li>classify points using the weights w (i.e, $\;\;h=sign(X \cdot w)$</li>
<li>Pick a misclassified point (i.e, pick $k$ such that $h[k]\neq y[k]$.  Lets call this point $(\tilde{x}, \tilde{y})$</li>
<li>Update weights  $w\leftarrow w+\tilde{y}\cdot \tilde{x}$</li>
<li>Repeat 2-4 until no misclassified points.</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">PLA</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Given data, use PLA to find the separating hyper plane&quot;&quot;&quot;</span> 
    <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>
    <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">d</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Y</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span> <span class="c1">#randomly initialize the weights</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">X</span> <span class="o">@</span> <span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">ey</span><span class="o">=</span><span class="p">(</span><span class="n">h</span><span class="o">!=</span><span class="n">Y</span><span class="p">)</span>  <span class="c1">#missmatched points</span>
        <span class="n">trainerr</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">ey</span><span class="p">);</span>  <span class="c1">#number of missmatched</span>
        <span class="k">if</span> <span class="n">trainerr</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="c1">#pick a random missmatched</span>
        <span class="k">if</span> <span class="n">trainerr</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">k</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">trainerr</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
        <span class="n">xx</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">ey</span><span class="p">,:])[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">yy</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">ey</span><span class="p">])[</span><span class="n">k</span><span class="p">]</span>
        <span class="c1">#update weights</span>
        <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">+</span><span class="n">yy</span><span class="o">*</span><span class="n">xx</span><span class="p">;</span>
        <span class="c1">#print(&quot;Epoch: &quot;, i, &quot;Error :&quot;, trainerr/N*100, &quot;%&quot;)</span>
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Epoch: &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Error: &quot;</span><span class="p">,</span> <span class="n">trainerr</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">w_pla</span><span class="o">=</span><span class="n">PLA</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="n">x1</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x2</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>

<span class="n">z</span><span class="o">=-</span><span class="p">(</span><span class="n">w_pla</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w_pla</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">w_pla</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PLA Classifier Weights&#39;</span><span class="p">,</span> <span class="n">w_pla</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch:  30 Error:  0.0 %
PLA Classifier Weights [12.40362721 -2.88260558 -7.11091006]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_64_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">PLA_Illustration</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Given data, use PLA to find the separating hyper plane&quot;&quot;&quot;</span> 
    <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">x1</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">x2</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">steps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mm</span><span class="o">=</span><span class="mi">10</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mm</span><span class="o">=</span><span class="n">steps</span>
    <span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">mm</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
 

    
    <span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Y</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span> <span class="c1">#randomly initialize the weights</span>
    


    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">mm</span><span class="p">):</span>
            <span class="k">break</span><span class="p">;</span>
 
        
        <span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">X</span> <span class="o">@</span> <span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">ey</span><span class="o">=</span><span class="p">(</span><span class="n">h</span><span class="o">!=</span><span class="n">Y</span><span class="p">)</span>  <span class="c1">#missmatched points</span>
        <span class="n">trainerr</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">ey</span><span class="p">);</span>  <span class="c1">#number of missmatched</span>
        <span class="k">if</span> <span class="n">trainerr</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="c1">#pick a random missmatched</span>
        <span class="k">if</span> <span class="n">trainerr</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">k</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">k</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">trainerr</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
        <span class="n">xx</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">ey</span><span class="p">,:])[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">yy</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">ey</span><span class="p">])[</span><span class="n">k</span><span class="p">]</span>
        <span class="c1">#update weights</span>
        <span class="n">z</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>   
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xx</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;y*&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Error = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">trainerr</span><span class="p">)))</span>
        <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">+</span><span class="n">yy</span><span class="o">*</span><span class="n">xx</span><span class="p">;</span>
        <span class="c1">#print(&quot;Epoch: &quot;, i, &quot;Error :&quot;, trainerr/N*100, &quot;%&quot;)</span>
        
        <span class="n">z</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">xx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xx</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Epoch: &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Error: &quot;</span><span class="p">,</span> <span class="n">trainerr</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">w_pla</span><span class="o">=</span><span class="n">PLA_Illustration</span><span class="p">(</span><span class="n">D</span><span class="p">[:</span><span class="mi">25</span><span class="p">,:],</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch:  10 Error:  24.0 %
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_66_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression-Classifier">Linear Regression Classifier<a class="anchor-link" href="#Linear-Regression-Classifier">&#182;</a></h2><blockquote><p>Construct $X$  <br>
<code>1       x1            x2        
 1       2.5055315     3.1243139 
 1      -3.8724829    -4.55520539
 1      -1.41786264   -3.9505169 
 1      -4.77589568    3.61261014
 1       0.54364724   -3.27139691
 ...</code></p>
</blockquote>
<p>i.e, 
\begin{equation*}
X=
 \begin{bmatrix}
 1   &amp;    2.5055315  &amp;   3.1243139 \\
 1   &amp;  -3.8724829   &amp; -4.55520539 \\
 1   &amp;  -1.41786264  &amp; -3.9505169 \\
 1   &amp;  -4.77589568  &amp;  3.61261014 \\
 1   &amp;   0.54364724  &amp; -3.27139691 \\
 \vdots &amp; \vdots &amp; \vdots \\
\end{bmatrix}
\end{equation*}</p>
<blockquote><p>$y$ is the vector will all the point labels stacked.</p>
</blockquote>
\begin{equation*}
y=
 \begin{bmatrix}
 +1\\
 +1\\
 -1\\
 +1 \\
 -1 \\
 \vdots \\
\end{bmatrix}
\end{equation*}<p>Question: Are there linear combinations of the data that predict the output? <br></p>
<blockquote><p>i.e., are there weights $w_0, w_1, w_2$, such that $y= w_0+ w_1x_1+w_2x_2$ for all the points?
Basically what we want is</p>
</blockquote>
\begin{equation*}
 \begin{matrix}
 w_0 &amp; + &amp; 2.50553150 \cdot w_1 &amp; + &amp;  3.12431390 \cdot w_2 &amp; = &amp; +1 \\
 w_0 &amp; + &amp; -3.87248290 \cdot w_1 &amp; + &amp;  -4.55520539 \cdot w_2 &amp; = &amp; +1 \\
 w_0 &amp; + &amp; -1.41786264 \cdot w_1 &amp; + &amp;  -3.95051690 \cdot w_2 &amp; = &amp; -1 \\
 w_0 &amp; + &amp; -4.77589568 \cdot w_1 &amp; + &amp;  3.61261014 \cdot w_2 &amp; = &amp; +1 \\
 w_0 &amp; + &amp;  0.54364724 \cdot w_1 &amp; + &amp;  -3.27139691 \cdot w_2 &amp; = &amp; -1 \\
&amp;&amp;&amp;\vdots&amp;&amp;&amp;\\
\end{matrix}
\end{equation*}<p>In matrix notation this would be</p>
\begin{equation*}
 \begin{bmatrix}
1 &amp; 2.50553150  &amp; 3.12431390 \\
1 &amp; -3.87248290  &amp; -4.55520539 \\
1 &amp; -1.41786264 &amp; -3.95051690 \\
1 &amp;  -4.77589568 &amp;  3.61261014  \\
1 &amp;   0.54364724 &amp;  -3.2713969  \\
\vdots  &amp; \vdots  &amp; \vdots  \\
\end{bmatrix}
\begin{bmatrix}
w_0 \\
w_1 \\
w_2 \\
\end{bmatrix} =
\begin{bmatrix}
+1 \\
+1 \\
-1 \\
+1 \\
-1 \\
\vdots\\
\end{bmatrix}
\end{equation*}<p>or 
\begin{equation*}
\begin{matrix}
X &amp; w &amp;= &amp;y\\
\end{matrix}
\end{equation*}</p>
<p>Such equation generally will not have a solution, since $X$ is a <em>tall</em> matrix (i.e., a lot more rows than columns).  The best one can do is pick <em>approximate</em> solutions.  One such solution would be the one that maximizes the mean squared error. This is the <strong>linear regression</strong> solution found using the formula</p>
\begin{equation*}
w=(X^TX)^{-1}X^Ty
\end{equation*}<blockquote><p>Alternatively get $w$ by getting the least square solution of matrix equation $Xw=y$ by calling the numpy.linalg.lstsq function.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>
<span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">d</span><span class="p">]</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">w_lr</span><span class="o">=</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#w_lr=(np.linalg.inv(X.T @ X) @ X.T) @ Y</span>

<span class="n">xp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">z</span><span class="o">=-</span><span class="p">(</span><span class="n">w_lr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w_lr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">xp</span><span class="p">)</span><span class="o">/</span><span class="n">w_lr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">x1</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x2</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span><span class="o">=</span><span class="n">D</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">,</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Linear Regression Classifier Weights&#39;</span><span class="p">,</span> <span class="n">w_lr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Linear Regression Classifier Weights [ 0.2564037  -0.1033169  -0.25637788]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_68_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">yg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">Xg</span><span class="p">,</span> <span class="n">Yg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">)</span>
<span class="n">Zg</span> <span class="o">=</span><span class="n">w_lr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w_lr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Xg</span><span class="o">+</span><span class="n">w_lr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Yg</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">angle</span><span class="o">=</span><span class="mi">30</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r+&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xlim3d</span><span class="p">(</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">)</span> 
<span class="n">ax3</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_ylim3d</span><span class="p">(</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">)</span> 
<span class="n">ax3</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[34]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(-1.1, 1.1)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_69_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax3</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">Xg</span><span class="p">,</span><span class="n">Yg</span><span class="p">,</span><span class="n">Zg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[35]:</div>




<div class="output_png output_subarea output_execute_result">
<img src="output_70_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax3</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">Xg</span><span class="p">,</span><span class="n">Yg</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">Zg</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[36]:</div>




<div class="output_png output_subarea output_execute_result">
<img src="output_71_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">yg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">Xg</span><span class="p">,</span> <span class="n">Yg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xg</span><span class="p">,</span> <span class="n">yg</span><span class="p">)</span>
<span class="n">Zg</span> <span class="o">=</span><span class="n">w_lr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w_lr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Xg</span><span class="o">+</span><span class="n">w_lr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Yg</span>
<span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">angle</span><span class="o">=-</span><span class="mi">90</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">Xg</span><span class="p">,</span><span class="n">Yg</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">Zg</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r+&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">ax4</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xlim3d</span><span class="p">(</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">)</span> 
<span class="n">ax4</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_ylim3d</span><span class="p">(</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">)</span> 
<span class="n">ax4</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[37]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(-1.1, 1.1)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_72_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Nonlinear-Transformations-and-Linear-Regression">Nonlinear Transformations and Linear Regression<a class="anchor-link" href="#Nonlinear-Transformations-and-Linear-Regression">&#182;</a></h2><p>Let's start by looking some inputs in $\mathbb{R}$, i.e., one dimensional data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">20</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span> 
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x:&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y:&quot;</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>x: [ 0.31214534 -1.7093768   1.62754419 -1.46337879 -0.40346423 -0.64963181
 -1.51318127  0.93178826  0.80410413 -0.27391176  1.47123263  0.93064205
  0.88068306 -0.32436841 -0.9086372   0.95745888  1.62175919 -1.31150558
  1.56817544  0.79119607]
y: [ 0.12750051 -0.87663124  0.6263926  -0.83729408  0.09695357  0.1473247
 -0.92270532  0.99434072  0.91938096  0.05444975 -0.80408773  0.99487128
  0.99371962  0.07102663  0.07535959  0.97509218  0.57476019 -0.5105327
  0.03239983  0.90065434]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[38]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;$y$&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_74_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Given the data points above, fit the best line to the data :  <strong>Linear Regression</strong><br>
What we are doing is that best function of the form 
\begin{equation*}
h(x)=w_0+w_1x 
\end{equation*}
that fits the data</p>
<ul>
<li>Form the matrix X<br>
\begin{equation*}
X= 
\begin{bmatrix}
1 &amp; -0.97475132 \\
1 &amp; -0.51516923 \\
1 &amp;  1.12807075 \\
\vdots &amp; \vdots \\
\end{bmatrix}
\end{equation*}</li>
<li><p>Reminder that  y
\begin{equation*}
y= 
\begin{bmatrix}
0.02398749 \\
0.12831898 \\
0.42007667 \\
\vdots \\
\end{bmatrix}
\end{equation*}</p>
</li>
<li><p>Solve for $w$
\begin{equation*}
Xw=y
\end{equation*}</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="p">;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">w</span><span class="o">=</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="c1">#xr=np.linspace(-2,2,100)</span>
<span class="c1">#yr= w[0]+xr*w[1]</span>

<span class="n">yreg</span><span class="o">=</span><span class="n">X</span> <span class="o">@</span> <span class="n">w</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">yreg</span><span class="p">,</span><span class="s1">&#39;r*&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[ 1.          0.31214534]
 [ 1.         -1.7093768 ]
 [ 1.          1.62754419]
 [ 1.         -1.46337879]
 [ 1.         -0.40346423]
 [ 1.         -0.64963181]
 [ 1.         -1.51318127]
 [ 1.          0.93178826]
 [ 1.          0.80410413]
 [ 1.         -0.27391176]
 [ 1.          1.47123263]
 [ 1.          0.93064205]
 [ 1.          0.88068306]
 [ 1.         -0.32436841]
 [ 1.         -0.9086372 ]
 [ 1.          0.95745888]
 [ 1.          1.62175919]
 [ 1.         -1.31150558]
 [ 1.          1.56817544]
 [ 1.          0.79119607]]
[0.11491931 0.39966453]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[39]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;$y$&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_76_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What if we wanted to fit the best quadratic function?
Than we need to find the best function of the form 
\begin{equation*}
h(x)=w_0+w_1x+w_2x^2 
\end{equation*}
that fits the data. <br>
I.e., we approximate $y$ by:</p>
<p>Find $w_0, w_1, w_2$ so that 
\begin{equation*}
\begin{matrix}
w_0 &amp;+&amp; 0.97475132\cdot w_1&amp;+&amp; (0.97475132)^2 \cdot w_2 &amp; = &amp; 0.02398749 \\
w_0 &amp;+&amp; 0.51516923\cdot w_1&amp;+&amp; (0.51516923)^2 \cdot w_2 &amp; = &amp; 0.12831898 \\
w_0 &amp;+&amp; 1.12807075\cdot w_1&amp;+&amp; (1.12807075)^2 \cdot w_2 &amp; = &amp; 0.42007667 \\
&amp;&amp;\vdots &amp; &amp;&amp;\vdots &amp; \vdots \\
\end{matrix}
\end{equation*}</p>
<p>In matrix notation this would be</p>
\begin{equation*}
 \begin{bmatrix}
1 &amp; 0.97475132  &amp; (0.97475132)^2 \\
1 &amp; 0.51516923 &amp; (0.51516923)^2 \\
1 &amp; 1.12807075 &amp; (1.12807075)^2 \\
\vdots  &amp; \vdots  &amp; \vdots  \\
\end{bmatrix}
\begin{bmatrix}
w_0 \\
w_1 \\
w_2 \\
\end{bmatrix} =
\begin{bmatrix}
 0.02398749 \\
0.12831898  \\
0.42007667\\
\vdots\\
\end{bmatrix}
\end{equation*}<p>or 
\begin{equation*}
Zw=y
\end{equation*}</p>
<p>where
\begin{equation*}
 Z=\begin{bmatrix}
1 &amp; 0.97475132  &amp; (0.97475132)^2 \\
1 &amp; 0.51516923 &amp; (0.51516923)^2 \\
1 &amp; 1.12807075 &amp; (1.12807075)^2 \\
\vdots  &amp; \vdots  &amp; \vdots  \\
\end{bmatrix} = \begin{bmatrix}1 &amp; x &amp; x^2 \\ \end{bmatrix} 
\end{equation*}</p>
<p>So all we have to do is solve $Zw=y$ for $w$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">Z</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="p">;</span>
<span class="n">Z</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="n">sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">w</span><span class="o">=</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="c1">#xr=np.linspace(-2,2,100)</span>
<span class="c1">#yr= w[0]+xr*w[1]</span>

<span class="n">yreg</span><span class="o">=</span><span class="n">Z</span> <span class="o">@</span> <span class="n">w</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">yreg</span><span class="p">,</span><span class="s1">&#39;r*&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[ 1.          0.31214534  0.09743472]
 [ 1.         -1.7093768   2.92196904]
 [ 1.          1.62754419  2.6489001 ]
 [ 1.         -1.46337879  2.14147747]
 [ 1.         -0.40346423  0.16278339]
 [ 1.         -0.64963181  0.42202149]
 [ 1.         -1.51318127  2.28971754]
 [ 1.          0.93178826  0.86822936]
 [ 1.          0.80410413  0.64658345]
 [ 1.         -0.27391176  0.07502765]
 [ 1.          1.47123263  2.16452545]
 [ 1.          0.93064205  0.86609463]
 [ 1.          0.88068306  0.77560265]
 [ 1.         -0.32436841  0.10521487]
 [ 1.         -0.9086372   0.82562156]
 [ 1.          0.95745888  0.91672751]
 [ 1.          1.62175919  2.63010287]
 [ 1.         -1.31150558  1.72004688]
 [ 1.          1.56817544  2.45917421]
 [ 1.          0.79119607  0.62599122]]
[ 0.52356381  0.40761924 -0.32328089]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[40]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;$y$&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_78_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>What about higher order polynomials?</strong>
<br>
Use the same procedure:</p>
<ul>
<li><p>Construct  Z
\begin{equation*}
Z=\begin{bmatrix}1 &amp; x &amp; x^2 &amp;\cdots&amp; x^d \\ \end{bmatrix} 
\end{equation*}</p>
</li>
<li><p>Solve 
\begin{equation*}
Zw=y
\end{equation*}
for $w$.</p>
</li>
</ul>
<p>Let's try it below for d=7</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="o">=</span><span class="mi">7</span>
<span class="n">Z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="n">k</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">Z</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="o">**</span><span class="n">k</span><span class="p">;</span>

<span class="c1">#print(Z)</span>
<span class="n">sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">w</span><span class="o">=</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="n">yreg</span><span class="o">=</span><span class="n">Z</span> <span class="o">@</span> <span class="n">w</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">yreg</span><span class="p">,</span><span class="s1">&#39;r*&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>


<span class="n">xr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">yr</span><span class="o">=</span><span class="n">xr</span><span class="o">*</span><span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">yr</span><span class="o">=</span> <span class="n">yr</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">xr</span><span class="o">**</span><span class="n">i</span><span class="p">)</span>
    
<span class="n">ytarget</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xr</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="n">xr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span><span class="n">yr</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span><span class="n">ytarget</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">2.1</span><span class="p">,</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;data points&#39;</span><span class="p">,</span> <span class="s1">&#39;point approximations&#39;</span><span class="p">,</span> <span class="s1">&#39;approximating function&#39;</span><span class="p">,</span> <span class="s1">&#39;target function&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[-0.17866666  0.02859161  2.91481409  1.6236146  -3.15145191 -1.62336441
  0.77857866  0.4055312 ]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[41]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x24ec6c3b288&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_80_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Nonlinear-Transformation-for-the-Polynomial-Fitting">Nonlinear Transformation for the Polynomial Fitting<a class="anchor-link" href="#Nonlinear-Transformation-for-the-Polynomial-Fitting">&#182;</a></h3><p>Let's switch a bit of perspective.<br>
Let's create a transformation that takes $x$ and maps it to $[1,x,x^2,\cdots, x^d]$,
\begin{equation*}
 z=T(x)=\begin{bmatrix}1 &amp; x &amp; x^2 &amp;\cdots&amp; x^d \\ \end{bmatrix} 
\end{equation*}
i.e. the new point $z$ has coordinates
\begin{equation*}
 \begin{bmatrix} z_0=1\; \\ z_1=x\; \\ z_2=x^2\\ \vdots \\ z_d=x^d \\ \end{bmatrix} 
\end{equation*}</p>
<p>And the approximating linear function in this new space is the best function of the form 
\begin{equation*}
   h(z)=w_0z_0+w_1z_1+\cdots +w_dz_d
\end{equation*}</p>
<ul>
<li>Then form $Z$ by stacking the coordinates of each transformed point 
\begin{equation*}
Z=\begin{bmatrix}z_0 &amp; z_1 &amp; z_2 &amp;\cdots&amp; z_d \\ \end{bmatrix} 
\end{equation*}</li>
<li>Solve for $w$
\begin{equation*}
 Zw=y
\end{equation*}</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="General-Nonlinear-Transformation">General Nonlinear Transformation<a class="anchor-link" href="#General-Nonlinear-Transformation">&#182;</a></h3><p>Given the original point $x\in\mathbb{R}^n$, (i.e., $n$ real coordinates)
\begin{equation*}
x=\left[x_0,x_1,\ldots,x_n \right]
\end{equation*}
we can use a transformation 
\begin{equation*}
\begin{matrix}
T&amp;:&amp;\mathbb{R}^n &amp; \rightarrow &amp; \mathbb{R}^d\\
\end{matrix}
\end{equation*}
to transform to a point $z\in \mathbb{R}^d$ (i.e., $d$ real coordinates),</p>
\begin{equation*}
z=T(x)=\left[z_0,z_1,\ldots,z_n \right]
\end{equation*}<p><strong>We now work with the transform data points</strong> <br>
I.e.,</p>
<ul>
<li>Find the best linear function<br>
\begin{equation*}
 h(z)=w_0z_0+w_1z_1+\cdots +w_dz_d
\end{equation*}
by solving  for $w$
\begin{equation*}
 Zw=y
\end{equation*}
where $Z$ is formed stacking the coordinates of each transformed point 
\begin{equation*}
Z=\begin{bmatrix}z_0 &amp; z_1 &amp; z_2 &amp;\cdots&amp; z_d \\ \end{bmatrix} 
\end{equation*}</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introducing-Some-Datasets">Introducing Some Datasets<a class="anchor-link" href="#Introducing-Some-Datasets">&#182;</a></h1><blockquote><p>We are going to look at a few dataset that we are going to use as example throughout the course (to test different ideas, algorithms etc.)</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Scikit-learn-Datasets">Scikit-learn Datasets<a class="anchor-link" href="#Scikit-learn-Datasets">&#182;</a></h2><p>Available through scikit-learn (<em>sklearn</em>) <em>datasets</em> module
(<a href="https://scikit-learn.org/stable/datasets">https://scikit-learn.org/stable/datasets</a>)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Iris-Dataset">Iris Dataset<a class="anchor-link" href="#Iris-Dataset">&#182;</a></h3><blockquote><p>Classification dataset</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iris</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="n">Y_iris</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">target</span>
<span class="n">X_iris</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_iris</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Names :&quot;</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 5 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_iris</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categories : &quot;</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All the labels :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_iris</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (150, 4) 

Feature Names : [&#39;sepal length (cm)&#39;, &#39;sepal width (cm)&#39;, &#39;petal length (cm)&#39;, &#39;petal width (cm)&#39;]
The first 5 data entries : 
[[5.1 3.5 1.4 0.2]
 [4.9 3.  1.4 0.2]
 [4.7 3.2 1.3 0.2]
 [4.6 3.1 1.5 0.2]
 [5.  3.6 1.4 0.2]]
Categories :  [&#39;setosa&#39; &#39;versicolor&#39; &#39;virginica&#39;]
All the labels :
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Diabetes-Dataset">Diabetes Dataset<a class="anchor-link" href="#Diabetes-Dataset">&#182;</a></h3><blockquote><p>Regression dataset <br>
target : a quantitative measure of disease progression one year after baseline</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">diabetes</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_diabetes</span><span class="p">()</span>

<span class="n">Y_dia</span><span class="o">=</span><span class="n">diabetes</span><span class="o">.</span><span class="n">target</span>
<span class="n">X_dia</span><span class="o">=</span><span class="n">diabetes</span><span class="o">.</span><span class="n">data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_dia</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Names :&quot;</span><span class="p">,</span> <span class="n">diabetes</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 5 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_dia</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span>

<span class="c1">#print(&quot;Categories : &quot;, diabetes.target_names)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 5 target values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_dia</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (442, 10) 

Feature Names : [&#39;age&#39;, &#39;sex&#39;, &#39;bmi&#39;, &#39;bp&#39;, &#39;s1&#39;, &#39;s2&#39;, &#39;s3&#39;, &#39;s4&#39;, &#39;s5&#39;, &#39;s6&#39;]
The first 5 data entries : 
[[ 0.03807591  0.05068012  0.06169621  0.02187235 -0.0442235  -0.03482076
  -0.04340085 -0.00259226  0.01990842 -0.01764613]
 [-0.00188202 -0.04464164 -0.05147406 -0.02632783 -0.00844872 -0.01916334
   0.07441156 -0.03949338 -0.06832974 -0.09220405]
 [ 0.08529891  0.05068012  0.04445121 -0.00567061 -0.04559945 -0.03419447
  -0.03235593 -0.00259226  0.00286377 -0.02593034]
 [-0.08906294 -0.04464164 -0.01159501 -0.03665645  0.01219057  0.02499059
  -0.03603757  0.03430886  0.02269202 -0.00936191]
 [ 0.00538306 -0.04464164 -0.03638469  0.02187235  0.00393485  0.01559614
   0.00814208 -0.00259226 -0.03199144 -0.04664087]]
First 5 target values:
[151.  75. 141. 206. 135.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Breast-cancer-wisconsin-(diagnostic)-dataset">Breast cancer wisconsin (diagnostic) dataset<a class="anchor-link" href="#Breast-cancer-wisconsin-(diagnostic)-dataset">&#182;</a></h3><blockquote><p>Classification dataset</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bcw</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">()</span>
<span class="n">Y_bcw</span><span class="o">=</span><span class="n">bcw</span><span class="o">.</span><span class="n">target</span>
<span class="n">X_bcw</span><span class="o">=</span><span class="n">bcw</span><span class="o">.</span><span class="n">data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_bcw</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Names :&quot;</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 5 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_bcw</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categories : &quot;</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All the labels :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_bcw</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (569, 30) 

Feature Names : [&#39;mean radius&#39; &#39;mean texture&#39; &#39;mean perimeter&#39; &#39;mean area&#39;
 &#39;mean smoothness&#39; &#39;mean compactness&#39; &#39;mean concavity&#39;
 &#39;mean concave points&#39; &#39;mean symmetry&#39; &#39;mean fractal dimension&#39;
 &#39;radius error&#39; &#39;texture error&#39; &#39;perimeter error&#39; &#39;area error&#39;
 &#39;smoothness error&#39; &#39;compactness error&#39; &#39;concavity error&#39;
 &#39;concave points error&#39; &#39;symmetry error&#39; &#39;fractal dimension error&#39;
 &#39;worst radius&#39; &#39;worst texture&#39; &#39;worst perimeter&#39; &#39;worst area&#39;
 &#39;worst smoothness&#39; &#39;worst compactness&#39; &#39;worst concavity&#39;
 &#39;worst concave points&#39; &#39;worst symmetry&#39; &#39;worst fractal dimension&#39;]
The first 5 data entries : 
[[1.799e+01 1.038e+01 1.228e+02 1.001e+03 1.184e-01 2.776e-01 3.001e-01
  1.471e-01 2.419e-01 7.871e-02 1.095e+00 9.053e-01 8.589e+00 1.534e+02
  6.399e-03 4.904e-02 5.373e-02 1.587e-02 3.003e-02 6.193e-03 2.538e+01
  1.733e+01 1.846e+02 2.019e+03 1.622e-01 6.656e-01 7.119e-01 2.654e-01
  4.601e-01 1.189e-01]
 [2.057e+01 1.777e+01 1.329e+02 1.326e+03 8.474e-02 7.864e-02 8.690e-02
  7.017e-02 1.812e-01 5.667e-02 5.435e-01 7.339e-01 3.398e+00 7.408e+01
  5.225e-03 1.308e-02 1.860e-02 1.340e-02 1.389e-02 3.532e-03 2.499e+01
  2.341e+01 1.588e+02 1.956e+03 1.238e-01 1.866e-01 2.416e-01 1.860e-01
  2.750e-01 8.902e-02]
 [1.969e+01 2.125e+01 1.300e+02 1.203e+03 1.096e-01 1.599e-01 1.974e-01
  1.279e-01 2.069e-01 5.999e-02 7.456e-01 7.869e-01 4.585e+00 9.403e+01
  6.150e-03 4.006e-02 3.832e-02 2.058e-02 2.250e-02 4.571e-03 2.357e+01
  2.553e+01 1.525e+02 1.709e+03 1.444e-01 4.245e-01 4.504e-01 2.430e-01
  3.613e-01 8.758e-02]
 [1.142e+01 2.038e+01 7.758e+01 3.861e+02 1.425e-01 2.839e-01 2.414e-01
  1.052e-01 2.597e-01 9.744e-02 4.956e-01 1.156e+00 3.445e+00 2.723e+01
  9.110e-03 7.458e-02 5.661e-02 1.867e-02 5.963e-02 9.208e-03 1.491e+01
  2.650e+01 9.887e+01 5.677e+02 2.098e-01 8.663e-01 6.869e-01 2.575e-01
  6.638e-01 1.730e-01]
 [2.029e+01 1.434e+01 1.351e+02 1.297e+03 1.003e-01 1.328e-01 1.980e-01
  1.043e-01 1.809e-01 5.883e-02 7.572e-01 7.813e-01 5.438e+00 9.444e+01
  1.149e-02 2.461e-02 5.688e-02 1.885e-02 1.756e-02 5.115e-03 2.254e+01
  1.667e+01 1.522e+02 1.575e+03 1.374e-01 2.050e-01 4.000e-01 1.625e-01
  2.364e-01 7.678e-02]]
Categories :  [&#39;malignant&#39; &#39;benign&#39;]
All the labels :
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 1 0 0 0 0 0 0 0 0 1 0 1 1 1 1 1 0 0 1 0 0 1 1 1 1 0 1 0 0 1 1 1 1 0 1 0 0
 1 0 1 0 0 1 1 1 0 0 1 0 0 0 1 1 1 0 1 1 0 0 1 1 1 0 0 1 1 1 1 0 1 1 0 1 1
 1 1 1 1 1 1 0 0 0 1 0 0 1 1 1 0 0 1 0 1 0 0 1 0 0 1 1 0 1 1 0 1 1 1 1 0 1
 1 1 1 1 1 1 1 1 0 1 1 1 1 0 0 1 0 1 1 0 0 1 1 0 0 1 1 1 1 0 1 1 0 0 0 1 0
 1 0 1 1 1 0 1 1 0 0 1 0 0 0 0 1 0 0 0 1 0 1 0 1 1 0 1 0 0 0 0 1 1 0 0 1 1
 1 0 1 1 1 1 1 0 0 1 1 0 1 1 0 0 1 0 1 1 1 1 0 1 1 1 1 1 0 1 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 1 1 1 1 1 1 0 1 0 1 1 0 1 1 0 1 0 0 1 1 1 1 1 1 1 1 1 1 1 1
 1 0 1 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 0 1 1 1 1 0 0 0 1 1
 1 1 0 1 0 1 0 1 1 1 0 1 1 1 1 1 1 1 0 0 0 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 0
 0 1 0 0 1 1 1 1 1 0 1 1 1 1 1 0 1 1 1 0 1 1 0 0 1 1 1 1 1 1 0 1 1 1 1 1 1
 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 1 0 1 1 1 1 1 0 1 1
 0 1 0 1 1 0 1 0 1 1 1 1 1 1 1 1 0 0 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 0 1
 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 0 0 1 0 1 0 1 1 1 1 1 0 1 1 0 1 0 1 0 0
 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 0 0 0 0 0 0 1]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Other-Dataset">Other Dataset<a class="anchor-link" href="#Other-Dataset">&#182;</a></h2><blockquote><p>These datasets are provided as local files that need to be loaded.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Handwritten-Digits">Handwritten Digits<a class="anchor-link" href="#Handwritten-Digits">&#182;</a></h3><blockquote><p>The dataset used in the video lectures. <br>
Normalized handwritten digits, automatically scanned from envelopes by the U.S. Postal Service.  The original
scanned digits are binary and of different sizes and orientations; the images  here have been deslanted and size normalized, resulting in 16 x 16 grayscale images (Le Cun et al., 1990).</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfilename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Handwritten Digits</span><span class="se">\\</span><span class="s2">zip.train&quot;</span>
<span class="n">digit_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">tfilename</span><span class="p">)</span> 
<span class="c1">#print(np.shape(digit_data))</span>
<span class="c1">#print(digit_data[:5,:])</span>

<span class="n">Y_dig</span><span class="o">=</span><span class="n">digit_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X_dig</span><span class="o">=</span><span class="n">digit_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_dig</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 5 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_dig</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 100 labels :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_dig</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (7291, 256) 

The first 5 data entries : 
[[-1.    -1.    -1.    ... -1.    -1.    -1.   ]
 [-1.    -1.    -1.    ... -0.671 -0.828 -1.   ]
 [-1.    -1.    -1.    ... -1.    -1.    -1.   ]
 [-1.    -1.    -1.    ... -1.    -1.    -1.   ]
 [-1.    -1.    -1.    ... -0.883 -1.    -1.   ]]
First 100 labels :
[6. 5. 4. 7. 3. 6. 3. 1. 0. 1. 7. 0. 1. 1. 7. 7. 4. 8. 0. 1. 4. 8. 7. 4.
 8. 7. 3. 7. 4. 1. 3. 6. 7. 4. 1. 3. 7. 7. 4. 5. 4. 2. 7. 4. 1. 3. 7. 7.
 4. 0. 6. 3. 2. 0. 8. 6. 6. 2. 0. 8. 7. 8. 2. 0. 9. 0. 2. 2. 0. 8. 1. 2.
 0. 8. 3. 3. 2. 8. 2. 2. 0. 8. 1. 4. 4. 8. 9. 8. 9. 6. 7. 6. 1. 9. 7. 0.
 8. 0. 4. 6.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#examining one of the images (datapoints)</span>
<span class="n">k</span><span class="o">=</span><span class="mi">96</span>
<span class="n">imagek</span><span class="o">=</span><span class="n">X_dig</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_dig</span><span class="p">[</span><span class="n">k</span><span class="p">,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">imagek</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[-1.    -1.    -1.    -1.    -1.    -0.934 -0.861 -0.673 -0.302 -0.
  0.596  0.886  0.905 -0.563 -1.    -1.    -1.    -1.    -1.    -0.952
 -0.13   0.598  1.     1.     0.868  0.721  0.526  0.349  0.007 -0.908
 -1.    -1.    -1.    -1.    -0.458  0.747  0.995  0.725  0.223 -0.671
 -0.946 -1.    -1.    -1.    -1.    -1.    -1.    -1.    -1.    -0.869
  0.855  0.812 -0.557 -1.    -1.    -1.    -1.    -1.    -1.    -1.
 -0.541 -0.386 -1.    -1.    -1.    -0.642  1.    -0.174 -1.    -1.
 -1.    -1.    -1.    -1.    -1.    -1.    -0.024  0.974 -0.749 -1.
 -1.    -0.868  0.898  0.016 -1.    -1.    -1.    -1.    -1.    -1.
 -1.    -0.7    0.767  0.919 -0.867 -1.    -1.    -1.    -0.353  0.849
 -0.519 -1.    -1.    -1.    -1.    -1.    -0.286  0.837  1.    -0.168
 -1.    -1.    -1.    -1.    -1.    -0.35   0.903 -0.026 -0.928 -1.
 -0.65   0.473  0.982  0.916 -0.228 -0.985 -1.    -1.    -1.    -1.
 -1.    -1.    -0.769  0.27   0.721  0.092  0.998  0.974  0.291 -0.643
 -1.    -1.    -1.    -1.    -1.    -1.    -1.    -1.    -0.997 -0.204
  0.946  1.     1.    -0.303 -1.    -1.    -1.    -1.    -1.    -1.
 -1.    -1.    -1.    -0.998 -0.087  0.995  0.771 -0.21  -0.133  0.774
 -0.562 -1.    -1.    -1.    -1.    -1.    -1.    -1.    -1.    -0.299
  0.991  0.555 -0.791 -1.    -1.    -0.544  0.759 -0.403 -1.    -1.
 -1.    -1.    -1.    -1.    -1.     0.272  1.    -0.612 -1.    -1.
 -1.    -1.    -0.505  0.795 -0.763 -1.    -1.    -1.    -1.    -1.
 -1.    -0.264  0.95  -0.943 -1.    -1.    -1.    -1.    -0.995  0.743
  0.107 -1.    -1.    -1.    -1.    -1.    -1.    -0.992  0.231 -0.073
 -0.959 -1.    -1.    -1.    -0.408  0.936  0.046 -1.    -1.    -1.
 -1.    -1.    -1.    -1.    -0.99  -0.293  0.349  0.39   0.487  0.548
  0.831  0.272 -0.92  -1.    -1.    -1.   ]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[47]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x24ec8f84a88&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_96_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#visualizing the first 30 images</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">X_dig</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">X_dig</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_97_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Heart-Failure-Dataset">Heart Failure Dataset<a class="anchor-link" href="#Heart-Failure-Dataset">&#182;</a></h3><blockquote><p><a href="https://archive.ics.uci.edu/ml/datasets/Heart+failure+clinical+records">https://archive.ics.uci.edu/ml/datasets/Heart+failure+clinical+records</a></p>
<p>Thirteen (13) clinical features:</p>
<ul>
<li>age: age of the patient (years)</li>
<li>anaemia: decrease of red blood cells or hemoglobin (boolean)</li>
<li>high blood pressure: if the patient has hypertension (boolean)</li>
<li>creatinine phosphokinase (CPK): level of the CPK enzyme in the blood (mcg/L)</li>
<li>diabetes: if the patient has diabetes (boolean)</li>
<li>ejection fraction: percentage of blood leaving the heart at each contraction (percentage)</li>
<li>platelets: platelets in the blood (kiloplatelets/mL)</li>
<li>sex: woman or man (binary)</li>
<li>serum creatinine: level of serum creatinine in the blood (mg/dL)</li>
<li>serum sodium: level of serum sodium in the blood (mEq/L)</li>
<li>smoking: if the patient smokes or not (boolean)</li>
<li>time: follow-up period (days)</li>
<li>[target] death event: if the patient deceased during the follow-up period (boolean)</li>
</ul>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="data:image/png;base64,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" alt="image.png"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Heart Failure</span><span class="se">\\</span><span class="s2">heart_failure_clinical_records_dataset.csv&quot;</span>
<span class="n">hfd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">Y_hfd</span><span class="o">=</span><span class="n">hfd</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">X_hfd</span><span class="o">=</span><span class="n">hfd</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_hfd</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 5 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_hfd</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All labels :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_hfd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (299, 12) 

The first 5 data entries : 
[[7.5000000e+01 0.0000000e+00 5.8200000e+02 0.0000000e+00 2.0000000e+01
  1.0000000e+00 2.6500000e+05 1.9000000e+00 1.3000000e+02 1.0000000e+00
  0.0000000e+00 4.0000000e+00]
 [5.5000000e+01 0.0000000e+00 7.8610000e+03 0.0000000e+00 3.8000000e+01
  0.0000000e+00 2.6335803e+05 1.1000000e+00 1.3600000e+02 1.0000000e+00
  0.0000000e+00 6.0000000e+00]
 [6.5000000e+01 0.0000000e+00 1.4600000e+02 0.0000000e+00 2.0000000e+01
  0.0000000e+00 1.6200000e+05 1.3000000e+00 1.2900000e+02 1.0000000e+00
  1.0000000e+00 7.0000000e+00]
 [5.0000000e+01 1.0000000e+00 1.1100000e+02 0.0000000e+00 2.0000000e+01
  0.0000000e+00 2.1000000e+05 1.9000000e+00 1.3700000e+02 1.0000000e+00
  0.0000000e+00 7.0000000e+00]
 [6.5000000e+01 1.0000000e+00 1.6000000e+02 1.0000000e+00 2.0000000e+01
  0.0000000e+00 3.2700000e+05 2.7000000e+00 1.1600000e+02 0.0000000e+00
  0.0000000e+00 8.0000000e+00]]
All labels :
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1. 0. 1. 1. 0.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 1. 1. 0. 1. 0. 1. 1. 1. 1. 1. 0. 0.
 1. 0. 1. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 1. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 1.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0.
 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.
 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="HCV-Dataset">HCV Dataset<a class="anchor-link" href="#HCV-Dataset">&#182;</a></h3><blockquote><p>Modified the HCV data set found at <a href="https://archive.ics.uci.edu/ml/datasets/HCV+data">https://archive.ics.uci.edu/ml/datasets/HCV+data</a> <br></p>
<p>Removed the record with missing data.  Removed the first column (the patient id).  Converted categories and sex into numerical values<br>
The target attribute for classification is Category (blood donors vs. Hepatitis C (including its progress ('just' Hepatitis C, Fibrosis, Cirrhosis).<br></p>
<p>The laboratory data are the attributes 4-13.<br></p>
<ol>
<li>Category (diagnosis) (values: '0=Blood Donor', '0.5=suspect Blood Donor', '1=Hepatitis', '2=Fibrosis', '3=Cirrhosis')</li>
<li>Age (in years)</li>
<li>Sex (1=f,0=m)</li>
<li>ALB</li>
<li>ALP</li>
<li>ALT</li>
<li>AST</li>
<li>BIL</li>
<li>CHE</li>
<li>CHOL</li>
<li>CREA</li>
<li>GGT</li>
<li>PROT</li>
</ol>
<p>Relevant Papers: <br>
Lichtinghagen R et al. J Hepatol 2013; 59: 236-42
Hoffmann G et al. Using machine learning techniques to generate laboratory diagnostic pathways  a case study. J Lab Precis Med 2018; 3: 58-67</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">HCV data set</span><span class="se">\\</span><span class="s2">hcvdat0_mod.csv&quot;</span>
<span class="n">hcv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">Y_hcv</span><span class="o">=</span><span class="n">hcv</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X_hcv</span><span class="o">=</span><span class="n">hcv</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_hcv</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 5 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_hcv</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All labels :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_hcv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (589, 12) 

The first 5 data entries : 
[[ 32.     0.    38.5   52.5    7.7   22.1    7.5    6.93   3.23 106.
   12.1   69.  ]
 [ 32.     0.    38.5   70.3   18.    24.7    3.9   11.17   4.8   74.
   15.6   76.5 ]
 [ 32.     0.    46.9   74.7   36.2   52.6    6.1    8.84   5.2   86.
   33.2   79.3 ]
 [ 32.     0.    43.2   52.    30.6   22.6   18.9    7.33   4.74  80.
   33.8   75.7 ]
 [ 32.     0.    39.2   74.1   32.6   24.8    9.6    9.15   4.32  76.
   29.9   68.7 ]]
All labels :
[0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.
 0.  0.  0.  0.  0.5 0.5 0.5 0.5 0.5 0.5 0.5 1.  1.  1.  1.  1.  1.  1.
 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  2.  2.  2.  2.  2.
 2.  2.  2.  2.  2.  2.  2.  3.  3.  3.  3.  3.  3.  3.  3.  3.  3.  3.
 3.  3.  3.  3.  3.  3.  3.  3.  3.  3.  3.  3.  3. ]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Diabetes-Dataset-(Bangladesh-hospital)">Diabetes Dataset (Bangladesh hospital)<a class="anchor-link" href="#Diabetes-Dataset-(Bangladesh-hospital)">&#182;</a></h3><blockquote><p>Modified the Diabetes data set found at <a href="https://archive.ics.uci.edu/ml/datasets/Early+stage+diabetes+risk+prediction+dataset">https://archive.ics.uci.edu/ml/datasets/Early+stage+diabetes+risk+prediction+dataset</a>.</p>
<p>Data Set Information:<br>
This has been collected using direct questionnaires from the patients of Sylhet Diabetes Hospital in Sylhet, Bangladesh and approved by a doctor.</p>
<p>Attribute Information:<br></p>
<ol>
<li>Age 1.20-65</li>
<li>Sex 0. Male, 1.Female</li>
<li>Polyuria 1.Yes, 0.No.</li>
<li>Polydipsia 1.Yes, 0.No.</li>
<li>sudden weight loss 1.Yes, 0.No.</li>
<li>weakness 1.Yes, 0.No.</li>
<li>Polyphagia 1.Yes, 0.No.</li>
<li>Genital thrush 1.Yes, 0.No.</li>
<li>visual blurring 1.Yes, 0.No.</li>
<li>Itching 1.Yes, 0.No.</li>
<li>Irritability 1.Yes, 0.No.</li>
<li>delayed healing 1.Yes, 0.No.</li>
<li>partial paresis 1.Yes, 0.No.</li>
<li>muscle stiffness 1.Yes, 0.No.</li>
<li>Alopecia 1.Yes, 0.No.</li>
<li>Obesity 1.Yes, 0.No.</li>
<li>Class 1.Positive, -1.Negative.</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Diabetes dataset</span><span class="se">\\</span><span class="s2">diabetes_data_mod.csv&quot;</span>
<span class="n">dia</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">Y_dia</span><span class="o">=</span><span class="n">dia</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">X_dia</span><span class="o">=</span><span class="n">dia</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_dia</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 5 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_dia</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All labels :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_dia</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (520, 16) 

The first 5 data entries : 
[[40.  0.  0.  1.  0.  1.  0.  0.  0.  1.  0.  1.  0.  1.  1.  1.]
 [58.  0.  0.  0.  0.  1.  0.  0.  1.  0.  0.  0.  1.  0.  1.  0.]
 [41.  0.  1.  0.  0.  1.  1.  0.  0.  1.  0.  1.  0.  1.  1.  0.]
 [45.  0.  0.  0.  1.  1.  1.  1.  0.  1.  0.  1.  0.  0.  0.  0.]
 [60.  0.  1.  1.  1.  1.  1.  0.  1.  1.  1.  1.  1.  1.  1.  1.]]
All labels :
[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.
 -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.
 -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.
 -1. -1. -1. -1. -1. -1. -1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1. -1.
 -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.
 -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1. -1. -1. -1. -1. -1. -1. -1. -1. -1.
  1.  1.  1.  1.  1.  1.  1.  1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.
 -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1. -1. -1. -1. -1. -1. -1. -1. -1.
 -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.  1.  1.  1.
  1.  1. -1. -1. -1. -1. -1. -1. -1. -1. -1. -1.  1. -1.  1. -1. -1. -1.
 -1. -1. -1. -1. -1. -1. -1. -1. -1.  1.  1.  1.  1.  1. -1. -1.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="K-Nearest-Neighbors-and-Naive-Bayes-Classifiers-with-SciKit">K-Nearest Neighbors and Naive Bayes Classifiers with SciKit<a class="anchor-link" href="#K-Nearest-Neighbors-and-Naive-Bayes-Classifiers-with-SciKit">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>We'll run a couple of classification learning models on a few of the datasets.  <br>
We are going to use Naive Bayes classifier and Nearest Neighbors classifier.</p>
<p>We will first split the dataset into two sets:</p>
<ol>
<li>A training set used to train the model on</li>
<li>A test set to check how well we learning</li>
</ol>
<p>After we load the data, for each model we are going to perform the following steps:</p>
<ol>
<li>Build the model (i.e., set up the model type and structure)</li>
<li>Train the model using the training data (i.e., adjust the parameters)</li>
<li>Make predictions using the testing data </li>
<li>Evaluate the performace of the model</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">naive_bayes</span><span class="p">,</span> <span class="n">neighbors</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Iris-Dataset">Iris Dataset<a class="anchor-link" href="#Iris-Dataset">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-the-dataset-and-split-into-training-and-testing-sets">Load the dataset and split into training and testing sets<a class="anchor-link" href="#Load-the-dataset-and-split-into-training-and-testing-sets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iris</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="p">(</span><span class="n">Xtrain_iris</span><span class="p">,</span> <span class="n">Xtest_iris</span><span class="p">,</span> <span class="n">Ytrain_iris</span><span class="p">,</span> <span class="n">Ytest_iris</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the training set X data : &quot;</span><span class="p">,</span> <span class="n">Xtrain_iris</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the testing set X data : &quot;</span><span class="p">,</span> <span class="n">Xtest_iris</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Names :&quot;</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categories : &quot;</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the training set X data :  (105, 4) 

Dimensions of the testing set X data :  (45, 4) 

Feature Names : [&#39;sepal length (cm)&#39;, &#39;sepal width (cm)&#39;, &#39;petal length (cm)&#39;, &#39;petal width (cm)&#39;]
Categories :  [&#39;setosa&#39; &#39;versicolor&#39; &#39;virginica&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="K-Nearest-Neighbors-Classifier">K-Nearest Neighbors Classifier<a class="anchor-link" href="#K-Nearest-Neighbors-Classifier">&#182;</a></h3><blockquote><p><a href="https://scikit-learn.org/stable/modules/neighbors.html#neighbors">https://scikit-learn.org/stable/modules/neighbors.html#neighbors</a></p>
<p>We are going to perform the following steps</p>
<ol>
<li>Build a 3-NN (three nearest neighbors) model</li>
<li>Train the model using the training data (i.e., adjust the parameters)</li>
<li>Make predictions using the testing data</li>
<li>Evaluate the performace of the model</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn</span><span class="o">=</span><span class="n">neighbors</span><span class="o">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1">#step 1</span>
<span class="n">knn_fit</span><span class="o">=</span><span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain_iris</span><span class="p">,</span> <span class="n">Ytrain_iris</span><span class="p">)</span>          <span class="c1">#step 2 </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ypred_iris_knn</span><span class="o">=</span><span class="n">knn_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest_iris</span><span class="p">)</span>         <span class="c1">#step 3 - get the predicted labels given the feature inputs for the test set</span>
<span class="c1"># step 4</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Actual Labels   :&quot;</span><span class="p">,</span> <span class="n">Ytest_iris</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Predicted Labels:&quot;</span><span class="p">,</span> <span class="n">Ypred_iris_knn</span><span class="p">)</span>
<span class="n">test_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">Ytest_iris</span><span class="p">)</span>
<span class="n">knn_accuracy</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Ytest_iris</span><span class="o">==</span><span class="n">Ypred_iris_knn</span><span class="p">)</span><span class="o">/</span><span class="n">test_size</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy         :&quot;</span><span class="p">,</span> <span class="n">knn_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error            :&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="o">-</span><span class="n">knn_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Actual Labels   : [0 1 0 2 2 2 2 1 1 2 2 2 2 1 2 2 1 2 0 0 2 1 2 0 1 0 2 2 1 2 2 0 0 1 0 0 2
 1 2 1 1 0 0 1 0]
Predicted Labels: [0 1 0 2 2 2 2 1 1 2 1 2 2 1 2 2 1 1 0 0 2 1 2 0 1 0 2 2 1 2 2 0 0 1 0 0 2
 1 2 1 1 0 0 1 0]
Accuracy         : 95.55555555555556 %.
Error            : 4.444444444444443 %.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Naive-Bayes-Classifier">Naive Bayes Classifier<a class="anchor-link" href="#Naive-Bayes-Classifier">&#182;</a></h3><blockquote><p><a href="https://scikit-learn.org/stable/modules/naive_bayes.html#naive-bayes">https://scikit-learn.org/stable/modules/naive_bayes.html#naive-bayes</a></p>
<p>We are going to perform the following steps</p>
<ol>
<li>Build a naive bayes (gaussian) model</li>
<li>Train the model using the training data (i.e., adjust the parameters)</li>
<li>Make predictions using the testing data</li>
<li>Evaluate the performace of the model</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nb</span><span class="o">=</span><span class="n">naive_bayes</span><span class="o">.</span><span class="n">GaussianNB</span><span class="p">()</span>                      <span class="c1">#step 1</span>
<span class="n">nb_fit</span><span class="o">=</span><span class="n">nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain_iris</span><span class="p">,</span> <span class="n">Ytrain_iris</span><span class="p">)</span>          <span class="c1">#step 2 </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ypred_iris_nb</span><span class="o">=</span><span class="n">nb_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest_iris</span><span class="p">)</span>         <span class="c1">#step 3 - get the predicted labels given the feature inputs for the test set</span>

<span class="c1"># step 4</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Actual Labels   :&quot;</span><span class="p">,</span> <span class="n">Ytest_iris</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Predicted Labels:&quot;</span><span class="p">,</span> <span class="n">Ypred_iris_nb</span><span class="p">)</span>
<span class="n">test_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">Ytest_iris</span><span class="p">)</span>
<span class="n">nb_accuracy</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Ytest_iris</span><span class="o">==</span><span class="n">Ypred_iris_nb</span><span class="p">)</span><span class="o">/</span><span class="n">test_size</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy         :&quot;</span><span class="p">,</span> <span class="n">nb_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error            :&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="o">-</span><span class="n">nb_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Actual Labels   : [0 1 0 2 2 2 2 1 1 2 2 2 2 1 2 2 1 2 0 0 2 1 2 0 1 0 2 2 1 2 2 0 0 1 0 0 2
 1 2 1 1 0 0 1 0]
Predicted Labels: [0 1 0 2 2 2 2 1 1 2 1 2 2 1 2 2 1 2 0 0 2 1 2 0 1 0 2 2 1 2 2 0 0 1 0 0 2
 1 2 1 2 0 0 1 0]
Accuracy         : 95.55555555555556 %.
Error            : 4.444444444444443 %.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Handwritten-Digits">Handwritten Digits<a class="anchor-link" href="#Handwritten-Digits">&#182;</a></h2><blockquote><p>The dataset used in the video lectures.<br>
Normalized handwritten digits, automatically scanned from envelopes by the U.S. Postal Service. The original
scanned digits are binary and of different sizes and orientations; the images  here have been deslanted and size normalized, resulting in 16 x 16 grayscale images (Le Cun et al., 1990).</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-the-dataset-and-split-into-training-and-testing-sets">Load the dataset and split into training and testing sets<a class="anchor-link" href="#Load-the-dataset-and-split-into-training-and-testing-sets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfilename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Handwritten Digits</span><span class="se">\\</span><span class="s2">zip.train&quot;</span>
<span class="n">digit_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">tfilename</span><span class="p">)</span> 
<span class="n">Y_dig</span><span class="o">=</span><span class="n">digit_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X_dig</span><span class="o">=</span><span class="n">digit_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">X_dig</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="n">Xtrain_dig</span><span class="p">,</span> <span class="n">Xtest_dig</span><span class="p">,</span> <span class="n">Ytrain_dig</span><span class="p">,</span> <span class="n">Ytest_dig</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X_dig</span><span class="p">,</span> <span class="n">Y_dig</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the training set X data : &quot;</span><span class="p">,</span> <span class="n">Xtrain_dig</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the testing set X data  : &quot;</span><span class="p">,</span> <span class="n">Xtest_dig</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (7291, 256) 

Dimensions of the training set X data :  (5103, 256) 

Dimensions of the testing set X data  :  (2188, 256) 

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="K-Nearest-Neighbors-Classifier">K-Nearest Neighbors Classifier<a class="anchor-link" href="#K-Nearest-Neighbors-Classifier">&#182;</a></h3><blockquote><p>We are going to perform the following steps</p>
<ol>
<li>Build a 3-NN (three nearest neighbors) model</li>
<li>Train the model using the training data (i.e., adjust the parameters)</li>
<li>Make predictions using the testing data</li>
<li>Evaluate the performace of the model</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dknn</span><span class="o">=</span><span class="n">neighbors</span><span class="o">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1">#step 1</span>
<span class="n">dknn_fit</span><span class="o">=</span><span class="n">dknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain_dig</span><span class="p">,</span> <span class="n">Ytrain_dig</span><span class="p">)</span>          <span class="c1">#step 2 </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ypred_dig_knn</span><span class="o">=</span><span class="n">dknn_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest_dig</span><span class="p">)</span>         <span class="c1">#step 3 - get the predicted labels given the feature inputs for the test set</span>

<span class="c1"># step 4</span>
<span class="n">dtest_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">Ytest_dig</span><span class="p">)</span>
<span class="n">dknn_accuracy</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Ytest_dig</span><span class="o">==</span><span class="n">Ypred_dig_knn</span><span class="p">)</span><span class="o">/</span><span class="n">dtest_size</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy         :&quot;</span><span class="p">,</span> <span class="n">dknn_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error            :&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="o">-</span><span class="n">dknn_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy         : 96.52650822669104 %.
Error            : 3.4734917733089645 %.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Naive-Bayes-Classifier">Naive Bayes Classifier<a class="anchor-link" href="#Naive-Bayes-Classifier">&#182;</a></h3><p>We are going to perform the following steps</p>
<ol>
<li>Build a naive bayes (gaussian) model</li>
<li>Train the model using the training data (i.e., adjust the parameters)</li>
<li>Make predictions using the testing data</li>
<li>Evaluate the performace of the model</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dnb</span><span class="o">=</span><span class="n">naive_bayes</span><span class="o">.</span><span class="n">GaussianNB</span><span class="p">()</span>                      <span class="c1">#step 1</span>
<span class="n">dnb_fit</span><span class="o">=</span><span class="n">dnb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain_dig</span><span class="p">,</span> <span class="n">Ytrain_dig</span><span class="p">)</span>          <span class="c1">#step 2 </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ypred_dig_nb</span><span class="o">=</span><span class="n">dnb_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest_dig</span><span class="p">)</span>         <span class="c1">#step 3 - get the predicted labels given the feature inputs for the test set</span>
<span class="c1"># step 4</span>
<span class="n">dnb_accuracy</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Ytest_dig</span><span class="o">==</span><span class="n">Ypred_dig_nb</span><span class="p">)</span><span class="o">/</span><span class="n">dtest_size</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy         :&quot;</span><span class="p">,</span> <span class="n">dnb_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error            :&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="o">-</span><span class="n">dnb_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy         : 75.54844606946983 %.
Error            : 24.451553930530167 %.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#visualizing the first 30 images of the test set 3-NN</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xtest_dig</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Ypred_dig_knn</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xtest_dig</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Ypred_dig_knn</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_127_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#visualizing the first 30 images of the test set NB</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xtest_dig</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Ypred_dig_nb</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xtest_dig</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Ypred_dig_nb</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_128_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Breast-cancer-wisconsin-(diagnostic)-dataset">Breast cancer wisconsin (diagnostic) dataset<a class="anchor-link" href="#Breast-cancer-wisconsin-(diagnostic)-dataset">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-the-dataset-and-split-into-training-and-testing-sets">Load the dataset and split into training and testing sets<a class="anchor-link" href="#Load-the-dataset-and-split-into-training-and-testing-sets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bcw</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">()</span>

<span class="p">(</span><span class="n">Xtrain_bcw</span><span class="p">,</span> <span class="n">Xtest_bcw</span><span class="p">,</span> <span class="n">Ytrain_bcw</span><span class="p">,</span> <span class="n">Ytest_bcw</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">bcw</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the training set X data : &quot;</span><span class="p">,</span> <span class="n">Xtrain_bcw</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the testing set X data : &quot;</span><span class="p">,</span> <span class="n">Xtest_bcw</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Names :&quot;</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categories : &quot;</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the training set X data :  (398, 30) 

Dimensions of the testing set X data :  (171, 30) 

Feature Names : [&#39;mean radius&#39; &#39;mean texture&#39; &#39;mean perimeter&#39; &#39;mean area&#39;
 &#39;mean smoothness&#39; &#39;mean compactness&#39; &#39;mean concavity&#39;
 &#39;mean concave points&#39; &#39;mean symmetry&#39; &#39;mean fractal dimension&#39;
 &#39;radius error&#39; &#39;texture error&#39; &#39;perimeter error&#39; &#39;area error&#39;
 &#39;smoothness error&#39; &#39;compactness error&#39; &#39;concavity error&#39;
 &#39;concave points error&#39; &#39;symmetry error&#39; &#39;fractal dimension error&#39;
 &#39;worst radius&#39; &#39;worst texture&#39; &#39;worst perimeter&#39; &#39;worst area&#39;
 &#39;worst smoothness&#39; &#39;worst compactness&#39; &#39;worst concavity&#39;
 &#39;worst concave points&#39; &#39;worst symmetry&#39; &#39;worst fractal dimension&#39;]
Categories :  [&#39;malignant&#39; &#39;benign&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="K-Nearest-Neighbors-Classifier">K-Nearest Neighbors Classifier<a class="anchor-link" href="#K-Nearest-Neighbors-Classifier">&#182;</a></h3><blockquote><p>We are going to perform the following steps</p>
<ol>
<li>Build a 3-NN (three nearest neighbors) model</li>
<li>Train the model using the training data (i.e., adjust the parameters)</li>
<li>Make predictions using the testing data</li>
<li>Evaluate the performace of the model</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bknn</span><span class="o">=</span><span class="n">neighbors</span><span class="o">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1">#step 1</span>
<span class="n">bknn_fit</span><span class="o">=</span><span class="n">dknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain_bcw</span><span class="p">,</span> <span class="n">Ytrain_bcw</span><span class="p">)</span>          <span class="c1">#step 2 </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ypred_bcw_knn</span><span class="o">=</span><span class="n">bknn_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest_bcw</span><span class="p">)</span>         <span class="c1">#step 3 - get the predicted labels given the feature inputs for the test set</span>

<span class="c1"># step 4</span>
<span class="n">btest_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">Ytest_bcw</span><span class="p">)</span>
<span class="n">bknn_accuracy</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Ytest_bcw</span><span class="o">==</span><span class="n">Ypred_bcw_knn</span><span class="p">)</span><span class="o">/</span><span class="n">btest_size</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy         :&quot;</span><span class="p">,</span> <span class="n">bknn_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error            :&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="o">-</span><span class="n">bknn_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy         : 92.39766081871345 %.
Error            : 7.602339181286553 %.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Naive-Bayes-Classifier">Naive Bayes Classifier<a class="anchor-link" href="#Naive-Bayes-Classifier">&#182;</a></h3><blockquote><p>We are going to perform the following steps</p>
<ol>
<li>Build a naive bayes (gaussian) model</li>
<li>Train the model using the training data (i.e., adjust the parameters)</li>
<li>Make predictions using the testing data</li>
<li>Evaluate the performace of the model</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[68]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bnb</span><span class="o">=</span><span class="n">naive_bayes</span><span class="o">.</span><span class="n">GaussianNB</span><span class="p">()</span>                      <span class="c1">#step 1</span>
<span class="n">bnb_fit</span><span class="o">=</span><span class="n">bnb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain_bcw</span><span class="p">,</span> <span class="n">Ytrain_bcw</span><span class="p">)</span>          <span class="c1">#step 2 </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ypred_bcw_nb</span><span class="o">=</span><span class="n">bnb_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest_bcw</span><span class="p">)</span>         <span class="c1">#step 3 - get the predicted labels given the feature inputs for the test set</span>
<span class="c1"># step 4</span>
<span class="n">bnb_accuracy</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Ytest_bcw</span><span class="o">==</span><span class="n">Ypred_bcw_nb</span><span class="p">)</span><span class="o">/</span><span class="n">btest_size</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy         :&quot;</span><span class="p">,</span> <span class="n">bnb_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error            :&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="o">-</span><span class="n">bnb_accuracy</span><span class="p">,</span> <span class="s2">&quot;%.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy         : 96.49122807017544 %.
Error            : 3.5087719298245617 %.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Simple-but-Complete-Learning-Process">Simple but Complete Learning Process<a class="anchor-link" href="#Simple-but-Complete-Learning-Process">&#182;</a></h1><p>Diabetes Dataset</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-the-Data">Getting the Data<a class="anchor-link" href="#Getting-the-Data">&#182;</a></h2><p>Diabetes Dataset</p>
<blockquote><p>Regression dataset <br>
target : a quantitative measure of disease progression one year after baseline</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">diabetesData</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_diabetes</span><span class="p">()</span>
<span class="p">(</span><span class="n">Input</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">diabetesData</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">diabetesData</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

<span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">d</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Input</span><span class="p">);</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;by&quot;</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Names :&quot;</span><span class="p">,</span> <span class="n">diabetesData</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 5 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Input</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span>

<span class="c1">#print(&quot;Categories : &quot;, diabetes.target_names)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 5 target values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Output</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  331 by 10 

Feature Names : [&#39;age&#39;, &#39;sex&#39;, &#39;bmi&#39;, &#39;bp&#39;, &#39;s1&#39;, &#39;s2&#39;, &#39;s3&#39;, &#39;s4&#39;, &#39;s5&#39;, &#39;s6&#39;]
The first 5 data entries : 
[[-0.07816532 -0.04464164 -0.0730303  -0.05731367 -0.08412613 -0.07427747
  -0.02499266 -0.03949338 -0.01811827 -0.08391984]
 [-0.10722563 -0.04464164 -0.01159501 -0.04009932  0.0493413   0.0644473
  -0.01394774  0.03430886  0.00702686 -0.03007245]
 [ 0.03444337  0.05068012  0.02828403 -0.03321358 -0.04559945 -0.00976889
  -0.05076412 -0.00259226 -0.0594727  -0.02178823]
 [ 0.04534098  0.05068012 -0.03530688  0.0631868  -0.00432087 -0.00162703
  -0.01026611 -0.00259226  0.01556684  0.0569118 ]
 [-0.02730979 -0.04464164  0.08001901  0.09876313 -0.00294491  0.01810133
  -0.01762938  0.00331192 -0.02952762  0.03620126]]
First 5 target values:
[142. 200. 145. 185. 257.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Error-Measure">Error Measure<a class="anchor-link" href="#Error-Measure">&#182;</a></h2><ul>
<li>It is a regression problem (not classification)</li>
<li>No error measure is give to us, other than the vague description to predict the target</li>
<li><p>It seems reasonable (and mathematically convenient) to use the square error measure.  I.e. for a given hypothesis $h$ and any input $\mathbf{x}$ penalize by the square of how much it missed the target y
\begin{equation*}
e\left(h(\mathbf{x}),y\right)=\left(h(\mathbf{x})-y\right)^2
\end{equation*}</p>
</li>
<li><p>The in-sample error of a given hypothesis is the average of errors for all the points in the training set 
\begin{equation*}
E_{in}(h)=\frac{1}{N}\sum_{k=1}^{N}\left(h(\mathbf{x}_k)-y_k\right)^2
\end{equation*}
where $N$ is the size of the training set and $(x_k, y_k)$ are the points in the training set.</p>
</li>
<li>We are going to extimate the out of sample error for a given hypothesis $h$ by averaging the error over a set of new points drawn from the same distribution as the training set.  We will call this set the <em>test</em> set.
\begin{equation*}
E_{out}(h)\approx\frac{1}{M}\sum_{k=1}^{M}\left(h(\mathbf{x}_k)-y_k\right)^2
\end{equation*}
where $M$ is the size of the test set and $(\mathbf{x}_k, y_k)$ are the points in the test set (different points than the ones in the training set).</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Picking-the-Hypothesis-Set-and-the-Algorithm">Picking the Hypothesis Set and the Algorithm<a class="anchor-link" href="#Picking-the-Hypothesis-Set-and-the-Algorithm">&#182;</a></h2><ul>
<li><p>This requires quite a bit of thought and investigation, but for now let's pick a linear model as the hypothesis set. i.e. for any input $\mathbf{x}=\left(x_1, x_2, \ldots, x_{10}\right)$,
\begin{equation*}
h(\mathbf{x})=w_0+w_1x_1+\cdots+w_{10}x_{10}
\end{equation*}
To remove any ambiguition, we will denote $h$ by $h_\mathbf{w}$ so that it is clear that each $\mathbf{w}$ produces a hypothesis.</p>
</li>
<li><p>The algorithm pick is automatic in this case once we picked the hypothesis set and the error measure : <strong>linear regression</strong> is the best (optimal) tool for the job.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Picking-the-best-linear-model-using-linear-regression">Picking the best linear model using linear regression<a class="anchor-link" href="#Picking-the-best-linear-model-using-linear-regression">&#182;</a></h3><ul>
<li>Construct $\mathbf{X}$, and $\mathbf{y}$ </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">=</span><span class="n">Input</span>
<span class="n">y</span><span class="o">=</span><span class="n">Output</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Solve $\mathbf{X}\mathbf{w}=\mathbf{y}$ to get the wegiths $\mathbf{w}$ for the best hypothesis </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">w</span><span class="o">=</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;w : &quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>w :  [ 151.44882069    5.71876565 -242.734522    489.04655164  348.74117513
 -877.59677683  550.08605133  150.86832586  251.69454041  717.59450286
   33.33083865]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get-the-In-Sample-Error">Get the In-Sample Error<a class="anchor-link" href="#Get-the-In-Sample-Error">&#182;</a></h2><ul>
<li><p>Using $\mathbf{w}$ from above, get the prediction for each point $\mathbf{x}$
\begin{equation*}
g(\mathbf{x})=w_0+w_1x_1+\cdots+w_{10}x_{10}
\end{equation*}</p>
</li>
<li><p>Using matrix notation this can be done using 
\begin{equation*}
\mathbf{g}=\mathbf{X}\mathbf{w}
\end{equation*}
where $ \mathbf{g}$ is the vector of all predictions</p>
</li>
</ul>
<ul>
<li>The error of $ \mathbf{g}$ is $\text{np.mean}(\left(\mathbf{g}-\mathbf{y}\right)^2)$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">w</span>
<span class="n">Ein</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">g</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Ein</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>54.129740814401714
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get-the-Out-of-Sample-Error-Estimate">Get the Out-of-Sample Error Estimate<a class="anchor-link" href="#Get-the-Out-of-Sample-Error-Estimate">&#182;</a></h2><ul>
<li><p>Using $\mathbf{w}$ from above, get the prediction for each point $\mathbf{x}$ in the test set.  Let denote by $\mathbf{x_t}$ and $y_t$ the input and output of the points in the test set.</p>
</li>
<li><p>Using matrix notation this can be done using 
\begin{equation*}
\mathbf{g_t}=\mathbf{X_t}\mathbf{w}
\end{equation*}
where $ \mathbf{g_t}$ is the vector of all predictions for the test set</p>
</li>
</ul>
<ul>
<li>The error of $ \mathbf{g_t}$ is $\text{np.mean}(\left(\mathbf{g_t}-\mathbf{y_t}\right)^2)$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
<span class="n">Xt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">M</span><span class="p">,</span> <span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">Xt</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">=</span><span class="n">Xtest</span>
<span class="n">yt</span><span class="o">=</span><span class="n">Ytest</span>

<span class="n">gt</span><span class="o">=</span><span class="n">Xt</span> <span class="o">@</span> <span class="n">w</span>
<span class="n">Eout</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">gt</span><span class="o">-</span><span class="n">yt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Eout</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>51.97039279773035
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="More-On-Nonlinear-Transforms">More On Nonlinear Transforms<a class="anchor-link" href="#More-On-Nonlinear-Transforms">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">mplot3d</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-simple-transform-$\mathbb{R}^2$-to-$\mathbb{R}^2$">A simple transform $\mathbb{R}^2$ to $\mathbb{R}^2$<a class="anchor-link" href="#A-simple-transform-$\mathbb{R}^2$-to-$\mathbb{R}^2$">&#182;</a></h2><p>Let's consider the simple transformation below and visualize how different points transform from $\mathbf{X}$-space to $\mathbf{Z}$-space</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">transforma</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
    <span class="n">z1</span><span class="o">=</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">z2</span><span class="o">=</span><span class="n">x2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xp1</span><span class="p">,</span> <span class="n">xp2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">5</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">5</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">]</span>
<span class="n">xn1</span><span class="p">,</span> <span class="n">xn2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mf">4.75</span><span class="p">:</span> <span class="mf">5.25</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">5</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">]</span>

<span class="n">zp1</span><span class="p">,</span><span class="n">zp2</span><span class="o">=</span><span class="n">transforma</span><span class="p">(</span><span class="n">xp1</span><span class="p">,</span><span class="n">xp2</span><span class="p">)</span>
<span class="n">zn1</span><span class="p">,</span> <span class="n">zn2</span><span class="o">=</span><span class="n">transforma</span><span class="p">(</span><span class="n">xn1</span><span class="p">,</span><span class="n">xn2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp1</span><span class="p">,</span> <span class="n">xp2</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xn1</span><span class="p">,</span> <span class="n">xn2</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$-space&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zp1</span><span class="p">,</span> <span class="n">zp2</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zn1</span><span class="p">,</span> <span class="n">zn2</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$z_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{Z}</span><span class="s1">$-space&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[79]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;$\\mathbf{Z}$-space&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_159_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-simple-transform-$\mathbb{R}^2$-to-$\mathbb{R}^3$">A simple transform $\mathbb{R}^2$ to $\mathbb{R}^3$<a class="anchor-link" href="#A-simple-transform-$\mathbb{R}^2$-to-$\mathbb{R}^3$">&#182;</a></h2><p>Let's consider the simple transformation below and visualize how different points transform from $\mathbf{X}$-space to $\mathbf{Z}$-space</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">transformb</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
    <span class="n">z1</span><span class="o">=</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">z2</span><span class="o">=</span><span class="n">x2</span>
    <span class="n">z3</span><span class="o">=</span><span class="n">x1</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span> <span class="n">z3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xp1</span><span class="p">,</span> <span class="n">xp2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">5</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">5</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">]</span>
<span class="n">xn1</span><span class="p">,</span> <span class="n">xn2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mf">4.75</span><span class="p">:</span> <span class="mf">5.25</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">5</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">]</span>

<span class="n">zp1</span><span class="p">,</span><span class="n">zp2</span><span class="p">,</span> <span class="n">zp3</span><span class="o">=</span><span class="n">transformb</span><span class="p">(</span><span class="n">xp1</span><span class="p">,</span><span class="n">xp2</span><span class="p">)</span>
<span class="n">zn1</span><span class="p">,</span> <span class="n">zn2</span><span class="p">,</span> <span class="n">zn3</span><span class="o">=</span><span class="n">transformb</span><span class="p">(</span><span class="n">xn1</span><span class="p">,</span><span class="n">xn2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp1</span><span class="p">,</span> <span class="n">xp2</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xn1</span><span class="p">,</span> <span class="n">xn2</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$-space&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zp1</span><span class="p">,</span> <span class="n">zp2</span><span class="p">,</span> <span class="n">zp3</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zn1</span><span class="p">,</span> <span class="n">zn2</span><span class="p">,</span> <span class="n">zn3</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$z_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;$z_3$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{Z}</span><span class="s1">$-space&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[82]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 0.92, &#39;$\\mathbf{Z}$-space&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_163_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Some-classification-examples-in-$\mathbb{R}$">Some classification examples in $\mathbb{R}$<a class="anchor-link" href="#Some-classification-examples-in-$\mathbb{R}$">&#182;</a></h2><h3 id="Example-1">Example 1<a class="anchor-link" href="#Example-1">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">30</span>
<span class="n">xa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">-</span><span class="mi">5</span>
<span class="n">ya</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">xa</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xa</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$-space&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[83]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;$\\mathbf{X}$-space&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_165_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is clear that the data above is not linearly separable. Let's transform the data using the following transformation $T_2$
\begin{equation*}
T_2:\mathbb{R}\rightarrow\mathbb{R}^2
\end{equation*}
defined by
\begin{equation*}
z=T_2\left(x\right)=\left(x,x^2\right)
\end{equation*}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">transform2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">z1</span><span class="o">=</span><span class="n">x</span>
    <span class="n">z2</span><span class="o">=</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[85]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="o">=</span><span class="n">transform2</span><span class="p">(</span><span class="n">xa</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$-space&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z1</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z2</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z1</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z2</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{Z}</span><span class="s1">$-space&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[85]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;$\\mathbf{Z}$-space&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_168_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the $\mathbf{Z}$-space the data is linearly separable.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-2">Example 2<a class="anchor-link" href="#Example-2">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">30</span>
<span class="n">xa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">-</span><span class="mi">5</span>
<span class="n">ya1</span><span class="o">=</span><span class="p">(</span><span class="n">xa</span><span class="o">&lt;-</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ya2</span><span class="o">=</span><span class="p">(</span><span class="n">xa</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xa</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ya</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">ya1</span><span class="o">+</span><span class="n">ya2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$-space&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[86]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;$\\mathbf{X}$-space&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_171_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The data above is not linearly separable. Let's transform the data using the following transformation $T_2$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$-space&#39;</span><span class="p">)</span>

<span class="n">z1</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">transform2</span><span class="p">(</span><span class="n">xa</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z1</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z2</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z1</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z2</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{Z}</span><span class="s1">$-space&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[87]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;$\\mathbf{Z}$-space&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_173_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Even after using $T_2$ the data is still not linearly separable. Let's transform the data using a different transformation $T_3$ defined as
\begin{equation*}
T_3:\mathbb{R}\rightarrow\mathbb{R}^3
\end{equation*}
defined by
\begin{equation*}
z=T_3\left(x\right)=\left(x,x^2,x^3\right)
\end{equation*}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">transform3</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">z1</span><span class="o">=</span><span class="n">x</span>
    <span class="n">z2</span><span class="o">=</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">z3</span><span class="o">=</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">z3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">z3</span><span class="o">=</span><span class="n">transform3</span><span class="p">(</span><span class="n">xa</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$-space&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z1</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z2</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z3</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">z1</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z2</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z3</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$z_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;$z_3$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{Z}</span><span class="s1">$-space&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[90]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 0.92, &#39;$\\mathbf{Z}$-space&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_177_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this $\mathbf{Z}$-space the data is linearly separable.  To get a better view of it, let's rotate te plot.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">angle</span><span class="o">=</span><span class="mi">80</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[91]:</div>




<div class="output_png output_subarea output_execute_result">
<img src="output_179_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Note">Note<a class="anchor-link" href="#Note">&#182;</a></h4><p>You do not need to go to $\mathbb{R}^3$ to get the data to be linearly separable.  Indeed we can use the following transformation
\begin{equation*}
\tilde{T}:\mathbb{R}\rightarrow\mathbb{R}
\end{equation*}
defined by
\begin{equation*}
z=\tilde{T}\left(x\right)=\left(x+1\right)\left(x^2-9\right)
\end{equation*}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">xa</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{X}</span><span class="s1">$-space&#39;</span><span class="p">)</span>

<span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">xa</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xa</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">9</span><span class="p">);</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="n">ya</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="n">ya</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathbf</span><span class="si">{Z}</span><span class="s1">$-space&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[92]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;$\\mathbf{Z}$-space&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_181_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that in this $\mathbf{Z}$-space the data is linearly separable. However we <em>cheated</em> because we guessed the right transformation by looking at the data.  We will learn later in the class why this is a <strong>bad</strong> idea.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Theory-of-Generalization;-Training-and-Testing-using-Heart-Failure-Dataset">Theory of Generalization; Training and Testing using Heart Failure Dataset<a class="anchor-link" href="#Theory-of-Generalization;-Training-and-Testing-using-Heart-Failure-Dataset">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">naive_bayes</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Heart Failure Dataset</strong></p>
<blockquote><p><a href="https://archive.ics.uci.edu/ml/datasets/Heart+failure+clinical+records">https://archive.ics.uci.edu/ml/datasets/Heart+failure+clinical+records</a></p>
<p>Thirteen (13) clinical features:</p>
<ul>
<li>age: age of the patient (years)</li>
<li>anaemia: decrease of red blood cells or hemoglobin (boolean)</li>
<li>high blood pressure: if the patient has hypertension (boolean)</li>
<li>creatinine phosphokinase (CPK): level of the CPK enzyme in the blood (mcg/L)</li>
<li>diabetes: if the patient has diabetes (boolean)</li>
<li>ejection fraction: percentage of blood leaving the heart at each contraction (percentage)</li>
<li>platelets: platelets in the blood (kiloplatelets/mL)</li>
<li>sex: woman or man (binary)</li>
<li>serum creatinine: level of serum creatinine in the blood (mg/dL)</li>
<li>serum sodium: level of serum sodium in the blood (mEq/L)</li>
<li>smoking: if the patient smokes or not (boolean)</li>
<li>time: follow-up period (days)</li>
<li>[target] death event: if the patient deceased during the follow-up period (boolean)</li>
</ul>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="data:image/png;base64,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" alt="image.png"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[94]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Heart Failure</span><span class="se">\\</span><span class="s2">heart_failure_clinical_records_dataset.csv&quot;</span>
<span class="n">hfd</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">Y_hfd</span><span class="o">=</span><span class="n">hfd</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">X_hfd</span><span class="o">=</span><span class="n">hfd</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_hfd</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 2 ata entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_hfd</span><span class="p">[:</span><span class="mi">2</span><span class="p">:])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All labels :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_hfd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (299, 12) 

The first 2 ata entries : 
[[7.5000000e+01 0.0000000e+00 5.8200000e+02 0.0000000e+00 2.0000000e+01
  1.0000000e+00 2.6500000e+05 1.9000000e+00 1.3000000e+02 1.0000000e+00
  0.0000000e+00 4.0000000e+00]
 [5.5000000e+01 0.0000000e+00 7.8610000e+03 0.0000000e+00 3.8000000e+01
  0.0000000e+00 2.6335803e+05 1.1000000e+00 1.3600000e+02 1.0000000e+00
  0.0000000e+00 6.0000000e+00]]
All labels :
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1. 0. 1. 1. 0.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1. 0. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 1. 1. 1. 1. 0. 1. 0. 1. 1. 1. 1. 1. 0. 0.
 1. 0. 1. 1. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 1. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 1.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0.
 0. 0. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0.
 0. 1. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.
 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training,-Testing-and-Generalization-Bounds">Training, Testing and Generalization Bounds<a class="anchor-link" href="#Training,-Testing-and-Generalization-Bounds">&#182;</a></h2><blockquote><p>Using Naive Bayes</p>
<ol>
<li>Split the data 50/50 between training and testing</li>
<li>Estimate $E_{out}-E_{in}$ </li>
<li>Repeat T times 1. and 2. to get a distribution of  $E_{out}-E_{in}$</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">T</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">e_in</span><span class="o">=</span><span class="p">[]</span>
<span class="n">e_out</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X_hfd</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">Y_hfd</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">nb</span><span class="o">=</span><span class="n">naive_bayes</span><span class="o">.</span><span class="n">GaussianNB</span><span class="p">()</span>            
    <span class="n">nb_fit</span><span class="o">=</span><span class="n">nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>           
    <span class="n">gtrain</span><span class="o">=</span><span class="n">nb_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
    <span class="n">gtest</span><span class="o">=</span><span class="n">nb_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>

    <span class="n">e_in</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtrain</span><span class="o">!=</span><span class="n">Ytrain</span><span class="p">))</span>
    <span class="n">e_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtest</span><span class="o">!=</span><span class="n">Ytest</span><span class="p">))</span>

<span class="n">e_in</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">e_in</span><span class="p">)</span>
<span class="n">e_out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">e_out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[96]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e_in</span><span class="p">,</span> <span class="n">e_out</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$e_</span><span class="si">{in}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$e_</span><span class="si">{out}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{in}</span><span class="s1">$ vs $E_</span><span class="si">{out}</span><span class="s1">$ for Different 50/50 Splits&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_191_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[97]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">delta_e</span><span class="o">=</span><span class="n">e_out</span><span class="o">-</span><span class="n">e_in</span>

<span class="n">f3</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">delta_e</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distribution of $E_</span><span class="si">{out}</span><span class="s2">-E_</span><span class="si">{in}</span><span class="s2">$ for Different 50/50 Splits&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$E_</span><span class="si">{out}</span><span class="s2">-E_</span><span class="si">{in}</span><span class="s2">$&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[97]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 0, &#39;$E_{out}-E_{in}$&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_192_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[98]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eps</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">e_out</span><span class="o">-</span><span class="n">e_in</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>
<span class="n">prob</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="n">n</span>
<span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$e_</span><span class="si">{out}</span><span class="s1">-e_</span><span class="si">{in}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{out}</span><span class="s1">-E_</span><span class="si">{in}</span><span class="s1">$ for Different 50/50 Splits&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mf">1.1</span><span class="p">:</span><span class="o">.</span><span class="mi">1</span><span class="p">],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="mf">0.05</span><span class="p">:</span><span class="mf">1.1</span><span class="p">:</span><span class="o">.</span><span class="mi">1</span><span class="p">],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_193_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Effect-of-Training-Data-Size-on-$E_{in}$-and-$E_{out}$">Effect of Training Data Size on $E_{in}$ and $E_{out}$<a class="anchor-link" href="#Effect-of-Training-Data-Size-on-$E_{in}$-and-$E_{out}$">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[99]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">aa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="mf">0.9</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mf">0.1</span><span class="p">]</span>
<span class="n">T</span><span class="o">=</span><span class="mi">10000</span> <span class="c1">#number of tries for each alpha</span>

<span class="n">Ein</span><span class="o">=</span><span class="p">[]</span>
<span class="n">Eout</span><span class="o">=</span><span class="p">[]</span>

<span class="n">sEin</span><span class="o">=</span><span class="p">[]</span>
<span class="n">sEout</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">aa</span><span class="p">:</span>

    <span class="n">e_in</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">e_out</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
        <span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X_hfd</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">Y_hfd</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">nb</span><span class="o">=</span><span class="n">naive_bayes</span><span class="o">.</span><span class="n">GaussianNB</span><span class="p">()</span>            
        <span class="n">nb_fit</span><span class="o">=</span><span class="n">nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>           
        <span class="n">gtrain</span><span class="o">=</span><span class="n">nb_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
        <span class="n">gtest</span><span class="o">=</span><span class="n">nb_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>

        <span class="n">e_in</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtrain</span><span class="o">!=</span><span class="n">Ytrain</span><span class="p">))</span>
        <span class="n">e_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtest</span><span class="o">!=</span><span class="n">Ytest</span><span class="p">))</span>
    <span class="n">Ein</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">e_in</span><span class="p">))</span>
    <span class="n">Eout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">e_out</span><span class="p">))</span>
    <span class="n">sEin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">e_in</span><span class="p">))</span>
    <span class="n">sEout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">e_out</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[100]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vv</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">aa</span><span class="p">)</span><span class="o">*</span><span class="mi">299</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="n">Ein</span><span class="p">,</span><span class="s1">&#39;-b*&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="n">Eout</span><span class="p">,</span><span class="s1">&#39;-r*&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Training Set Size&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error Rate&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Ein&#39;</span><span class="p">,</span> <span class="s1">&#39;Eout&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_196_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="VC-Dimension">VC Dimension<a class="anchor-link" href="#VC-Dimension">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The VC inequality
\begin{equation*}
\mathbb{P}\left[ \left|E_{in}\left(g\right)-E_{out}\left(g\right)\right|&gt;\epsilon\right]\leq 4 m_{\mathcal{H}}\left(2N\right)e^{-\frac{1}{8}\epsilon^2N}
\end{equation*}</p>
<p>Let's define</p>
\begin{equation*}
\begin{matrix}
\delta= 4 m_{\mathcal{H}}\left(2N\right)e^{-\frac{1}{8}\epsilon^2N} &amp; \implies &amp; \epsilon=\sqrt{\frac{8}{N}\text{ln}\frac{4 m_{\mathcal{H}}\left(2N\right)}{\delta}} \\
\end{matrix}
\end{equation*}<p>and</p>
\begin{equation*}
\Omega\left(N,\mathcal{H},\delta\right)=\sqrt{\frac{8}{N}\text{ln}\frac{4 m_{\mathcal{H}}\left(2N\right)}{\delta}} 
\end{equation*}<p>Then the VC inequality transforms to: <br></p>
<blockquote><p>with probability  $\geq 1-\delta$, 
\begin{equation*}
 \left|E_{in}\left(g\right)-E_{out}\left(g\right)\right| \leq \Omega\left(N,\mathcal{H},\delta\right) 
 \end{equation*}</p>
</blockquote>
<p><br><br><br>
i.e., with probability $\geq1-\delta$,
\begin{equation*}
E_{out} \leq E_{in} + \Omega
\end{equation*}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Generalization bound $\Omega$</p>
<ol>
<li>Gets smaller for larger training set size $N$</li>
<li>Gets larger for larger VC dimension (more complex $\mathcal{H}$)</li>
</ol>
<p><em>Next we illustrate the effect of $N$ and $d_{VC}$ on the generalization bound $\Omega$ using the handwritten digits dataset.</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[101]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">linear_model</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Handwritten-Digits">Handwritten Digits<a class="anchor-link" href="#Handwritten-Digits">&#182;</a></h2><blockquote><p>The dataset used in the video lectures.<br>
Normalized handwritten digits, automatically scanned from envelopes by the U.S. Postal Service. The original
scanned digits are binary and of different sizes and orientations; the images  here have been deslanted and size normalized, resulting in 16 x 16 grayscale images (Le Cun et al., 1990).</p>
</blockquote>
<p><strong>Load the dataset</strong></p>
<blockquote><p>We are only going to use only two of the digits (to see if we can distinguish between the two of them)</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[102]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfilename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Handwritten Digits</span><span class="se">\\</span><span class="s2">zip.train&quot;</span>
<span class="n">digit_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">tfilename</span><span class="p">)</span> 
<span class="n">Y_dig</span><span class="o">=</span><span class="n">digit_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X_dig</span><span class="o">=</span><span class="n">digit_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> 

<span class="n">dig1</span><span class="o">=</span><span class="mi">2</span>
<span class="n">dig2</span><span class="o">=</span><span class="mi">5</span>

<span class="n">Yfilter</span><span class="o">=</span><span class="p">(</span><span class="n">Y_dig</span><span class="o">==</span><span class="n">dig1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">Y_dig</span><span class="o">==</span><span class="n">dig2</span><span class="p">)</span>

<span class="n">Input</span><span class="o">=</span><span class="n">X_dig</span><span class="p">[</span><span class="n">Yfilter</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">Output</span><span class="o">=</span><span class="n">Y_dig</span><span class="p">[</span><span class="n">Yfilter</span><span class="p">]</span>
<span class="n">Output</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Output</span><span class="o">==</span><span class="n">dig1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Effect-of-$N$-on--$\Omega$">Effect of $N$ on  $\Omega$<a class="anchor-link" href="#Effect-of-$N$-on--$\Omega$">&#182;</a></h2><p><strong>Using the Perceptron Learning Model</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="One-Run-with-a-50/50-Split-(Train/Test)">One Run with a 50/50 Split (Train/Test)<a class="anchor-link" href="#One-Run-with-a-50/50-Split-(Train/Test)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[103]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">pmodel</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">Perceptron</span><span class="p">()</span>
<span class="n">pmodel_fit</span><span class="o">=</span><span class="n">pmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
<span class="n">gtrain</span><span class="o">=</span><span class="n">pmodel_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
<span class="n">gtest</span><span class="o">=</span><span class="n">pmodel_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
<span class="n">e_in</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtrain</span><span class="o">!=</span><span class="n">Ytrain</span><span class="p">)</span>
<span class="n">e_out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtest</span><span class="o">!=</span><span class="n">Ytest</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ein = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">e_in</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eout = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">e_out</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Ein = 0.00 %
Eout = 1.40 %
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[104]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#visualizing the first 30 images of the test set</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xtest</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">gtest</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xtest</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">gtest</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_207_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multiple-Runs-at-Different-Splits">Multiple Runs at Different Splits<a class="anchor-link" href="#Multiple-Runs-at-Different-Splits">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">T</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">aa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="n">Ein</span><span class="o">=</span><span class="p">[]</span>
<span class="n">Eout</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">aa</span><span class="p">:</span>
    <span class="n">e_in</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">e_out</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
        <span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">pmodel</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">Perceptron</span><span class="p">()</span>
        <span class="n">pmodel_fit</span><span class="o">=</span><span class="n">pmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
        <span class="n">gtrain</span><span class="o">=</span><span class="n">pmodel_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
        <span class="n">gtest</span><span class="o">=</span><span class="n">pmodel_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>

        <span class="n">e_in</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtrain</span><span class="o">!=</span><span class="n">Ytrain</span><span class="p">))</span>
        <span class="n">e_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtest</span><span class="o">!=</span><span class="n">Ytest</span><span class="p">))</span>

    <span class="n">Ein</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">e_in</span><span class="p">))</span>
    <span class="n">Eout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">e_out</span><span class="p">))</span>

<span class="n">Ein</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ein</span><span class="p">)</span>
<span class="n">Eout</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Eout</span><span class="p">)</span>
<span class="n">Omega</span><span class="o">=</span><span class="n">Eout</span><span class="o">-</span><span class="n">Ein</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[106]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">N</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">aa</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">Ein</span><span class="p">,</span> <span class="s1">&#39;-k*&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">aa</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">Eout</span><span class="p">,</span> <span class="s1">&#39;-b*&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">aa</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">Omega</span><span class="p">,</span> <span class="s1">&#39;-r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$E_</span><span class="si">{in}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$E_</span><span class="si">{out}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$\Omega$&quot;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Effect of Training Size on the Generalization Bound&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[106]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;Effect of Training Size on the Generalization Bound&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_210_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Effect-of-$d_{VC}$-on--$\Omega$">Effect of $d_{VC}$ on  $\Omega$<a class="anchor-link" href="#Effect-of-$d_{VC}$-on--$\Omega$">&#182;</a></h2><p><strong>Using the Perceptron Learning Model</strong></p>
<ul>
<li>$d_{VC}=257$ for the perceptron model used above.</li>
<li>We are going to extract two features from the data (the average pixel intensity and the <em>symmetry</em>) and use the perceptron in the new space. The VC dimension of the perceptron in the new space is 3.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Transform the Data to Make it 2 Dimensional</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[107]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fsTransform</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">z</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">z</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">[:,:</span><span class="mi">128</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="mi">128</span><span class="p">:],</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">z</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[108]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">T</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">e_in</span><span class="o">=</span><span class="p">[]</span>
<span class="n">e_out</span><span class="o">=</span><span class="p">[]</span>
<span class="n">ez_in</span><span class="o">=</span><span class="p">[]</span>
<span class="n">ez_out</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">pmodel</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">Perceptron</span><span class="p">()</span>
    <span class="n">pmodel_fit</span><span class="o">=</span><span class="n">pmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
    <span class="n">gtrain</span><span class="o">=</span><span class="n">pmodel_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
    <span class="n">gtest</span><span class="o">=</span><span class="n">pmodel_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>

    <span class="n">e_in</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtrain</span><span class="o">!=</span><span class="n">Ytrain</span><span class="p">))</span>
    <span class="n">e_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtest</span><span class="o">!=</span><span class="n">Ytest</span><span class="p">))</span>

    <span class="n">Ztrain</span><span class="o">=</span><span class="n">fsTransform</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
    <span class="n">Ztest</span><span class="o">=</span><span class="n">fsTransform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
    <span class="n">pmodelZ</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">Perceptron</span><span class="p">()</span>
    <span class="n">pmodelZ_fit</span><span class="o">=</span><span class="n">pmodelZ</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Ztrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
    <span class="n">gZtrain</span><span class="o">=</span><span class="n">pmodelZ_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Ztrain</span><span class="p">)</span>
    <span class="n">gZtest</span><span class="o">=</span><span class="n">pmodelZ_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Ztest</span><span class="p">)</span>

    <span class="n">ez_in</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gZtrain</span><span class="o">!=</span><span class="n">Ytrain</span><span class="p">))</span>
    <span class="n">ez_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gZtest</span><span class="o">!=</span><span class="n">Ytest</span><span class="p">))</span>

<span class="n">e_in</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">e_in</span><span class="p">)</span>
<span class="n">e_out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">e_out</span><span class="p">)</span>
<span class="n">ez_in</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ez_in</span><span class="p">)</span>
<span class="n">ez_out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ez_out</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ein = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">e_in</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eout = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">e_out</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-space Ein = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ez_in</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Z-space Eout = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ez_out</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Ein = 0.03 %
Eout = 2.42 %
Z-space Ein = 26.99 %
Z-space Eout = 27.11 %
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's plot the last classifier</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">w</span><span class="o">=</span><span class="n">pmodelZ</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W : &quot;</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="n">b</span><span class="o">=</span><span class="n">pmodelZ</span><span class="o">.</span><span class="n">intercept_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b : &quot;</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ft</span><span class="o">=-</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">a1</span><span class="o">=</span><span class="n">Ztest</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">a2</span><span class="o">=</span><span class="n">Ztest</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a1</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span><span class="n">a2</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a1</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span><span class="n">a2</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">ft</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_1$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$z_2$&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>W :  [-0.13954688 -3.89084375]
b :  -1.0
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[109]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;$z_2$&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_216_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="$\Omega$-Dependance-on-$N$-in-the-New-Space">$\Omega$ Dependance on $N$ in the New Space<a class="anchor-link" href="#$\Omega$-Dependance-on-$N$-in-the-New-Space">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[110]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">T</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">aa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="n">zEin</span><span class="o">=</span><span class="p">[]</span>
<span class="n">zEout</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">aa</span><span class="p">:</span>
    <span class="n">e_in</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">e_out</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
        <span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">Ztrain</span><span class="o">=</span><span class="n">fsTransform</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
        <span class="n">Ztest</span><span class="o">=</span><span class="n">fsTransform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
        <span class="n">pmodel</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">Perceptron</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
        <span class="n">pmodel_fit</span><span class="o">=</span><span class="n">pmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Ztrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
        <span class="n">gtrain</span><span class="o">=</span><span class="n">pmodel_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Ztrain</span><span class="p">)</span>
        <span class="n">gtest</span><span class="o">=</span><span class="n">pmodel_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Ztest</span><span class="p">)</span>

        <span class="n">e_in</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtrain</span><span class="o">!=</span><span class="n">Ytrain</span><span class="p">))</span>
        <span class="n">e_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtest</span><span class="o">!=</span><span class="n">Ytest</span><span class="p">))</span>

    <span class="n">zEin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">e_in</span><span class="p">))</span>
    <span class="n">zEout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">e_out</span><span class="p">))</span>

<span class="n">zEin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zEin</span><span class="p">)</span>
<span class="n">zEout</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zEout</span><span class="p">)</span>
<span class="n">zOmega</span><span class="o">=</span><span class="n">zEout</span><span class="o">-</span><span class="n">zEin</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[111]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">N</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">aa</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">zEin</span><span class="p">,</span> <span class="s1">&#39;-k*&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">aa</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">zEout</span><span class="p">,</span> <span class="s1">&#39;-b*&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$E_</span><span class="si">{in}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="s2">&quot;$E_</span><span class="si">{out}</span><span class="s2">$&quot;</span><span class="p">])</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Error in the Transformed Space&quot;</span><span class="p">)</span>


<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">aa</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">zOmega</span><span class="p">,</span> <span class="s1">&#39;-r*&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\Omega$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Generalization Bound as a Function of N&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[111]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;Generalization Bound as a Function of N&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_219_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Bias-Variance-Decomposition">Bias Variance Decomposition<a class="anchor-link" href="#Bias-Variance-Decomposition">&#182;</a></h1>\begin{equation*}
\begin{matrix}
\textbf{bias} &amp; = &amp; \mathbb{E}_{x}\left[\left(\bar{g}\left(x\right)-f\left(x\right)\right)^2\right]\\
\textbf{var} &amp; = &amp; \mathbb{E}_{x}\left[\mathbb{E}_{\mathcal{D}}\left[\left(g^{\left(\mathcal{D}\right)}\left(x\right)-\bar{g}\left(x\right)\right)^2\right]\right]\\
\end{matrix}
\end{equation*}
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[112]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">linear_model</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Simple-Example">A Simple Example<a class="anchor-link" href="#A-Simple-Example">&#182;</a></h2><p>Let's look at the example discussed in the lectures and solve it exactly.<br></p>
<ul>
<li><p>Target function: 
\begin{equation*}
f(x)=sin(\pi x), x\in[-1,1] 
\end{equation*}</p>
</li>
<li><p>N=2 (two training points available)</p>
</li>
<li>Two hypotheses sets: 
\begin{equation*}
\begin{matrix}
\mathcal{H}_0: &amp; h(x) =b   \\
\mathcal{H}_1: &amp; h(x) =ax+b  \\ 
\end{matrix}
\end{equation*}</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Generate a test set</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[113]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ntest</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">Xtest</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">Ntest</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Xtest</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">Ytest</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Xtest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="One-2-point-dataset">One 2-point dataset<a class="anchor-link" href="#One-2-point-dataset">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[114]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Generate training set</span>
<span class="n">Ntrain</span><span class="o">=</span><span class="mi">2</span>
<span class="n">Xtrain</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">Ntrain</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Ytrain</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Xtrain</span><span class="p">)</span>

<span class="c1">#H0, h(x)=b0</span>
<span class="c1">#Get b0 using LR</span>
<span class="n">X0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">Ntrain</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span><span class="n">Ytrain</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">b0</span><span class="o">=</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">#H1, h(x)=a1 x + b1</span>
<span class="c1">#Get a1,b1 using LR</span>
<span class="n">X1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">Ntrain</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">X1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">Xtrain</span>
<span class="n">sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Ytrain</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">b1</span><span class="p">,</span> <span class="n">a1</span><span class="o">=</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="n">b0</span><span class="p">,</span><span class="n">b0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="p">,</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">,</span><span class="n">Ytest</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span><span class="n">Ytrain</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span>  <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;g(x)=b&quot;</span><span class="p">,</span><span class="s2">&quot;g(x)=ax+b&quot;</span><span class="p">,</span> <span class="s2">&quot;target function&quot;</span><span class="p">,</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_227_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Several-2-point-Datasets">Several 2-point Datasets<a class="anchor-link" href="#Several-2-point-Datasets">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[115]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">P</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="n">abar</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">bbar</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
    <span class="c1">#Generate training set</span>
    <span class="n">Ntrain</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">Xtrain</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">Ntrain</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">Ytrain</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Xtrain</span><span class="p">)</span>

    <span class="c1">#H0, h(x)=b0</span>
    <span class="c1">#Get b0 using LR</span>
    <span class="n">X0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">Ntrain</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span><span class="n">Ytrain</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">b0</span><span class="o">=</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1">#H0, h(x)=a1 x + b1</span>
    <span class="c1">#Get a1,b1 using LR</span>
    <span class="n">X1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">Ntrain</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">X1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">Xtrain</span>
    <span class="n">sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Ytrain</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">b1</span><span class="p">,</span> <span class="n">a1</span><span class="o">=</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">abar</span><span class="o">=</span><span class="n">abar</span><span class="o">+</span><span class="n">a1</span><span class="p">;</span>
    <span class="n">bbar</span><span class="o">=</span><span class="n">bbar</span><span class="o">+</span><span class="n">b1</span><span class="p">;</span>
    <span class="c1">#plot</span>
 
    <span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="n">b0</span><span class="p">,</span><span class="n">b0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">,</span><span class="n">Ytest</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;h(x)=b&quot;</span><span class="p">,</span> <span class="s2">&quot;target function&quot;</span><span class="p">])</span>
        <span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span><span class="n">Ytrain</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

    
    <span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="p">,</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">,</span><span class="n">Ytest</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;h(x)=ax+b&quot;</span><span class="p">,</span> <span class="s2">&quot;target function&quot;</span><span class="p">])</span>
        <span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span><span class="n">Ytrain</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_229_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bias-Variance-Decomposition">Bias Variance Decomposition<a class="anchor-link" href="#Bias-Variance-Decomposition">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Recall</strong></p>
<ul>
<li><p>Target function: 
\begin{equation*}
f(x)=sin(\pi x), x\in[-1,1] 
\end{equation*}</p>
</li>
<li><p>N=2 (two training points available)</p>
</li>
<li>Two hypotheses sets: 
\begin{equation*}
\begin{matrix}
\mathcal{H}_0: &amp; h(x) =b   \\
\mathcal{H}_1: &amp; h(x) =ax+b  \\ 
\end{matrix}
\end{equation*}</li>
</ul>
\begin{equation*}
\begin{matrix}
\textbf{bias} &amp; = &amp; \mathbb{E}_{x}\left[\left(\bar{g}\left(x\right)-f\left(x\right)\right)^2\right]\\
\textbf{var} &amp; = &amp; \mathbb{E}_{x}\left[\mathbb{E}_{\mathcal{D}}\left[\left(g^{\left(\mathcal{D}\right)}\left(x\right)-\bar{g}\left(x\right)\right)^2\right]\right]\\
\end{matrix}
\end{equation*}<p><strong>Here is an outline of the process</strong><br>
For any hypothesis set $\mathcal{H}$ and some number of iterations $T$</p>
<ol>
<li>Generate a large enough test set $\mathcal{X}_{test}$</li>
<li>For $k$ in range($T$):<blockquote><ul>
<li>Generate a set $\mathcal{D}^{\left(k\right)}$ composed of 2 points</li>
<li>Pick the hypothesis $g^{\left(k\right)}$ from  $\mathcal{H}$ that best fits the data $\mathcal{D}^{\left(k\right)}$</li>
<li>For all $x\in\mathcal{X}_{test}$, calculate $g^{\left(k\right)}\left(x\right)$ </li>
</ul>
</blockquote>
</li>
<li>For all $x\in\mathcal{X}_{test}$, calculate $\bar{g}\left(x\right)$ as the average over all $g^{\left(k\right)}\left(x\right)$ </li>
<li>Calculate the <strong>bias</strong> and <strong>variance</strong> using the formulas above.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Note</strong><br>
In general, given two points $(x_1,y_1)$ and $(x_2,y_2)$,</p>
<ul>
<li>The best constant fit is given by $g(x)=b_0$ where $b_0=\frac{y_1+y_2}{2}$     </li>
<li>The best linear fit is given by $g(x)=b_1+a_1x$ where $a_1=\frac{y_1-y_2}{x_1-x_2}$,  $b_1=\frac{x_1y_2-x_2y_1}{x_1-x_2}$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[116]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Generate N=100000 datasets of size 2</span>
<span class="n">N</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">Xtt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Ytt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Xtt</span><span class="p">)</span>

<span class="c1">#calculate b0 for each dataset</span>
<span class="n">bb0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Ytt</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b0bar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bb0</span><span class="p">)</span>

<span class="n">err0</span><span class="o">=</span><span class="mi">0</span>
<span class="n">var0</span><span class="o">=</span><span class="mi">0</span>
<span class="n">bias0</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">err0</span><span class="o">=</span><span class="n">err0</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">Ytest</span><span class="o">-</span><span class="n">bb0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">var0</span><span class="o">=</span><span class="n">var0</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">b0bar</span><span class="o">-</span><span class="n">bb0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">bias0</span><span class="o">=</span><span class="n">bias0</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">b0bar</span><span class="o">-</span><span class="n">Ytest</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    
<span class="n">err0</span><span class="o">=</span><span class="n">err0</span><span class="o">/</span><span class="n">N</span>
<span class="n">var0</span><span class="o">=</span><span class="n">var0</span><span class="o">/</span><span class="n">N</span>
<span class="n">bias0</span><span class="o">=</span><span class="n">bias0</span><span class="o">/</span><span class="n">N</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hypothesis Set H0&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error    : </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">err0</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variance : </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">var0</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bias     : </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">bias0</span>)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Hypothesis Set H0
Error    : 0.746
Variance : 0.250
Bias     : 0.495
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[117]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#calculate a1, b1 for each dataset</span>
<span class="n">Y1</span><span class="o">=</span><span class="n">Ytt</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Y2</span><span class="o">=</span><span class="n">Ytt</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">X1</span><span class="o">=</span><span class="n">Xtt</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X2</span><span class="o">=</span><span class="n">Xtt</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">aa1</span><span class="o">=</span><span class="p">(</span><span class="n">Y1</span><span class="o">-</span><span class="n">Y2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">X1</span><span class="o">-</span><span class="n">X2</span><span class="p">)</span>
<span class="n">bb1</span><span class="o">=</span><span class="p">(</span><span class="n">X1</span><span class="o">*</span><span class="n">Y2</span><span class="o">-</span><span class="n">X2</span><span class="o">*</span><span class="n">Y1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">X1</span><span class="o">-</span><span class="n">X2</span><span class="p">)</span>


<span class="n">a1bar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">aa1</span><span class="p">)</span>
<span class="n">b1bar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bb1</span><span class="p">)</span>

<span class="n">err1</span><span class="o">=</span><span class="mi">0</span>
<span class="n">var1</span><span class="o">=</span><span class="mi">0</span>
<span class="n">bias1</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">h1</span><span class="o">=</span><span class="n">bb1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">aa1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">Xtest</span>
    <span class="n">h1bar</span><span class="o">=</span><span class="n">b1bar</span><span class="o">+</span><span class="n">a1bar</span><span class="o">*</span><span class="n">Xtest</span>
    <span class="n">err1</span><span class="o">=</span><span class="n">err1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">Ytest</span><span class="o">-</span><span class="n">h1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">var1</span><span class="o">=</span><span class="n">var1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">h1bar</span><span class="o">-</span><span class="n">h1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">bias1</span><span class="o">=</span><span class="n">bias1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">h1bar</span><span class="o">-</span><span class="n">Ytest</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    
<span class="n">err1</span><span class="o">=</span><span class="n">err1</span><span class="o">/</span><span class="n">N</span>
<span class="n">var1</span><span class="o">=</span><span class="n">var1</span><span class="o">/</span><span class="n">N</span>
<span class="n">bias1</span><span class="o">=</span><span class="n">bias1</span><span class="o">/</span><span class="n">N</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hypothesis Set H1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error    : </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">err1</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variance : </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">var1</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bias     : </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">bias1</span>)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Hypothesis Set H1
Error    : 1.904
Variance : 1.698
Bias     : 0.207
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[118]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="n">b0bar</span><span class="p">,</span><span class="n">b0bar</span><span class="p">],</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="n">a1bar</span><span class="o">+</span><span class="n">b1bar</span><span class="p">,</span><span class="n">a1bar</span><span class="o">+</span><span class="n">b1bar</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">,</span><span class="n">Ytest</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$\~g_0(x)=b$&quot;</span><span class="p">,</span><span class="s2">&quot;$\~g_1(x)=ax+b$&quot;</span><span class="p">,</span> <span class="s2">&quot;target function&quot;</span><span class="p">])</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>

<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="n">b0bar</span><span class="p">,</span><span class="n">b0bar</span><span class="p">],</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtt</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">Ytt</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="s1">&#39;k*&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">bb0</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$\~g_0(x)=b$&quot;</span><span class="p">,</span> <span class="s2">&quot;dataset&quot;</span><span class="p">,</span><span class="s2">&quot;g(x)&quot;</span> <span class="p">])</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">,</span><span class="n">Ytest</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>

<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="n">a1bar</span><span class="o">+</span><span class="n">b1bar</span><span class="p">,</span><span class="n">a1bar</span><span class="o">+</span><span class="n">b1bar</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtt</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">Ytt</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="s1">&#39;k*&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="n">aa1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">bb1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">aa1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">bb1</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$\~g_1(x)=ax+b$&quot;</span><span class="p">,</span> <span class="s2">&quot;dataset&quot;</span><span class="p">,</span> <span class="s2">&quot;g(x)&quot;</span><span class="p">])</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">,</span><span class="n">Ytest</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_235_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-the-Diabetes-Dataset">Using the Diabetes Dataset<a class="anchor-link" href="#Using-the-Diabetes-Dataset">&#182;</a></h2><blockquote><p>Regression dataset <br>
target : a quantitative measure of disease progression one year after baseline</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[119]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">diabetes</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_diabetes</span><span class="p">()</span>

<span class="n">Y_dia</span><span class="o">=</span><span class="n">diabetes</span><span class="o">.</span><span class="n">target</span>
<span class="n">X_dia</span><span class="o">=</span><span class="n">diabetes</span><span class="o">.</span><span class="n">data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_dia</span><span class="p">),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Names :&quot;</span><span class="p">,</span> <span class="n">diabetes</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 2 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_dia</span><span class="p">[:</span><span class="mi">2</span><span class="p">,:])</span>

<span class="c1">#print(&quot;Categories : &quot;, diabetes.target_names)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 2 target values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_dia</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (442, 10) 

Feature Names : [&#39;age&#39;, &#39;sex&#39;, &#39;bmi&#39;, &#39;bp&#39;, &#39;s1&#39;, &#39;s2&#39;, &#39;s3&#39;, &#39;s4&#39;, &#39;s5&#39;, &#39;s6&#39;]
The first 2 data entries : 
[[ 0.03807591  0.05068012  0.06169621  0.02187235 -0.0442235  -0.03482076
  -0.04340085 -0.00259226  0.01990842 -0.01764613]
 [-0.00188202 -0.04464164 -0.05147406 -0.02632783 -0.00844872 -0.01916334
   0.07441156 -0.03949338 -0.06832974 -0.09220405]]
First 2 target values:
[151.  75.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Recall</strong></p>
\begin{equation*}
\begin{matrix}
\textbf{bias} &amp; = &amp; \mathbb{E}_{x}\left[\left(\bar{g}\left(x\right)-f\left(x\right)\right)^2\right]\\
\textbf{var} &amp; = &amp; \mathbb{E}_{x}\left[\mathbb{E}_{\mathcal{D}}\left[\left(g^{\left(\mathcal{D}\right)}\left(x\right)-\bar{g}\left(x\right)\right)^2\right]\right]\\
\end{matrix}
\end{equation*}<ul>
<li>To get an estimation of $\mathbb{E}_x$, we are going to preserve <strong>20%</strong> of the data as a test set to average over</li>
<li>Assume our dataset is of about size 106, i.e., $\left|\mathcal{D}\right|=106$</li>
<li>To get an estimation of $\mathbb{E}_\mathcal{D}$, we are going to randomly generate $\mathcal{D}$ by picking 30% of the training data.  Repeating the process multiple times and average.<blockquote><p>The approach is ok as long as the set of training data is large enough.  If it is not, the estimate of $\bar{g}$ could be off by a lot. To get a better estimate we would need a much bigger training set to pick from, but we have to make due with what we have.</p>
</blockquote>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Here is an outline of the process</strong><br>
For any hypothesis set $\mathcal{H}$ and some number of iterations $T$</p>
<ol>
<li>Set aside 20% of the data. Call this set $\mathcal{X}_{test}$ and  the remaining points form set $\mathcal{X}$</li>
<li>For $k$ in range($T$):<blockquote><ul>
<li>Generate a set $\mathcal{D}^{\left(k\right)}$ randomly picking 30% of the points in $\mathcal{X}$</li>
<li>Pick the hypothesis $g^{\left(k\right)}$ from  $\mathcal{H}$ that best fits the data $\mathcal{D}^{\left(k\right)}$</li>
<li>For all $x\in\mathcal{X}_{test}$, calculate $g^{\left(k\right)}\left(x\right)$ </li>
</ul>
</blockquote>
</li>
<li>For all $x\in\mathcal{X}_{test}$, calculate $\bar{g}\left(x\right)$ as the average over all $g^{\left(k\right)}\left(x\right)$ </li>
<li>Calculate the <strong>bias</strong> and <strong>variance</strong> using the formulas above.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[120]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">Xsp</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ysp</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">]</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">diabetes</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">diabetes</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
<span class="n">T</span><span class="o">=</span><span class="mi">10000</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Hypothesis-set-$\mathcal{H}_0$,-constant-functions">Hypothesis set $\mathcal{H}_0$, constant functions<a class="anchor-link" href="#Hypothesis-set-$\mathcal{H}_0$,-constant-functions">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[121]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gg0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="p">[</span><span class="n">Dx</span><span class="p">,</span> <span class="n">xx</span> <span class="p">,</span> <span class="n">Dy</span><span class="p">,</span>  <span class="n">yy</span><span class="p">]</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">Xsp</span><span class="p">,</span> <span class="n">Ysp</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">gg0</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Dy</span><span class="p">)</span>
<span class="n">gbar0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gg0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 

<span class="n">bias0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">Ytest</span><span class="o">-</span><span class="n">gbar0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">var0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">gg0</span><span class="o">-</span><span class="n">gbar0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">error0</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">gg0</span><span class="o">-</span><span class="n">Ytest</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bias   = </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">bias0</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;var    = </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">var0</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error  = </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">error0</span>)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>bias   = 6018.544
var    = 40.078
Error  = 6058.622
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Hypothesis-set-$\mathcal{H}_1$,-linear-functions">Hypothesis set $\mathcal{H}_1$, linear functions<a class="anchor-link" href="#Hypothesis-set-$\mathcal{H}_1$,-linear-functions">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[122]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gg1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="p">[</span><span class="n">Dx</span><span class="p">,</span> <span class="n">xx</span> <span class="p">,</span> <span class="n">Dy</span><span class="p">,</span>  <span class="n">yy</span><span class="p">]</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">Xsp</span><span class="p">,</span> <span class="n">Ysp</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X1</span><span class="o">=</span><span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Dx</span><span class="p">)</span>
    <span class="n">m1</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">m1_fit</span><span class="o">=</span><span class="n">m1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">Dy</span><span class="p">)</span>
    <span class="n">X1test</span><span class="o">=</span><span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
    <span class="n">xpred</span><span class="o">=</span><span class="n">m1_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X1test</span><span class="p">)</span>
    <span class="n">gg1</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">=</span><span class="n">xpred</span>
<span class="n">gbar1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gg1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 

<span class="n">bias1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">Ytest</span><span class="o">-</span><span class="n">gbar1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">var1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">gg1</span><span class="o">-</span><span class="n">gbar1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">error1</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">gg1</span><span class="o">-</span><span class="n">Ytest</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bias   = </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">bias1</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;var    = </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">var1</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error  = </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">error1</span>)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>bias   = 3143.901
var    = 247.511
Error  = 3391.411
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Hypothesis-set-$\mathcal{H}_2$,-quadratic-functions">Hypothesis set $\mathcal{H}_2$, quadratic functions<a class="anchor-link" href="#Hypothesis-set-$\mathcal{H}_2$,-quadratic-functions">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[123]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gg2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">T</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="p">[</span><span class="n">Dx</span><span class="p">,</span> <span class="n">xx</span> <span class="p">,</span> <span class="n">Dy</span><span class="p">,</span>  <span class="n">yy</span><span class="p">]</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">Xsp</span><span class="p">,</span> <span class="n">Ysp</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">X2</span><span class="o">=</span><span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Dx</span><span class="p">)</span>
    <span class="n">m2</span><span class="o">=</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">m2_fit</span><span class="o">=</span><span class="n">m2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Dy</span><span class="p">)</span>
    <span class="n">X2test</span><span class="o">=</span><span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
    <span class="n">xpred</span><span class="o">=</span><span class="n">m2_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X2test</span><span class="p">)</span>
    <span class="n">gg2</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span><span class="o">=</span><span class="n">xpred</span>
<span class="n">gbar2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gg2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 

<span class="n">bias2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">Ytest</span><span class="o">-</span><span class="n">gbar2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">var2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">gg2</span><span class="o">-</span><span class="n">gbar2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">error2</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">gg2</span><span class="o">-</span><span class="n">Ytest</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bias   = </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">bias2</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;var    = </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">var2</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error  = </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">error2</span>)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>bias   = 3367.422
var    = 38742.835
Error  = 42110.257
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Logistic-Regression">Logistic Regression<a class="anchor-link" href="#Logistic-Regression">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">mplot3d</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recall some definitions</p>
<ul>
<li><p>Linear signal:
\begin{equation*}
s=\sum_{i=0}^{d}w_ix_i=\mathbf{w}^T\mathbf{x}
\end{equation*}</p>
</li>
<li><p>Logistic regression
\begin{equation*}
h\left(x\right)=\theta\left(s\right)
\end{equation*}</p>
<blockquote><p>where
\begin{equation*}
\theta\left(s\right)=\frac{e^s}{1+e^s}
\end{equation*}</p>
</blockquote>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\theta$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sigmoid Function&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;log($\theta$)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Log of Sigmoid Function&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-log($\theta$)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Negative of Log of Sigmoid Function&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_251_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>Given +1/-1 labeled data, $P\left(y|x\right)$ (i.e. probability of having label $y$ given input $x$) is given by
\begin{equation*}
P\left(y\:|\:\mathbf{x}\right) = \left\{
  \begin{matrix}
   h(\mathbf{x}) &amp; \text{for}&amp; y=+1 \\
   1-h(\mathbf{x}) &amp; \text{for}&amp; y=-1 \\
  \end{matrix}
  \right.
\end{equation*}</p>
<blockquote><p>and 
\begin{equation*}
P\left(y\:|\:\mathbf{x}\right) = \theta\left(y\:\mathbf{w}^T\mathbf{x}\right)
\end{equation*}</p>
</blockquote>
</li>
<li><p>The likelihood of a dataset $\mathcal{D}=\left\{\left(\mathbf{x}_1,y_1\right),\ldots,\left(\mathbf{x}_N,y_N\right)\right\}$ is given by</p>
</li>
</ul>
\begin{equation*}
\prod_{n=1}^{N}P\left(y_n\:|\:\mathbf{x_n}\right)=\prod_{n=1}^{N} \theta\left(y\:\mathbf{w}^T\mathbf{x}\right)
\end{equation*}<ul>
<li>Maximizing the likelihood is the same as minimizing the negative ofthe log-likelihood, which is equivalet to minimizing $E_{in}$ given by 
\begin{equation*}
E_{in}\left(\mathbf{w}\right)=\frac{1}{N}\sum_{n=1}^{N}\text{ln}\left(1+e^{-y_n\:\mathbf{w}^T\mathbf{x}_n}\right)
\end{equation*}
This is known as the cross entropy error.</li>
</ul>
<ul>
<li>Minimized using gradient descent</li>
</ul>
<blockquote><p><strong>Logistic Regression Algorithm</strong></p>
<ol>
<li>Initialize the weights at $t=0$ to $\mathbf{w}\left(0\right)$</li>
<li>While not stopping criteria is not met<blockquote><ul>
<li>compute the gradient
\begin{equation*}
\nabla E_{in}=-\frac{1}{N}\sum_{n=1}^{N}\frac{y_n\:\mathbf{x}_n}{\left(1+e^{\,y_n\,\mathbf{w}^T\mathbf{x}_n}\right)}
\end{equation*}</li>
<li>update the weights: 
\begin{equation*}
\mathbf{w}\left(t+1\right)=\mathbf{w}\left(t\right)-\eta\nabla E_{in}
\end{equation*}</li>
<li>t=t+1</li>
</ul>
</blockquote>
</li>
<li>Return the final weights $\mathbf{w}$</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-in-$\mathbb{R}$">Example in $\mathbb{R}$<a class="anchor-link" href="#Example-in-$\mathbb{R}$">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">50</span>
<span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">r</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
<span class="n">mx</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>
<span class="n">px</span><span class="o">=</span><span class="n">mx</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">mx</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">&lt;</span><span class="n">px</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">m</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>
<span class="n">pa</span><span class="o">=</span><span class="n">m</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">m</span><span class="p">)</span>

<span class="n">Wrange</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">Ein</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">W</span> <span class="ow">in</span> <span class="n">Wrange</span><span class="p">:</span> 
    <span class="n">Ein</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">W</span><span class="o">*</span><span class="n">x</span><span class="p">)))))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pa</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;signal&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;P(y=+1|x)&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>


<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Wrange</span><span class="p">,</span><span class="n">Ein</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{in}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Error Profile&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_255_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">LogisticReg1D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxI</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>

    <span class="n">wt</span><span class="o">=</span><span class="n">w0</span>
    <span class="n">ein</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wt</span><span class="o">*</span><span class="n">x</span><span class="p">))))</span>
    <span class="n">W</span><span class="o">=</span><span class="p">[</span><span class="n">w0</span><span class="p">]</span>
    <span class="n">Ein</span><span class="o">=</span><span class="p">[</span><span class="n">ein</span><span class="p">]</span>
 
    <span class="n">t</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">deltaE</span><span class="o">=</span><span class="mi">10</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">t</span><span class="o">&lt;</span><span class="n">maxI</span><span class="p">):</span>
        <span class="n">gt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wt</span><span class="o">*</span><span class="n">x</span><span class="p">))))</span>
        <span class="n">wt</span><span class="o">=</span><span class="n">wt</span><span class="o">-</span><span class="n">eta</span><span class="o">*</span><span class="n">gt</span>
        <span class="n">ein</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wt</span><span class="o">*</span><span class="n">x</span><span class="p">))))</span>
        <span class="n">deltaE</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ein</span><span class="o">-</span><span class="n">Ein</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">W</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt</span><span class="p">)</span>
        <span class="n">Ein</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ein</span><span class="p">)</span>
        <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">W</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ein</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">WW</span><span class="p">,</span> <span class="n">EE</span><span class="o">=</span><span class="n">LogisticReg1D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">figa</span><span class="p">,</span> <span class="n">axa</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">lb</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">WW</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span>
<span class="n">ub</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">WW</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span>

<span class="n">W1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span><span class="n">ub</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">E1</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">W</span> <span class="ow">in</span> <span class="n">W1</span><span class="p">:</span> 
    <span class="n">E1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">W</span><span class="o">*</span><span class="n">x</span><span class="p">)))))</span>
    
<span class="n">axa</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span><span class="n">E1</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">axa</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">WW</span><span class="p">,</span><span class="n">EE</span><span class="p">,</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="p">)</span>
<span class="n">axa</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">WW</span><span class="p">,</span><span class="n">EE</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">axa</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">axa</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">axa</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{in}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">axa</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Error Profile&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_257_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pa</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;signal&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;P(y=+1|x)&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>

<span class="n">Wrange</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">Ein</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">W</span> <span class="ow">in</span> <span class="n">Wrange</span><span class="p">:</span> 
    <span class="n">Ein</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">W</span><span class="o">*</span><span class="n">x</span><span class="p">)))))</span>

<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Wrange</span><span class="p">,</span><span class="n">Ein</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{in}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Error Profile&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">pa</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">WW</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;signal&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;probability of event&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;True Probability&#39;</span><span class="p">,</span> <span class="s1">&#39;Estimated Probability&#39;</span><span class="p">])</span>
<span class="n">ax2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Probability Estimation&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_258_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-in-$\mathbb{R}^2$">Example in $\mathbb{R}^2$<a class="anchor-link" href="#Example-in-$\mathbb{R}^2$">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">100</span>
<span class="n">x1</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">x2</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="n">rx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
<span class="n">mxx</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">4</span>
<span class="n">pxx</span><span class="o">=</span><span class="n">mxx</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">mxx</span><span class="p">)</span>
<span class="n">yx</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">rx</span><span class="o">&lt;</span><span class="n">pxx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>


<span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="o">.</span><span class="mi">1</span><span class="p">]</span>

<span class="n">mx</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mf">0.2</span><span class="o">*</span><span class="p">(</span><span class="n">a2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">4</span>
<span class="n">pax</span><span class="o">=</span><span class="n">mx</span><span class="o">/</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="n">mx</span><span class="p">)</span>

<span class="n">wr1</span><span class="p">,</span> <span class="n">wr2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">7</span><span class="p">:</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">7</span><span class="p">:</span> <span class="o">.</span><span class="mi">1</span><span class="p">]</span>
<span class="n">N1</span><span class="p">,</span> <span class="n">N2</span><span class="o">=</span><span class="n">wr1</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Einx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N1</span><span class="p">,</span><span class="n">N2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N2</span><span class="p">):</span>
        <span class="n">Einx</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">yx</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wr1</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">wr2</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span><span class="n">i2</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span><span class="p">))))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">fig3</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">pax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;P(y=+1|x)&#39;</span><span class="p">)</span>

<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">fig3</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">yx</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>

<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">fig3</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">wr1</span><span class="p">,</span><span class="n">wr2</span><span class="p">,</span><span class="n">Einx</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$w_1$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$w_2$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{in}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Error Profile&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 0.92, &#39;Error Profile&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_261_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">LogisticReg2D</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">maxI</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>

    <span class="n">wt1</span><span class="o">=</span><span class="n">w0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">wt2</span><span class="o">=</span><span class="n">w0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ein</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wt1</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">wt2</span><span class="o">*</span><span class="n">x2</span><span class="p">))))</span>
    <span class="n">W1</span><span class="o">=</span><span class="p">[</span><span class="n">wt1</span><span class="p">]</span>
    <span class="n">W2</span><span class="o">=</span><span class="p">[</span><span class="n">wt2</span><span class="p">]</span>
    <span class="n">Ein</span><span class="o">=</span><span class="p">[</span><span class="n">ein</span><span class="p">]</span>
 
    <span class="n">t</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">deltaE</span><span class="o">=</span><span class="mi">10</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">t</span><span class="o">&lt;</span><span class="n">maxI</span><span class="p">):</span>
        <span class="n">gt1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wt1</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">wt2</span><span class="o">*</span><span class="n">x2</span><span class="p">))))</span>
        <span class="n">gt2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wt1</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">wt2</span><span class="o">*</span><span class="n">x2</span><span class="p">))))</span>
        <span class="n">wt1</span><span class="o">=</span><span class="n">wt1</span><span class="o">-</span><span class="n">eta</span><span class="o">*</span><span class="n">gt1</span>
        <span class="n">wt2</span><span class="o">=</span><span class="n">wt2</span><span class="o">-</span><span class="n">eta</span><span class="o">*</span><span class="n">gt2</span>
        <span class="n">ein</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wt1</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">wt2</span><span class="o">*</span><span class="n">x2</span><span class="p">))))</span>
        <span class="n">deltaE</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ein</span><span class="o">-</span><span class="n">Ein</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
        <span class="n">W1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt1</span><span class="p">)</span>
        <span class="n">W2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wt2</span><span class="p">)</span>
        <span class="n">Ein</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ein</span><span class="p">)</span>
        <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">W1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">W2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ein</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">WW1</span><span class="p">,</span><span class="n">WW2</span><span class="p">,</span> <span class="n">EEb</span><span class="o">=</span><span class="n">LogisticReg2D</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">yx</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">maxI</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">figb</span><span class="p">,</span> <span class="n">axb</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">lb1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">WW1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">ub1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">WW1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<span class="n">lb2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">WW2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">ub2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">WW2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>

<span class="c1">#lb1=-4; ub1=4; lb2=-4; ub2=4;</span>

<span class="n">wr1x</span><span class="p">,</span> <span class="n">wr2x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="n">lb1</span><span class="p">:</span> <span class="n">ub1</span><span class="p">:</span> <span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">lb2</span><span class="p">:</span> <span class="n">ub2</span><span class="p">:</span> <span class="o">.</span><span class="mi">3</span><span class="p">]</span>
<span class="n">N1x</span><span class="p">,</span> <span class="n">N2x</span><span class="o">=</span><span class="n">wr1x</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Einxx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N1x</span><span class="p">,</span><span class="n">N2x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">EEb</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N1x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N2x</span><span class="p">):</span>
        <span class="n">Einxx</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">yx</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">wr1x</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">wr2x</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span><span class="n">i2</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span><span class="p">))))</span>

<span class="n">axb</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">axb</span><span class="o">=</span><span class="n">figb</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">wr1x</span><span class="p">,</span><span class="n">wr2x</span><span class="p">,</span><span class="n">Einxx</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">WW1</span><span class="p">,</span><span class="n">WW2</span><span class="p">,</span><span class="n">EEb</span><span class="p">,</span> <span class="s1">&#39;-ro&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">axb</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$w_1$&#39;</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$w_2$&#39;</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{in}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Error Profile&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[2.26687656 1.7523248  1.28594508 0.89843076 0.62671301 0.47735682
 0.40846482 0.37711995 0.36196951 0.3541142  0.34976873 0.34722393
 0.3456587  0.34465519 0.34398933 0.34353499 0.34321798 0.34299288
 0.34283082 0.34271292 0.34262641 0.34256255 0.34251517 0.34247987
 0.3424535  0.34243376 0.34241894 0.3424078  0.34239942 0.34239311
 0.34238836]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_263_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Neural-Networks-Using-SciKit">Neural Networks Using SciKit<a class="anchor-link" href="#Neural-Networks-Using-SciKit">&#182;</a></h1><p><a href="https://scikit-learn.org/stable/modules/neural_networks_supervised.html">https://scikit-learn.org/stable/modules/neural_networks_supervised.html</a></p>
<ul>
<li>We are going to be working with the Wisconsin Breast Cancer dataset</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">neural_network</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Loading the Dataset</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bcw</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">()</span>

<span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">bcw</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the training set X data : &quot;</span><span class="p">,</span> <span class="n">Xtrain</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the testing set X data : &quot;</span><span class="p">,</span> <span class="n">Xtest</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Names :&quot;</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categories : &quot;</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[:</span><span class="mi">1</span><span class="p">,:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the training set X data :  (398, 30) 

Dimensions of the testing set X data :  (171, 30) 

Feature Names : [&#39;mean radius&#39; &#39;mean texture&#39; &#39;mean perimeter&#39; &#39;mean area&#39;
 &#39;mean smoothness&#39; &#39;mean compactness&#39; &#39;mean concavity&#39;
 &#39;mean concave points&#39; &#39;mean symmetry&#39; &#39;mean fractal dimension&#39;
 &#39;radius error&#39; &#39;texture error&#39; &#39;perimeter error&#39; &#39;area error&#39;
 &#39;smoothness error&#39; &#39;compactness error&#39; &#39;concavity error&#39;
 &#39;concave points error&#39; &#39;symmetry error&#39; &#39;fractal dimension error&#39;
 &#39;worst radius&#39; &#39;worst texture&#39; &#39;worst perimeter&#39; &#39;worst area&#39;
 &#39;worst smoothness&#39; &#39;worst compactness&#39; &#39;worst concavity&#39;
 &#39;worst concave points&#39; &#39;worst symmetry&#39; &#39;worst fractal dimension&#39;]
Categories :  [&#39;malignant&#39; &#39;benign&#39;]
[[1.426e+01 1.817e+01 9.122e+01 6.331e+02 6.576e-02 5.220e-02 2.475e-02
  1.374e-02 1.635e-01 5.586e-02 2.300e-01 6.690e-01 1.661e+00 2.056e+01
  3.169e-03 1.377e-02 1.079e-02 5.243e-03 1.103e-02 1.957e-03 1.622e+01
  2.526e+01 1.058e+02 8.197e+02 9.445e-02 2.167e-01 1.565e-01 7.530e-02
  2.636e-01 7.676e-02]]
[1 1 0 0 1 1 1 1 0 1]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-the-NN-Model">Building the NN Model<a class="anchor-link" href="#Building-the-NN-Model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nnmodel</span> <span class="o">=</span> <span class="n">neural_network</span><span class="o">.</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span> <span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                       <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nnmodelfit</span><span class="o">=</span><span class="n">nnmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Iteration 1, loss = 0.98597258
Iteration 2, loss = 0.81829245
Iteration 3, loss = 0.76104261
Iteration 4, loss = 0.65133252
Iteration 5, loss = 0.60505794
Iteration 6, loss = 0.61504694
Iteration 7, loss = 0.62479025
Iteration 8, loss = 0.62671196
Iteration 9, loss = 0.61930981
Iteration 10, loss = 0.61221015
Iteration 11, loss = 0.59407919
Iteration 12, loss = 0.56665750
Iteration 13, loss = 0.57096660
Iteration 14, loss = 0.56378514
Iteration 15, loss = 0.52917569
Iteration 16, loss = 0.52487472
Iteration 17, loss = 0.54449546
Iteration 18, loss = 0.52672009
Iteration 19, loss = 0.49034458
Iteration 20, loss = 0.49744109
Iteration 21, loss = 0.47669549
Iteration 22, loss = 0.46939441
Iteration 23, loss = 0.48713396
Iteration 24, loss = 0.46605343
Iteration 25, loss = 0.43603753
Iteration 26, loss = 0.44125393
Iteration 27, loss = 0.43950646
Iteration 28, loss = 0.41135294
Iteration 29, loss = 0.41976845
Iteration 30, loss = 0.41551495
Iteration 31, loss = 0.40768046
Iteration 32, loss = 0.40476242
Iteration 33, loss = 0.37152723
Iteration 34, loss = 0.45430411
Iteration 35, loss = 0.40249392
Iteration 36, loss = 0.37481413
Iteration 37, loss = 0.40203313
Iteration 38, loss = 0.42622313
Iteration 39, loss = 0.37877029
Iteration 40, loss = 0.36739034
Iteration 41, loss = 0.43177558
Iteration 42, loss = 0.35401307
Iteration 43, loss = 0.36561066
Iteration 44, loss = 0.44347578
Iteration 45, loss = 0.47223512
Iteration 46, loss = 0.45784250
Iteration 47, loss = 0.39977448
Iteration 48, loss = 0.35087388
Iteration 49, loss = 0.36360829
Iteration 50, loss = 0.39913450
Iteration 51, loss = 0.32895997
Iteration 52, loss = 0.33864223
Iteration 53, loss = 0.35545478
Iteration 54, loss = 0.35378911
Iteration 55, loss = 0.34359108
Iteration 56, loss = 0.33253332
Iteration 57, loss = 0.32250959
Iteration 58, loss = 0.32416868
Iteration 59, loss = 0.31804003
Iteration 60, loss = 0.32892584
Iteration 61, loss = 0.35212199
Iteration 62, loss = 0.34747827
Iteration 63, loss = 0.31429574
Iteration 64, loss = 0.34649636
Iteration 65, loss = 0.38019393
Iteration 66, loss = 0.32240439
Iteration 67, loss = 0.32046360
Iteration 68, loss = 0.33433240
Iteration 69, loss = 0.32822147
Iteration 70, loss = 0.33610771
Iteration 71, loss = 0.33403527
Iteration 72, loss = 0.32696236
Iteration 73, loss = 0.31836035
Iteration 74, loss = 0.33128263
Training loss did not improve more than tol=0.000001 for 10 consecutive epochs. Stopping.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gtrain</span><span class="o">=</span><span class="n">nnmodelfit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
<span class="n">gtest</span><span class="o">=</span><span class="n">nnmodelfit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>

<span class="n">Ein</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtrain</span><span class="o">!=</span><span class="n">Ytrain</span><span class="p">)</span>
<span class="n">Eout</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtest</span><span class="o">!=</span><span class="n">Ytest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ein = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">Ein</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eout = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">Eout</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Ein = 14.07
Eout = 15.20
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preprocessing-the-Data">Preprocessing the Data<a class="anchor-link" href="#Preprocessing-the-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span> 
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
<span class="n">XtrainS</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span> 
<span class="n">XtestS</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nnmodelS</span> <span class="o">=</span> <span class="n">neural_network</span><span class="o">.</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span> <span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                       <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nnmodelfitS</span><span class="o">=</span><span class="n">nnmodelS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XtrainS</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Iteration 1, loss = 0.67341816
Iteration 2, loss = 0.65720952
Iteration 3, loss = 0.64141769
Iteration 4, loss = 0.62599557
Iteration 5, loss = 0.61078215
Iteration 6, loss = 0.59583141
Iteration 7, loss = 0.58226718
Iteration 8, loss = 0.56779392
Iteration 9, loss = 0.55421185
Iteration 10, loss = 0.54128133
Iteration 11, loss = 0.52832127
Iteration 12, loss = 0.51629039
Iteration 13, loss = 0.50442855
Iteration 14, loss = 0.49272739
Iteration 15, loss = 0.48223842
Iteration 16, loss = 0.47184675
Iteration 17, loss = 0.46132470
Iteration 18, loss = 0.45170065
Iteration 19, loss = 0.44240682
Iteration 20, loss = 0.43387523
Iteration 21, loss = 0.42504322
Iteration 22, loss = 0.41684497
Iteration 23, loss = 0.40912990
Iteration 24, loss = 0.40120799
Iteration 25, loss = 0.39419432
Iteration 26, loss = 0.38718681
Iteration 27, loss = 0.38031683
Iteration 28, loss = 0.37367175
Iteration 29, loss = 0.36756846
Iteration 30, loss = 0.36171317
Iteration 31, loss = 0.35571189
Iteration 32, loss = 0.35030278
Iteration 33, loss = 0.34494281
Iteration 34, loss = 0.33965952
Iteration 35, loss = 0.33468447
Iteration 36, loss = 0.32987210
Iteration 37, loss = 0.32523338
Iteration 38, loss = 0.32073559
Iteration 39, loss = 0.31627343
Iteration 40, loss = 0.31214053
Iteration 41, loss = 0.30807225
Iteration 42, loss = 0.30415275
Iteration 43, loss = 0.30030812
Iteration 44, loss = 0.29659597
Iteration 45, loss = 0.29295205
Iteration 46, loss = 0.28954396
Iteration 47, loss = 0.28616935
Iteration 48, loss = 0.28286779
Iteration 49, loss = 0.27963634
Iteration 50, loss = 0.27651860
Iteration 51, loss = 0.27353594
Iteration 52, loss = 0.27071794
Iteration 53, loss = 0.26781770
Iteration 54, loss = 0.26503414
Iteration 55, loss = 0.26237646
Iteration 56, loss = 0.25969456
Iteration 57, loss = 0.25715440
Iteration 58, loss = 0.25460676
Iteration 59, loss = 0.25219778
Iteration 60, loss = 0.24987446
Iteration 61, loss = 0.24754842
Iteration 62, loss = 0.24513881
Iteration 63, loss = 0.24297262
Iteration 64, loss = 0.24079444
Iteration 65, loss = 0.23864361
Iteration 66, loss = 0.23662709
Iteration 67, loss = 0.23458694
Iteration 68, loss = 0.23246662
Iteration 69, loss = 0.23061793
Iteration 70, loss = 0.22864445
Iteration 71, loss = 0.22678744
Iteration 72, loss = 0.22486421
Iteration 73, loss = 0.22310474
Iteration 74, loss = 0.22131085
Iteration 75, loss = 0.21960367
Iteration 76, loss = 0.21787233
Iteration 77, loss = 0.21622296
Iteration 78, loss = 0.21453017
Iteration 79, loss = 0.21291001
Iteration 80, loss = 0.21132060
Iteration 81, loss = 0.20972994
Iteration 82, loss = 0.20818510
Iteration 83, loss = 0.20667558
Iteration 84, loss = 0.20517866
Iteration 85, loss = 0.20374788
Iteration 86, loss = 0.20224451
Iteration 87, loss = 0.20085192
Iteration 88, loss = 0.19946492
Iteration 89, loss = 0.19810174
Iteration 90, loss = 0.19672620
Iteration 91, loss = 0.19542200
Iteration 92, loss = 0.19409043
Iteration 93, loss = 0.19281715
Iteration 94, loss = 0.19151722
Iteration 95, loss = 0.19029755
Iteration 96, loss = 0.18908924
Iteration 97, loss = 0.18787732
Iteration 98, loss = 0.18665436
Iteration 99, loss = 0.18548546
Iteration 100, loss = 0.18432154
Iteration 101, loss = 0.18317435
Iteration 102, loss = 0.18201250
Iteration 103, loss = 0.18092261
Iteration 104, loss = 0.17988764
Iteration 105, loss = 0.17876199
Iteration 106, loss = 0.17769892
Iteration 107, loss = 0.17664654
Iteration 108, loss = 0.17561077
Iteration 109, loss = 0.17459099
Iteration 110, loss = 0.17356379
Iteration 111, loss = 0.17257819
Iteration 112, loss = 0.17159423
Iteration 113, loss = 0.17061799
Iteration 114, loss = 0.16963038
Iteration 115, loss = 0.16867808
Iteration 116, loss = 0.16774329
Iteration 117, loss = 0.16682526
Iteration 118, loss = 0.16589879
Iteration 119, loss = 0.16499134
Iteration 120, loss = 0.16406906
Iteration 121, loss = 0.16319392
Iteration 122, loss = 0.16230134
Iteration 123, loss = 0.16142483
Iteration 124, loss = 0.16058728
Iteration 125, loss = 0.15974358
Iteration 126, loss = 0.15889958
Iteration 127, loss = 0.15806592
Iteration 128, loss = 0.15722309
Iteration 129, loss = 0.15641833
Iteration 130, loss = 0.15559645
Iteration 131, loss = 0.15479845
Iteration 132, loss = 0.15399686
Iteration 133, loss = 0.15324772
Iteration 134, loss = 0.15244942
Iteration 135, loss = 0.15170122
Iteration 136, loss = 0.15094019
Iteration 137, loss = 0.15020679
Iteration 138, loss = 0.14947735
Iteration 139, loss = 0.14871813
Iteration 140, loss = 0.14800892
Iteration 141, loss = 0.14728226
Iteration 142, loss = 0.14659365
Iteration 143, loss = 0.14588886
Iteration 144, loss = 0.14519275
Iteration 145, loss = 0.14450603
Iteration 146, loss = 0.14384712
Iteration 147, loss = 0.14315427
Iteration 148, loss = 0.14248245
Iteration 149, loss = 0.14182151
Iteration 150, loss = 0.14117326
Iteration 151, loss = 0.14054732
Iteration 152, loss = 0.13988098
Iteration 153, loss = 0.13925853
Iteration 154, loss = 0.13862003
Iteration 155, loss = 0.13800101
Iteration 156, loss = 0.13739212
Iteration 157, loss = 0.13677304
Iteration 158, loss = 0.13615932
Iteration 159, loss = 0.13555622
Iteration 160, loss = 0.13499703
Iteration 161, loss = 0.13438965
Iteration 162, loss = 0.13379535
Iteration 163, loss = 0.13322107
Iteration 164, loss = 0.13265159
Iteration 165, loss = 0.13206986
Iteration 166, loss = 0.13151341
Iteration 167, loss = 0.13093855
Iteration 168, loss = 0.13039773
Iteration 169, loss = 0.12985580
Iteration 170, loss = 0.12929625
Iteration 171, loss = 0.12875471
Iteration 172, loss = 0.12822218
Iteration 173, loss = 0.12769367
Iteration 174, loss = 0.12717198
Iteration 175, loss = 0.12664681
Iteration 176, loss = 0.12612697
Iteration 177, loss = 0.12560267
Iteration 178, loss = 0.12510313
Iteration 179, loss = 0.12460204
Iteration 180, loss = 0.12411600
Iteration 181, loss = 0.12360640
Iteration 182, loss = 0.12310247
Iteration 183, loss = 0.12261526
Iteration 184, loss = 0.12214155
Iteration 185, loss = 0.12164779
Iteration 186, loss = 0.12118289
Iteration 187, loss = 0.12072797
Iteration 188, loss = 0.12022516
Iteration 189, loss = 0.11976450
Iteration 190, loss = 0.11929926
Iteration 191, loss = 0.11883891
Iteration 192, loss = 0.11840444
Iteration 193, loss = 0.11796141
Iteration 194, loss = 0.11749240
Iteration 195, loss = 0.11706145
Iteration 196, loss = 0.11662386
Iteration 197, loss = 0.11618363
Iteration 198, loss = 0.11575821
Iteration 199, loss = 0.11532473
Iteration 200, loss = 0.11489426
Iteration 201, loss = 0.11446297
Iteration 202, loss = 0.11405017
Iteration 203, loss = 0.11363618
Iteration 204, loss = 0.11321097
Iteration 205, loss = 0.11280456
Iteration 206, loss = 0.11240706
Iteration 207, loss = 0.11200645
Iteration 208, loss = 0.11161013
Iteration 209, loss = 0.11120620
Iteration 210, loss = 0.11081464
Iteration 211, loss = 0.11041649
Iteration 212, loss = 0.11002168
Iteration 213, loss = 0.10964177
Iteration 214, loss = 0.10924852
Iteration 215, loss = 0.10886973
Iteration 216, loss = 0.10848370
Iteration 217, loss = 0.10811866
Iteration 218, loss = 0.10774154
Iteration 219, loss = 0.10736760
Iteration 220, loss = 0.10699985
Iteration 221, loss = 0.10663670
Iteration 222, loss = 0.10627679
Iteration 223, loss = 0.10591804
Iteration 224, loss = 0.10554524
Iteration 225, loss = 0.10519673
Iteration 226, loss = 0.10485593
Iteration 227, loss = 0.10450620
Iteration 228, loss = 0.10414481
Iteration 229, loss = 0.10379687
Iteration 230, loss = 0.10344335
Iteration 231, loss = 0.10311093
Iteration 232, loss = 0.10278501
Iteration 233, loss = 0.10245071
Iteration 234, loss = 0.10210160
Iteration 235, loss = 0.10177415
Iteration 236, loss = 0.10144097
Iteration 237, loss = 0.10111926
Iteration 238, loss = 0.10078651
Iteration 239, loss = 0.10046252
Iteration 240, loss = 0.10015014
Iteration 241, loss = 0.09982203
Iteration 242, loss = 0.09950326
Iteration 243, loss = 0.09918684
Iteration 244, loss = 0.09886738
Iteration 245, loss = 0.09854762
Iteration 246, loss = 0.09824269
Iteration 247, loss = 0.09793763
Iteration 248, loss = 0.09762691
Iteration 249, loss = 0.09733499
Iteration 250, loss = 0.09700854
Iteration 251, loss = 0.09671224
Iteration 252, loss = 0.09642952
Iteration 253, loss = 0.09612765
Iteration 254, loss = 0.09582384
Iteration 255, loss = 0.09552280
Iteration 256, loss = 0.09522812
Iteration 257, loss = 0.09493252
Iteration 258, loss = 0.09464897
Iteration 259, loss = 0.09434709
Iteration 260, loss = 0.09408560
Iteration 261, loss = 0.09379227
Iteration 262, loss = 0.09349618
Iteration 263, loss = 0.09323593
Iteration 264, loss = 0.09293643
Iteration 265, loss = 0.09265832
Iteration 266, loss = 0.09237858
Iteration 267, loss = 0.09209493
Iteration 268, loss = 0.09182188
Iteration 269, loss = 0.09154722
Iteration 270, loss = 0.09127924
Iteration 271, loss = 0.09101067
Iteration 272, loss = 0.09073541
Iteration 273, loss = 0.09046882
Iteration 274, loss = 0.09019641
Iteration 275, loss = 0.08992948
Iteration 276, loss = 0.08967554
Iteration 277, loss = 0.08941906
Iteration 278, loss = 0.08915227
Iteration 279, loss = 0.08888221
Iteration 280, loss = 0.08861885
Iteration 281, loss = 0.08836138
Iteration 282, loss = 0.08811082
Iteration 283, loss = 0.08785498
Iteration 284, loss = 0.08759170
Iteration 285, loss = 0.08734418
Iteration 286, loss = 0.08708765
Iteration 287, loss = 0.08683671
Iteration 288, loss = 0.08657773
Iteration 289, loss = 0.08633531
Iteration 290, loss = 0.08608549
Iteration 291, loss = 0.08583028
Iteration 292, loss = 0.08558778
Iteration 293, loss = 0.08533980
Iteration 294, loss = 0.08511105
Iteration 295, loss = 0.08485611
Iteration 296, loss = 0.08461841
Iteration 297, loss = 0.08437633
Iteration 298, loss = 0.08414055
Iteration 299, loss = 0.08389383
Iteration 300, loss = 0.08366095
Iteration 301, loss = 0.08342984
Iteration 302, loss = 0.08318691
Iteration 303, loss = 0.08294720
Iteration 304, loss = 0.08270904
Iteration 305, loss = 0.08247473
Iteration 306, loss = 0.08225459
Iteration 307, loss = 0.08202096
Iteration 308, loss = 0.08178510
Iteration 309, loss = 0.08154440
Iteration 310, loss = 0.08133195
Iteration 311, loss = 0.08109558
Iteration 312, loss = 0.08086768
Iteration 313, loss = 0.08064202
Iteration 314, loss = 0.08041635
Iteration 315, loss = 0.08021926
Iteration 316, loss = 0.07996647
Iteration 317, loss = 0.07975577
Iteration 318, loss = 0.07952609
Iteration 319, loss = 0.07931203
Iteration 320, loss = 0.07907774
Iteration 321, loss = 0.07886013
Iteration 322, loss = 0.07864346
Iteration 323, loss = 0.07841665
Iteration 324, loss = 0.07822185
Iteration 325, loss = 0.07798010
Iteration 326, loss = 0.07777123
Iteration 327, loss = 0.07756899
Iteration 328, loss = 0.07735211
Iteration 329, loss = 0.07714576
Iteration 330, loss = 0.07691501
Iteration 331, loss = 0.07671370
Iteration 332, loss = 0.07648933
Iteration 333, loss = 0.07629189
Iteration 334, loss = 0.07608651
Iteration 335, loss = 0.07586933
Iteration 336, loss = 0.07566063
Iteration 337, loss = 0.07546571
Iteration 338, loss = 0.07525278
Iteration 339, loss = 0.07503766
Iteration 340, loss = 0.07483491
Iteration 341, loss = 0.07462272
Iteration 342, loss = 0.07443038
Iteration 343, loss = 0.07421669
Iteration 344, loss = 0.07401285
Iteration 345, loss = 0.07380969
Iteration 346, loss = 0.07362321
Iteration 347, loss = 0.07339890
Iteration 348, loss = 0.07321447
Iteration 349, loss = 0.07301385
Iteration 350, loss = 0.07280942
Iteration 351, loss = 0.07260932
Iteration 352, loss = 0.07241783
Iteration 353, loss = 0.07222521
Iteration 354, loss = 0.07202683
Iteration 355, loss = 0.07183756
Iteration 356, loss = 0.07164032
Iteration 357, loss = 0.07146163
Iteration 358, loss = 0.07125071
Iteration 359, loss = 0.07107968
Iteration 360, loss = 0.07086538
Iteration 361, loss = 0.07069355
Iteration 362, loss = 0.07049364
Iteration 363, loss = 0.07030832
Iteration 364, loss = 0.07012050
Iteration 365, loss = 0.06993275
Iteration 366, loss = 0.06973457
Iteration 367, loss = 0.06956346
Iteration 368, loss = 0.06937734
Iteration 369, loss = 0.06918755
Iteration 370, loss = 0.06900103
Iteration 371, loss = 0.06882085
Iteration 372, loss = 0.06862284
Iteration 373, loss = 0.06845551
Iteration 374, loss = 0.06827771
Iteration 375, loss = 0.06808024
Iteration 376, loss = 0.06790568
Iteration 377, loss = 0.06771855
Iteration 378, loss = 0.06753467
Iteration 379, loss = 0.06736629
Iteration 380, loss = 0.06718837
Iteration 381, loss = 0.06700553
Iteration 382, loss = 0.06682455
Iteration 383, loss = 0.06667574
Iteration 384, loss = 0.06649126
Iteration 385, loss = 0.06630617
Iteration 386, loss = 0.06614157
Iteration 387, loss = 0.06595692
Iteration 388, loss = 0.06578432
Iteration 389, loss = 0.06562250
Iteration 390, loss = 0.06544210
Iteration 391, loss = 0.06526273
Iteration 392, loss = 0.06510842
Iteration 393, loss = 0.06492847
Iteration 394, loss = 0.06475495
Iteration 395, loss = 0.06458784
Iteration 396, loss = 0.06442736
Iteration 397, loss = 0.06425822
Iteration 398, loss = 0.06408362
Iteration 399, loss = 0.06393505
Iteration 400, loss = 0.06378553
Iteration 401, loss = 0.06359478
Iteration 402, loss = 0.06343528
Iteration 403, loss = 0.06325684
Iteration 404, loss = 0.06310657
Iteration 405, loss = 0.06294790
Iteration 406, loss = 0.06277946
Iteration 407, loss = 0.06262081
Iteration 408, loss = 0.06246000
Iteration 409, loss = 0.06229203
Iteration 410, loss = 0.06212731
Iteration 411, loss = 0.06198673
Iteration 412, loss = 0.06183274
Iteration 413, loss = 0.06165634
Iteration 414, loss = 0.06153571
Iteration 415, loss = 0.06134758
Iteration 416, loss = 0.06120732
Iteration 417, loss = 0.06104662
Iteration 418, loss = 0.06087789
Iteration 419, loss = 0.06073042
Iteration 420, loss = 0.06057547
Iteration 421, loss = 0.06042934
Iteration 422, loss = 0.06027271
Iteration 423, loss = 0.06014749
Iteration 424, loss = 0.05996612
Iteration 425, loss = 0.05981043
Iteration 426, loss = 0.05967629
Iteration 427, loss = 0.05951968
Iteration 428, loss = 0.05937606
Iteration 429, loss = 0.05922887
Iteration 430, loss = 0.05907392
Iteration 431, loss = 0.05892019
Iteration 432, loss = 0.05876976
Iteration 433, loss = 0.05864093
Iteration 434, loss = 0.05848516
Iteration 435, loss = 0.05834541
Iteration 436, loss = 0.05821319
Iteration 437, loss = 0.05805577
Iteration 438, loss = 0.05791821
Iteration 439, loss = 0.05777835
Iteration 440, loss = 0.05762274
Iteration 441, loss = 0.05747591
Iteration 442, loss = 0.05734577
Iteration 443, loss = 0.05722001
Iteration 444, loss = 0.05706119
Iteration 445, loss = 0.05693069
Iteration 446, loss = 0.05678811
Iteration 447, loss = 0.05664150
Iteration 448, loss = 0.05650144
Iteration 449, loss = 0.05637798
Iteration 450, loss = 0.05624157
Iteration 451, loss = 0.05609052
Iteration 452, loss = 0.05595330
Iteration 453, loss = 0.05581607
Iteration 454, loss = 0.05568789
Iteration 455, loss = 0.05555459
Iteration 456, loss = 0.05542070
Iteration 457, loss = 0.05527037
Iteration 458, loss = 0.05514974
Iteration 459, loss = 0.05502554
Iteration 460, loss = 0.05488427
Iteration 461, loss = 0.05475340
Iteration 462, loss = 0.05462175
Iteration 463, loss = 0.05451544
Iteration 464, loss = 0.05436024
Iteration 465, loss = 0.05423162
Iteration 466, loss = 0.05409902
Iteration 467, loss = 0.05397962
Iteration 468, loss = 0.05385511
Iteration 469, loss = 0.05374571
Iteration 470, loss = 0.05359647
Iteration 471, loss = 0.05346203
Iteration 472, loss = 0.05333854
Iteration 473, loss = 0.05322223
Iteration 474, loss = 0.05308590
Iteration 475, loss = 0.05296516
Iteration 476, loss = 0.05287394
Iteration 477, loss = 0.05273050
Iteration 478, loss = 0.05259168
Iteration 479, loss = 0.05248904
Iteration 480, loss = 0.05235070
Iteration 481, loss = 0.05224274
Iteration 482, loss = 0.05212829
Iteration 483, loss = 0.05198338
Iteration 484, loss = 0.05186717
Iteration 485, loss = 0.05173472
Iteration 486, loss = 0.05162215
Iteration 487, loss = 0.05151654
Iteration 488, loss = 0.05138198
Iteration 489, loss = 0.05126560
Iteration 490, loss = 0.05115846
Iteration 491, loss = 0.05104155
Iteration 492, loss = 0.05090889
Iteration 493, loss = 0.05079098
Iteration 494, loss = 0.05070771
Iteration 495, loss = 0.05056513
Iteration 496, loss = 0.05043736
Iteration 497, loss = 0.05034646
Iteration 498, loss = 0.05021414
Iteration 499, loss = 0.05010023
Iteration 500, loss = 0.04999608
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\ProgramData\Anaconda3\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:571: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (500) reached and the optimization hasn&#39;t converged yet.
  % self.max_iter, ConvergenceWarning)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gtrainS</span><span class="o">=</span><span class="n">nnmodelfitS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XtrainS</span><span class="p">)</span>
<span class="n">gtestS</span><span class="o">=</span><span class="n">nnmodelfitS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XtestS</span><span class="p">)</span>

<span class="n">EinS</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtrainS</span><span class="o">!=</span><span class="n">Ytrain</span><span class="p">)</span>
<span class="n">EoutS</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gtestS</span><span class="o">!=</span><span class="n">Ytest</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EinS = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">EinS</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EoutS = </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">EoutS</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>EinS = 0.75
EoutS = 1.75
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nnmodelfitS</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{&#39;activation&#39;: &#39;tanh&#39;,
 &#39;alpha&#39;: 0,
 &#39;batch_size&#39;: &#39;auto&#39;,
 &#39;beta_1&#39;: 0.9,
 &#39;beta_2&#39;: 0.999,
 &#39;early_stopping&#39;: False,
 &#39;epsilon&#39;: 1e-08,
 &#39;hidden_layer_sizes&#39;: (10, 3),
 &#39;learning_rate&#39;: &#39;constant&#39;,
 &#39;learning_rate_init&#39;: 0.001,
 &#39;max_fun&#39;: 15000,
 &#39;max_iter&#39;: 500,
 &#39;momentum&#39;: 0.9,
 &#39;n_iter_no_change&#39;: 10,
 &#39;nesterovs_momentum&#39;: True,
 &#39;power_t&#39;: 0.5,
 &#39;random_state&#39;: None,
 &#39;shuffle&#39;: True,
 &#39;solver&#39;: &#39;adam&#39;,
 &#39;tol&#39;: 1e-06,
 &#39;validation_fraction&#39;: 0.1,
 &#39;verbose&#39;: True,
 &#39;warm_start&#39;: False}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Neural-Networks-Using-TensorFlow">Neural Networks Using TensorFlow<a class="anchor-link" href="#Neural-Networks-Using-TensorFlow">&#182;</a></h1><ul>
<li>We are going to use the Fashion MNIST dataset</li>
<li>Following this tutorial
<a href="https://www.tensorflow.org/tutorials/keras/classification">https://www.tensorflow.org/tutorials/keras/classification</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Load-the-Data-Using-Keras">Load the Data Using Keras<a class="anchor-link" href="#Load-the-Data-Using-Keras">&#182;</a></h2><ul>
<li>Data is split between training and testing</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fashion_mnist</span>
<span class="p">(</span><span class="n">trainx</span><span class="p">,</span> <span class="n">trainy</span><span class="p">),</span> <span class="p">(</span><span class="n">testx</span><span class="p">,</span> <span class="n">testy</span><span class="p">)</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training data dimensions : &quot;</span><span class="p">,</span> <span class="n">trainx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Testing data dimensions : &quot;</span><span class="p">,</span> <span class="n">testx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">Nx</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span> <span class="o">=</span> <span class="n">trainx</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Training data dimensions :  (60000, 28, 28)
Testing data dimensions :  (10000, 28, 28)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Each data point is a 28x28 image</li>
<li>Each label is a value 0 to 9 corresponding to the following classes 
<pre><code>0    T-shirt/top
1    Trouser
2    Pullover
3    Dress
4    Coat
5    Sandal
6    Shirt
7    Sneaker
8    Bag
9    Ankle boot</code></pre>
</li>
<li>We normalize each image by dividing by 255 (so that each pixel is between 0 and 1, better for using in NN)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T-shirt/top&#39;</span><span class="p">,</span> <span class="s1">&#39;Trouser&#39;</span><span class="p">,</span> <span class="s1">&#39;Pullover&#39;</span><span class="p">,</span> <span class="s1">&#39;Dress&#39;</span><span class="p">,</span> <span class="s1">&#39;Coat&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Sandal&#39;</span><span class="p">,</span> <span class="s1">&#39;Shirt&#39;</span><span class="p">,</span> <span class="s1">&#39;Sneaker&#39;</span><span class="p">,</span> <span class="s1">&#39;Bag&#39;</span><span class="p">,</span> <span class="s1">&#39;Ankle boot&#39;</span><span class="p">]</span>
<span class="n">trainxn</span><span class="o">=</span><span class="n">trainx</span><span class="o">/</span><span class="mf">255.0</span>
<span class="n">testxn</span><span class="o">=</span><span class="n">testx</span><span class="o">/</span><span class="mf">255.0</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">trainxn</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">trainy</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_283_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-the-NN-Model">Building the NN Model<a class="anchor-link" href="#Building-the-NN-Model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span> 
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;sparse_categorical_crossentropy&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainxn</span><span class="p">,</span> <span class="n">trainy</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Train on 60000 samples
Epoch 1/10
60000/60000 [==============================] - 6s 95us/sample - loss: 0.5060 - accuracy: 0.8215
Epoch 2/10
60000/60000 [==============================] - 6s 93us/sample - loss: 0.3784 - accuracy: 0.8635
Epoch 3/10
60000/60000 [==============================] - 5s 90us/sample - loss: 0.3391 - accuracy: 0.8755
Epoch 4/10
60000/60000 [==============================] - 5s 89us/sample - loss: 0.3170 - accuracy: 0.8839
Epoch 5/10
60000/60000 [==============================] - 6s 93us/sample - loss: 0.3020 - accuracy: 0.8879
Epoch 6/10
60000/60000 [==============================] - 6s 93us/sample - loss: 0.2853 - accuracy: 0.8944
Epoch 7/10
60000/60000 [==============================] - 5s 90us/sample - loss: 0.2744 - accuracy: 0.8977
Epoch 8/10
60000/60000 [==============================] - 5s 89us/sample - loss: 0.2645 - accuracy: 0.9010
Epoch 9/10
60000/60000 [==============================] - 5s 90us/sample - loss: 0.2537 - accuracy: 0.9044
Epoch 10/10
60000/60000 [==============================] - 6s 94us/sample - loss: 0.2458 - accuracy: 0.9079
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;tensorflow.python.keras.callbacks.History at 0x2a868fdf7c8&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Let's-see-how-well-it-performs">Let's see how well it performs<a class="anchor-link" href="#Let's-see-how-well-it-performs">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">testxn</span><span class="p">,</span><span class="n">testy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Testing set loss :  </span><span class="si">%.3f</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">test_loss</span>)
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Testing set accuracy :  </span><span class="si">%.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">test_acc</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>10000/10000 [==============================] - 0s 50us/sample - loss: 0.3394 - accuracy: 0.8771
Testing set loss :  0.339
Testing set accuracy :  87.71 %
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prediction</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testxn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction probabilities for each class (for the first test image): &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">predictiony</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best prediction for the first test : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">predictiony</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction probabilities for each class (for the first test image): 
[2.4820030e-08 1.7276420e-06 9.6129054e-07 8.8507541e-08 1.7073783e-07
 1.7096147e-04 1.0076718e-06 2.3633298e-03 3.4350400e-08 9.9746168e-01]
Best prediction for the first test : 
Ankle boot
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">testxn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Prediction: &quot;</span> <span class="o">+</span> <span class="n">class_names</span><span class="p">[</span><span class="n">predictiony</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Actual: &quot;</span> <span class="o">+</span> <span class="n">class_names</span><span class="p">[</span><span class="n">testy</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_290_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Note-about-Processing-the-Data">A Note about Processing the Data<a class="anchor-link" href="#A-Note-about-Processing-the-Data">&#182;</a></h2><ul>
<li>We can change the format of each data point using reshape</li>
<li>From 28x28 array we can convert to a 784 feature vector (hence match the datasets we have work on before</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">n3</span> <span class="o">=</span> <span class="n">trainx</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trainx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">ddx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">trainx</span><span class="p">,</span> <span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="o">*</span><span class="n">n3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ddx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(60000, 28, 28)
(60000, 784)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Here how we can separate the training set 70/30 randomly</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="mf">0.3</span>
<span class="n">tt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
<span class="n">dd1</span><span class="o">=</span><span class="n">ddx</span><span class="p">[</span><span class="n">tt</span><span class="o">&gt;</span><span class="n">s</span><span class="p">,:]</span>
<span class="n">dd2</span><span class="o">=</span><span class="n">ddx</span><span class="p">[</span><span class="n">tt</span><span class="o">&lt;=</span><span class="n">s</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dd1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dd2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(42143, 784) (17857, 784)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Overfitting">Overfitting<a class="anchor-link" href="#Overfitting">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">neural_network</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overfitting-Example-:-Neural-Networks">Overfitting Example : Neural Networks<a class="anchor-link" href="#Overfitting-Example-:-Neural-Networks">&#182;</a></h2><p><strong>Using the Wisconsin Breast Cancer dataset</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bcw</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">()</span>

<span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">bcw</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the training set X data : &quot;</span><span class="p">,</span> <span class="n">Xtrain</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the testing set X data : &quot;</span><span class="p">,</span> <span class="n">Xtest</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Names :&quot;</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categories : &quot;</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[:</span><span class="mi">1</span><span class="p">,:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the training set X data :  (398, 30) 

Dimensions of the testing set X data :  (171, 30) 

Feature Names : [&#39;mean radius&#39; &#39;mean texture&#39; &#39;mean perimeter&#39; &#39;mean area&#39;
 &#39;mean smoothness&#39; &#39;mean compactness&#39; &#39;mean concavity&#39;
 &#39;mean concave points&#39; &#39;mean symmetry&#39; &#39;mean fractal dimension&#39;
 &#39;radius error&#39; &#39;texture error&#39; &#39;perimeter error&#39; &#39;area error&#39;
 &#39;smoothness error&#39; &#39;compactness error&#39; &#39;concavity error&#39;
 &#39;concave points error&#39; &#39;symmetry error&#39; &#39;fractal dimension error&#39;
 &#39;worst radius&#39; &#39;worst texture&#39; &#39;worst perimeter&#39; &#39;worst area&#39;
 &#39;worst smoothness&#39; &#39;worst compactness&#39; &#39;worst concavity&#39;
 &#39;worst concave points&#39; &#39;worst symmetry&#39; &#39;worst fractal dimension&#39;]
Categories :  [&#39;malignant&#39; &#39;benign&#39;]
[[1.513e+01 2.981e+01 9.671e+01 7.195e+02 8.320e-02 4.605e-02 4.686e-02
  2.739e-02 1.852e-01 5.294e-02 4.681e-01 1.627e+00 3.043e+00 4.538e+01
  6.831e-03 1.427e-02 2.489e-02 9.087e-03 3.151e-02 1.750e-03 1.726e+01
  3.691e+01 1.101e+02 9.314e+02 1.148e-01 9.866e-02 1.547e-01 6.575e-02
  3.233e-01 6.165e-02]]
[0 1 1 1 0 1 1 1 1 1]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>Scale the data, and train a NN network</strong></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span> 
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
<span class="n">XtrainS</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span> 
<span class="n">XtestS</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nnmodelS</span> <span class="o">=</span> <span class="n">neural_network</span><span class="o">.</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span> <span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                       <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nnmodelfitS</span><span class="o">=</span><span class="n">nnmodelS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XtrainS</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Iteration 1, loss = 0.39933101
Iteration 2, loss = 0.25113951
Iteration 3, loss = 0.14998096
Iteration 4, loss = 0.10707496
Iteration 5, loss = 0.10982699
Iteration 6, loss = 0.07416380
Iteration 7, loss = 0.05765989
Iteration 8, loss = 0.05570314
Iteration 9, loss = 0.04615298
Iteration 10, loss = 0.04276936
Iteration 11, loss = 0.03748454
Iteration 12, loss = 0.03509447
Iteration 13, loss = 0.03189758
Iteration 14, loss = 0.02821618
Iteration 15, loss = 0.02470567
Iteration 16, loss = 0.02238418
Iteration 17, loss = 0.01906160
Iteration 18, loss = 0.01697007
Iteration 19, loss = 0.01632332
Iteration 20, loss = 0.01381244
Iteration 21, loss = 0.01203110
Iteration 22, loss = 0.01054896
Iteration 23, loss = 0.00997309
Iteration 24, loss = 0.00854649
Iteration 25, loss = 0.00804458
Iteration 26, loss = 0.00720576
Iteration 27, loss = 0.00655943
Iteration 28, loss = 0.00538282
Iteration 29, loss = 0.00447315
Iteration 30, loss = 0.00408302
Iteration 31, loss = 0.00341670
Iteration 32, loss = 0.00319444
Iteration 33, loss = 0.00301645
Iteration 34, loss = 0.00270213
Iteration 35, loss = 0.00255394
Iteration 36, loss = 0.00234996
Iteration 37, loss = 0.00222131
Iteration 38, loss = 0.00209378
Iteration 39, loss = 0.00200927
Iteration 40, loss = 0.00187114
Iteration 41, loss = 0.00178764
Iteration 42, loss = 0.00170198
Iteration 43, loss = 0.00165199
Iteration 44, loss = 0.00158168
Iteration 45, loss = 0.00152230
Iteration 46, loss = 0.00146163
Iteration 47, loss = 0.00141670
Iteration 48, loss = 0.00137686
Iteration 49, loss = 0.00134915
Iteration 50, loss = 0.00131172
Iteration 51, loss = 0.00127191
Iteration 52, loss = 0.00124863
Iteration 53, loss = 0.00121005
Iteration 54, loss = 0.00119299
Iteration 55, loss = 0.00116132
Iteration 56, loss = 0.00114291
Iteration 57, loss = 0.00111988
Iteration 58, loss = 0.00109886
Iteration 59, loss = 0.00107474
Iteration 60, loss = 0.00105020
Iteration 61, loss = 0.00103427
Iteration 62, loss = 0.00101469
Iteration 63, loss = 0.00099499
Iteration 64, loss = 0.00097723
Iteration 65, loss = 0.00095403
Iteration 66, loss = 0.00093096
Iteration 67, loss = 0.00091044
Iteration 68, loss = 0.00083437
Iteration 69, loss = 0.00080372
Iteration 70, loss = 0.00077723
Iteration 71, loss = 0.00076327
Iteration 72, loss = 0.00074453
Iteration 73, loss = 0.00073067
Iteration 74, loss = 0.00071027
Iteration 75, loss = 0.00069551
Iteration 76, loss = 0.00068376
Iteration 77, loss = 0.00067139
Iteration 78, loss = 0.00065553
Iteration 79, loss = 0.00064800
Iteration 80, loss = 0.00063642
Iteration 81, loss = 0.00062938
Iteration 82, loss = 0.00061794
Iteration 83, loss = 0.00061034
Iteration 84, loss = 0.00060191
Iteration 85, loss = 0.00059532
Iteration 86, loss = 0.00058756
Iteration 87, loss = 0.00058278
Iteration 88, loss = 0.00057480
Iteration 89, loss = 0.00056973
Iteration 90, loss = 0.00056313
Iteration 91, loss = 0.00055523
Iteration 92, loss = 0.00055002
Iteration 93, loss = 0.00054370
Iteration 94, loss = 0.00053809
Iteration 95, loss = 0.00053258
Iteration 96, loss = 0.00052839
Iteration 97, loss = 0.00052366
Iteration 98, loss = 0.00051851
Iteration 99, loss = 0.00051164
Iteration 100, loss = 0.00050832
Iteration 101, loss = 0.00050321
Iteration 102, loss = 0.00049836
Iteration 103, loss = 0.00049221
Iteration 104, loss = 0.00048863
Iteration 105, loss = 0.00048411
Iteration 106, loss = 0.00047983
Iteration 107, loss = 0.00047604
Iteration 108, loss = 0.00047120
Iteration 109, loss = 0.00046738
Iteration 110, loss = 0.00046318
Iteration 111, loss = 0.00045890
Iteration 112, loss = 0.00045447
Iteration 113, loss = 0.00045119
Iteration 114, loss = 0.00044667
Iteration 115, loss = 0.00044331
Iteration 116, loss = 0.00043942
Iteration 117, loss = 0.00043457
Iteration 118, loss = 0.00043085
Iteration 119, loss = 0.00042849
Iteration 120, loss = 0.00042452
Iteration 121, loss = 0.00042128
Iteration 122, loss = 0.00041759
Iteration 123, loss = 0.00041403
Iteration 124, loss = 0.00041068
Iteration 125, loss = 0.00040717
Iteration 126, loss = 0.00040376
Iteration 127, loss = 0.00040062
Iteration 128, loss = 0.00039645
Iteration 129, loss = 0.00039346
Iteration 130, loss = 0.00039131
Iteration 131, loss = 0.00038822
Iteration 132, loss = 0.00038490
Iteration 133, loss = 0.00038094
Iteration 134, loss = 0.00037898
Iteration 135, loss = 0.00037591
Iteration 136, loss = 0.00037279
Iteration 137, loss = 0.00037001
Iteration 138, loss = 0.00036710
Iteration 139, loss = 0.00036338
Iteration 140, loss = 0.00036074
Iteration 141, loss = 0.00035882
Iteration 142, loss = 0.00035598
Iteration 143, loss = 0.00035256
Iteration 144, loss = 0.00035070
Iteration 145, loss = 0.00034716
Iteration 146, loss = 0.00034526
Iteration 147, loss = 0.00034280
Iteration 148, loss = 0.00034004
Iteration 149, loss = 0.00033687
Iteration 150, loss = 0.00033497
Iteration 151, loss = 0.00033266
Iteration 152, loss = 0.00033007
Iteration 153, loss = 0.00032674
Iteration 154, loss = 0.00032515
Iteration 155, loss = 0.00032264
Iteration 156, loss = 0.00032025
Iteration 157, loss = 0.00031787
Iteration 158, loss = 0.00031550
Iteration 159, loss = 0.00031321
Iteration 160, loss = 0.00031111
Iteration 161, loss = 0.00030887
Iteration 162, loss = 0.00030647
Iteration 163, loss = 0.00030440
Iteration 164, loss = 0.00030210
Iteration 165, loss = 0.00029998
Iteration 166, loss = 0.00029799
Iteration 167, loss = 0.00029599
Iteration 168, loss = 0.00029329
Iteration 169, loss = 0.00029198
Iteration 170, loss = 0.00028985
Iteration 171, loss = 0.00028797
Iteration 172, loss = 0.00028543
Iteration 173, loss = 0.00028414
Iteration 174, loss = 0.00028232
Iteration 175, loss = 0.00028026
Iteration 176, loss = 0.00027795
Iteration 177, loss = 0.00027661
Iteration 178, loss = 0.00027498
Iteration 179, loss = 0.00027314
Iteration 180, loss = 0.00027131
Iteration 181, loss = 0.00026902
Iteration 182, loss = 0.00026788
Iteration 183, loss = 0.00026618
Iteration 184, loss = 0.00026437
Iteration 185, loss = 0.00026275
Iteration 186, loss = 0.00026046
Iteration 187, loss = 0.00025942
Iteration 188, loss = 0.00025776
Iteration 189, loss = 0.00025614
Iteration 190, loss = 0.00025453
Iteration 191, loss = 0.00025303
Iteration 192, loss = 0.00025140
Iteration 193, loss = 0.00024978
Iteration 194, loss = 0.00024834
Iteration 195, loss = 0.00024668
Iteration 196, loss = 0.00024530
Iteration 197, loss = 0.00024328
Iteration 198, loss = 0.00024234
Iteration 199, loss = 0.00024076
Iteration 200, loss = 0.00023888
Iteration 201, loss = 0.00023789
Iteration 202, loss = 0.00023645
Iteration 203, loss = 0.00023521
Iteration 204, loss = 0.00023379
Iteration 205, loss = 0.00023229
Iteration 206, loss = 0.00023090
Iteration 207, loss = 0.00022968
Iteration 208, loss = 0.00022815
Iteration 209, loss = 0.00022699
Iteration 210, loss = 0.00022521
Iteration 211, loss = 0.00022390
Iteration 212, loss = 0.00022310
Iteration 213, loss = 0.00022138
Iteration 214, loss = 0.00022054
Iteration 215, loss = 0.00021886
Iteration 216, loss = 0.00021803
Iteration 217, loss = 0.00021671
Iteration 218, loss = 0.00021511
Iteration 219, loss = 0.00021426
Iteration 220, loss = 0.00021315
Iteration 221, loss = 0.00021146
Iteration 222, loss = 0.00021073
Iteration 223, loss = 0.00020914
Iteration 224, loss = 0.00020838
Iteration 225, loss = 0.00020681
Iteration 226, loss = 0.00020611
Iteration 227, loss = 0.00020453
Iteration 228, loss = 0.00020380
Iteration 229, loss = 0.00020260
Iteration 230, loss = 0.00020114
Iteration 231, loss = 0.00020042
Iteration 232, loss = 0.00019936
Iteration 233, loss = 0.00019786
Iteration 234, loss = 0.00019711
Iteration 235, loss = 0.00019577
Iteration 236, loss = 0.00019511
Iteration 237, loss = 0.00019403
Iteration 238, loss = 0.00019264
Iteration 239, loss = 0.00019200
Iteration 240, loss = 0.00019096
Iteration 241, loss = 0.00018986
Iteration 242, loss = 0.00018890
Iteration 243, loss = 0.00018792
Iteration 244, loss = 0.00018681
Iteration 245, loss = 0.00018591
Iteration 246, loss = 0.00018490
Iteration 247, loss = 0.00018397
Iteration 248, loss = 0.00018272
Iteration 249, loss = 0.00018208
Iteration 250, loss = 0.00018116
Iteration 251, loss = 0.00018016
Iteration 252, loss = 0.00017927
Iteration 253, loss = 0.00017836
Iteration 254, loss = 0.00017739
Iteration 255, loss = 0.00017648
Iteration 256, loss = 0.00017534
Iteration 257, loss = 0.00017476
Iteration 258, loss = 0.00017361
Iteration 259, loss = 0.00017304
Iteration 260, loss = 0.00017209
Iteration 261, loss = 0.00017129
Iteration 262, loss = 0.00017039
Iteration 263, loss = 0.00016953
Iteration 264, loss = 0.00016871
Iteration 265, loss = 0.00016757
Iteration 266, loss = 0.00016704
Iteration 267, loss = 0.00016619
Iteration 268, loss = 0.00016540
Iteration 269, loss = 0.00016453
Iteration 270, loss = 0.00016373
Iteration 271, loss = 0.00016298
Iteration 272, loss = 0.00016192
Iteration 273, loss = 0.00016139
Iteration 274, loss = 0.00016064
Iteration 275, loss = 0.00015979
Iteration 276, loss = 0.00015883
Iteration 277, loss = 0.00015834
Iteration 278, loss = 0.00015732
Iteration 279, loss = 0.00015684
Iteration 280, loss = 0.00015604
Iteration 281, loss = 0.00015510
Iteration 282, loss = 0.00015460
Iteration 283, loss = 0.00015391
Iteration 284, loss = 0.00015316
Iteration 285, loss = 0.00015238
Iteration 286, loss = 0.00015171
Iteration 287, loss = 0.00015092
Iteration 288, loss = 0.00015030
Iteration 289, loss = 0.00014955
Training loss did not improve more than tol=0.000001 for 10 consecutive epochs. Stopping.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's see how the loss function improved over the different epochs for the training set</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lc</span><span class="o">=</span><span class="n">nnmodelfitS</span><span class="o">.</span><span class="n">loss_curve_</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lc</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch #&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;In-sample Loss Curve&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_304_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>Let's see how the in-sample and out-of-sample error changes after each epoch</strong>
Using different network architectures and settings</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Nx</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">XtrainS</span><span class="p">)</span>
<span class="n">nn1</span> <span class="o">=</span> <span class="n">neural_network</span><span class="o">.</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">50</span> <span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                       <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">Nx</span><span class="p">)</span>


<span class="n">K</span><span class="o">=</span><span class="mi">400</span>
<span class="n">classes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">)</span>
<span class="n">Ein</span><span class="o">=</span><span class="p">[]</span>
<span class="n">Eout</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">nn1</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">XtrainS</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
    <span class="n">Ein</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nn1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">XtrainS</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">))</span>
    <span class="n">Eout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nn1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">XtestS</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ein</span><span class="p">,</span><span class="s1">&#39;-b&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Eout</span><span class="p">,</span><span class="s1">&#39;-r&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch #&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;In-Sample vs Out-of-Sample Error&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;E_in&#39;</span><span class="p">,</span> <span class="s1">&#39;E_out&#39;</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[33]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[0, 400, 0, 0.1]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_307_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Overfitting happens when $E_{out}$ increases while $E_{in}$ decreases</em></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overfitting-Example-:-Polynomials">Overfitting Example : Polynomials<a class="anchor-link" href="#Overfitting-Example-:-Polynomials">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">eval_legendre</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">evaluateRandPoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">coeff</span><span class="p">):</span>
    <span class="n">d</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
    <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="n">coeff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">eval_legendre</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">Pol</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the 1 dimensional input data x</span>
<span class="sd">    transform that data to [1, x, x^2, ..., x^p]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">Z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">Z</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Z</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong>Legendre Polynomials</strong>
We are going to generate random polynomials of a given degree using Legendre polynomials as a basis</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">figl</span><span class="p">,</span> <span class="n">axl</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">t1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">d</span><span class="o">=</span><span class="mi">5</span>
<span class="n">yy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">d</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t1</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">=</span><span class="n">eval_legendre</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">t1</span><span class="p">)</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$P_</span><span class="si">{}</span><span class="s1">(x)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Legendre Polynomials&#39;</span><span class="p">)</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">yy</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">+</span><span class="mf">0.4</span><span class="o">*</span><span class="n">yy</span><span class="p">[</span><span class="mi">4</span><span class="p">,:])</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;60/40 mixture of $P_1$ and $P_4$&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">alpha</span> <span class="o">@</span> <span class="n">alpha</span><span class="p">)</span>
<span class="n">zz</span><span class="o">=</span>  <span class="n">alpha</span> <span class="o">@</span> <span class="n">yy</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">zz</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Random mixture of $P_0$ through $P_4$&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_313_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Effect-of-Noise-in-Overfitting">Effect of Noise in Overfitting<a class="anchor-link" href="#Effect-of-Noise-in-Overfitting">&#182;</a></h3><ul>
<li>Generate a random polynomial of degree 10</li>
<li>Draw 15 points as a training set</li>
<li>Add different levels of noise</li>
<li>Learn using two models: second degree polynomials and 10th degree polynomials</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">degree</span><span class="o">=</span><span class="mi">10</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">w</span> <span class="o">@</span> <span class="n">w</span><span class="p">))</span>
<span class="n">lb</span><span class="o">=-</span><span class="mf">0.9</span>
<span class="n">ub</span><span class="o">=</span><span class="mf">0.9</span>

<span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="o">+</span><span class="n">lb</span>
<span class="n">t</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">yt</span><span class="o">=</span><span class="n">evaluateRandPoly</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

<span class="n">N</span><span class="o">=</span><span class="mi">15</span>
<span class="n">sigma</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="n">lb</span>
<span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="n">evaluateRandPoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">)</span>



<span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Target d=</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>,&#39;Data&#39;])
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\sigma = $ </span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">sigma</span>[i])
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_315_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d1</span><span class="o">=</span><span class="mi">2</span>
<span class="n">Z1</span><span class="o">=</span><span class="n">Pol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">d1</span><span class="p">)</span>
<span class="n">T1</span><span class="o">=</span><span class="n">Pol</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">d1</span><span class="p">)</span>
<span class="n">G1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">sol1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">w1</span><span class="o">=</span><span class="n">sol1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">G1</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">=</span><span class="n">T1</span> <span class="o">@</span> <span class="n">w1</span>


<span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">ax4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">G1</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Target d=</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>,&#39;Data&#39;, &#39;Fit d=%.0f&#39;%d1])
    <span class="n">ax4</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\sigma = $ </span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">sigma</span>[i])
 
<span class="n">d2</span><span class="o">=</span><span class="mi">10</span>
<span class="n">Z2</span><span class="o">=</span><span class="n">Pol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">d2</span><span class="p">)</span>
<span class="n">T2</span><span class="o">=</span><span class="n">Pol</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">d2</span><span class="p">)</span>
<span class="n">G2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">sol20</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">w20</span><span class="o">=</span><span class="n">sol20</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">G2</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">=</span><span class="n">T2</span> <span class="o">@</span> <span class="n">w20</span>


<span class="n">fig5</span><span class="p">,</span> <span class="n">ax5</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">ax5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
    <span class="n">ax5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">G2</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">ax5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Target d=</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>,&#39;Data&#39;, &#39;Fit d=%.0f&#39;%d2])
    <span class="n">ax5</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\sigma = $ </span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">sigma</span>[i])
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_316_0.png"
>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_316_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Effect-of-Target-Complexity-in-Overfitting">Effect of Target Complexity in Overfitting<a class="anchor-link" href="#Effect-of-Target-Complexity-in-Overfitting">&#182;</a></h3><ul>
<li>Generate a random polynomials of various degrees</li>
<li>Draw 15 points as a training set</li>
<li>Learn using two models: second degree polynomials and 10th degree polynomials</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">degs</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span>
<span class="n">K</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">degs</span><span class="p">)</span>
<span class="n">fig6</span><span class="p">,</span> <span class="n">ax6</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">K</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">fig7</span><span class="p">,</span> <span class="n">ax7</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">K</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    
    <span class="n">degree</span><span class="o">=</span><span class="n">degs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">w</span> <span class="o">@</span> <span class="n">w</span><span class="p">))</span>
    <span class="n">lb</span><span class="o">=-</span><span class="mf">0.9</span>
    <span class="n">ub</span><span class="o">=</span><span class="mf">0.9</span>

    <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="o">+</span><span class="n">lb</span>
    <span class="n">t</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">yt</span><span class="o">=</span><span class="n">evaluateRandPoly</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

    <span class="n">N</span><span class="o">=</span><span class="mi">15</span>
    <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="n">lb</span>
    <span class="n">YY</span><span class="o">=</span><span class="n">evaluateRandPoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

    
    <span class="n">d1</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">Z1</span><span class="o">=</span><span class="n">Pol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">d1</span><span class="p">)</span>
    <span class="n">T1</span><span class="o">=</span><span class="n">Pol</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">d1</span><span class="p">)</span>
    <span class="n">sol1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Z1</span><span class="p">,</span><span class="n">YY</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">w1</span><span class="o">=</span><span class="n">sol1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">G1</span><span class="o">=</span><span class="n">T1</span> <span class="o">@</span> <span class="n">w1</span>


    <span class="n">ax6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">YY</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">G1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Target d=</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>,&#39;Data&#39;, &#39;Fit d=%.0f&#39;%d1])
    <span class="n">ax6</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Polynomial of Degree </span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>)
    
    <span class="n">d2</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">Z2</span><span class="o">=</span><span class="n">Pol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">d2</span><span class="p">)</span>
    <span class="n">T2</span><span class="o">=</span><span class="n">Pol</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">d2</span><span class="p">)</span>
    
    <span class="n">sol20</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span><span class="n">YY</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">w20</span><span class="o">=</span><span class="n">sol20</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">G2</span><span class="o">=</span><span class="n">T2</span> <span class="o">@</span> <span class="n">w20</span>


    <span class="n">ax7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">YY</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
    <span class="n">ax7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">G2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">ax7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Target d=</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>,&#39;Data&#39;, &#39;Fit d=%.0f&#39;%d2])
    <span class="n">ax7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Polynomial of Degree </span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_318_0.png"
>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_318_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Regularization">Regularization<a class="anchor-link" href="#Regularization">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">neural_network</span><span class="p">,</span><span class="n">linear_model</span><span class="p">,</span> <span class="n">model_selection</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regularization-in-Neural-Networks">Regularization in Neural Networks<a class="anchor-link" href="#Regularization-in-Neural-Networks">&#182;</a></h2><p><strong>Using the Wisconsin Breast Cancer dataset</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bcw</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">()</span>

<span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)</span><span class="o">=</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">bcw</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">bcw</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the training set X data : &quot;</span><span class="p">,</span> <span class="n">Xtrain</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the testing set X data : &quot;</span><span class="p">,</span> <span class="n">Xtest</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the training set X data :  (398, 30) 

Dimensions of the testing set X data :  (171, 30) 

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span> 
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
<span class="n">XtrainS</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span> 
<span class="n">XtestS</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p><strong>Using a network with 1 hidden layer of 10 perceptrons</strong></p>
<blockquote><p>~320 parameters (30 inputs x 10 hidden perceptrons x 1 output perceptron + biases)</p>
</blockquote>
</li>
<li><p>Batch gradient descent with regularization parameter <em>alpha2</em> in a range of values</p>
<blockquote><p>take the results with a grain of salt.  The split of the data provides a lot of randomness</p>
</blockquote>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">AK</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">alpha2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">AK</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">AK</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">Nx</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">XtrainS</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">AK</span><span class="p">):</span>
    <span class="n">reg_alpha</span><span class="o">=</span><span class="n">alpha2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>


    <span class="n">nn1</span> <span class="o">=</span> <span class="n">neural_network</span><span class="o">.</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span> <span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">reg_alpha</span><span class="p">,</span>
                                           <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">Nx</span><span class="p">)</span>


    <span class="n">K</span><span class="o">=</span><span class="mi">200</span>
    <span class="n">classes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">)</span>
    <span class="n">Ein</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">Eout</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">nn1</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">XtrainS</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
        <span class="n">Ein</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nn1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">XtrainS</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)))</span>
        <span class="n">Eout</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nn1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">XtestS</span><span class="p">,</span> <span class="n">Ytest</span><span class="p">)))</span>
        
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ein</span><span class="p">,</span><span class="s1">&#39;-b&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Eout</span><span class="p">,</span><span class="s1">&#39;-r&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch #&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\lambda$=</span><span class="si">%.3f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">reg_alpha</span>)
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;E_in&#39;</span><span class="p">,</span> <span class="s1">&#39;E_out&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_326_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regularization-Example-:-Polynomials">Regularization Example : Polynomials<a class="anchor-link" href="#Regularization-Example-:-Polynomials">&#182;</a></h2><p><a href="https://scikit-learn.org/stable/modules/linear_model.html#ridge-regression-and-classification">https://scikit-learn.org/stable/modules/linear_model.html#ridge-regression-and-classification</a></p>
<ul>
<li>Using Ridge regression (L2 regularization).  There are better regularizers, but just illustrating the point. </li>
<li>A bit different from what I showed in class.  I will be using the Lengrendre polynomials for the nonlinear transformation</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">eval_legendre</span>
<span class="k">def</span> <span class="nf">evaluateRandPoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">coeff</span><span class="p">):</span>
    <span class="n">d</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
    <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="n">coeff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">eval_legendre</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">LPol</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the 1 dimensional input data x</span>
<span class="sd">    transform that data to [1, x, x^2, ..., x^p]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">Z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">Z</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">eval_legendre</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Z</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Illustration-of-Legendre-polynomials">Illustration of Legendre polynomials<a class="anchor-link" href="#Illustration-of-Legendre-polynomials">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">figl</span><span class="p">,</span> <span class="n">axl</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">t1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">d</span><span class="o">=</span><span class="mi">5</span>
<span class="n">yy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">d</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t1</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">=</span><span class="n">eval_legendre</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">t1</span><span class="p">)</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">yy</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$L_</span><span class="si">{}</span><span class="s1">(x)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Legendre Polynomials&#39;</span><span class="p">)</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">axl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">yy</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">+</span><span class="mf">0.4</span><span class="o">*</span><span class="n">yy</span><span class="p">[</span><span class="mi">4</span><span class="p">,:])</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;60/40 mixture of $L_1$ and $L_4$&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
<span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">alpha</span> <span class="o">@</span> <span class="n">alpha</span><span class="p">)</span>
<span class="n">zz</span><span class="o">=</span>  <span class="n">alpha</span> <span class="o">@</span> <span class="n">yy</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">zz</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Random mixture of $L_0$ through $L_4$&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">axl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_330_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Noisy-Data">Noisy Data<a class="anchor-link" href="#Noisy-Data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">degree</span><span class="o">=</span><span class="mi">10</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">w</span> <span class="o">@</span> <span class="n">w</span><span class="p">))</span>
<span class="n">lb</span><span class="o">=-</span><span class="mf">0.9</span>
<span class="n">ub</span><span class="o">=</span><span class="mf">0.9</span>

<span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="o">+</span><span class="n">lb</span>
<span class="n">t</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">yt</span><span class="o">=</span><span class="n">evaluateRandPoly</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

<span class="n">N</span><span class="o">=</span><span class="mi">15</span>
<span class="n">sigma</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="n">lb</span>
<span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="n">evaluateRandPoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sigma</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">)</span>

<span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Target d=</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>,&#39;Data&#39;])
    <span class="n">ax3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\sigma = $ </span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">sigma</span>[i])
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_332_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rg_lambda</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">KK</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">rg_lambda</span><span class="p">)</span>
<span class="n">fig5</span><span class="p">,</span> <span class="n">ax5</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">KK</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">KK</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">KK</span><span class="p">):</span>
    <span class="n">lam</span><span class="o">=</span><span class="n">rg_lambda</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">d2</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">Z2</span><span class="o">=</span><span class="n">LPol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">d2</span><span class="p">)</span>
    <span class="n">T2</span><span class="o">=</span><span class="n">LPol</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">d2</span><span class="p">)</span>
    <span class="n">G2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
        <span class="n">w20</span><span class="o">=</span><span class="n">reg</span><span class="o">.</span><span class="n">coef_</span>
        <span class="n">G2</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">=</span><span class="n">T2</span> <span class="o">@</span> <span class="n">w20</span>



    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">ax5</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">ax5</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
        <span class="n">ax5</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">ax5</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">G2</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="n">KK</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ax5</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span> 
            <span class="n">ax5</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\lambda$=</span><span class="si">%1.4f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">lam</span>)
        <span class="n">ax5</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax5</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Target d=</span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>,&#39;Data&#39;, &#39;Fit&#39;])
        <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">ax5</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\sigma = $ </span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">sigma</span>[i])
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_333_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="High-Order-Polynomial-Data">High Order Polynomial Data<a class="anchor-link" href="#High-Order-Polynomial-Data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rg_lambda</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">degs</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">K</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">degs</span><span class="p">)</span>
<span class="n">KK</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">rg_lambda</span><span class="p">)</span>
<span class="n">fig7</span><span class="p">,</span> <span class="n">ax7</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">KK</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">K</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">KK</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">Err</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">KK</span><span class="p">,</span> <span class="n">K</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">degree</span><span class="o">=</span><span class="n">degs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">w</span> <span class="o">@</span> <span class="n">w</span><span class="p">))</span>
    <span class="n">lb</span><span class="o">=-</span><span class="mf">0.9</span>
    <span class="n">ub</span><span class="o">=</span><span class="mf">0.9</span>

    <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="o">+</span><span class="n">lb</span>
    <span class="n">t</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">yt</span><span class="o">=</span><span class="n">evaluateRandPoly</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

    <span class="n">N</span><span class="o">=</span><span class="mi">15</span>
    <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="n">ub</span><span class="o">-</span><span class="n">lb</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="n">lb</span>
    <span class="n">YY</span><span class="o">=</span><span class="n">evaluateRandPoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>

    <span class="n">d2</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">Z2</span><span class="o">=</span><span class="n">LPol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">d2</span><span class="p">)</span>
    <span class="n">T2</span><span class="o">=</span><span class="n">LPol</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">d2</span><span class="p">)</span>
   
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">KK</span><span class="p">):</span>
        <span class="n">lam</span><span class="o">=</span><span class="n">rg_lambda</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
  
        <span class="n">regc</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">regc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Z2</span><span class="p">,</span> <span class="n">YY</span><span class="p">)</span>
        <span class="n">w20c</span><span class="o">=</span><span class="n">regc</span><span class="o">.</span><span class="n">coef_</span>
        <span class="n">G2</span><span class="o">=</span><span class="n">T2</span> <span class="o">@</span> <span class="n">w20c</span>

        <span class="n">Err</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">yt</span><span class="o">-</span><span class="n">G2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax7</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">ax7</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">YY</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
        <span class="n">ax7</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">ax7</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">G2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">==</span><span class="n">KK</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ax7</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span> 
            <span class="n">ax7</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\lambda$=</span><span class="si">%1.4f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">lam</span>)
        <span class="n">ax7</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax7</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Target&#39;</span><span class="p">,</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Fit&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">ax7</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Polynomial of Degree </span><span class="si">%.0f</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">degree</span>)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_335_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig8</span><span class="p">,</span> <span class="n">ax8</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ax8</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rg_lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">Err</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$d_{</span><span class="si">%.0f</span><span class="s1">}(x)$&#39;</span><span class="o">%</span><span class="k">degs</span>[i])
    <span class="n">ax8</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">ax8</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax8</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax8</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\lambda$&#39;</span><span class="p">)</span>
    <span class="n">ax8</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$E_</span><span class="si">{out}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax8</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax8</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_336_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="SVMs-and-Cross-Validation">SVMs and Cross Validation<a class="anchor-link" href="#SVMs-and-Cross-Validation">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-Some-Synthetic-Data">Generate Some Synthetic Data<a class="anchor-link" href="#Generate-Some-Synthetic-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">100</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span>
<span class="n">Y</span><span class="o">=</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[29]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;$x_2$&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_341_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Splitting-the-Data-for-Cross-Validation">Splitting the Data for Cross Validation<a class="anchor-link" href="#Splitting-the-Data-for-Cross-Validation">&#182;</a></h2><p>10 fold cross validation</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c1">#generate a random permutation</span>
<span class="n">m</span><span class="o">=</span><span class="n">N</span><span class="o">/</span><span class="mi">10</span> <span class="c1">#the size of the validation set</span>
<span class="n">figc</span><span class="p">,</span> <span class="n">axc</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  
    <span class="n">lb</span><span class="o">=</span><span class="n">k</span><span class="o">*</span><span class="n">m</span>  
    <span class="n">ub</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span> 
    <span class="c1">#lb and ub establish a range for the indexes to be included in the validation set</span>
    <span class="c1">#e.g. N=100, m=10</span>
    <span class="c1"># k=0 -&gt;   lb=0, ub=10</span>
    <span class="c1"># k=1 -&gt;   lb=10, ub=20 etc.</span>
    
    
    <span class="n">valind</span><span class="o">=</span><span class="p">(</span><span class="n">tt</span><span class="o">&lt;</span><span class="n">ub</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tt</span><span class="o">&gt;=</span><span class="n">lb</span><span class="p">)</span> <span class="c1">#indexes of the points in the validation set (true if it falls in the range)</span>
    <span class="n">trainind</span><span class="o">=~</span><span class="p">(</span><span class="n">valind</span><span class="p">)</span> <span class="c1">#indexes of the points in the training set</span>
 
    <span class="n">Xval</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">valind</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">Yval</span><span class="o">=</span><span class="n">Y</span><span class="p">[</span><span class="n">valind</span><span class="p">]</span>  <span class="c1">#the validation set</span>
    <span class="n">Xtrain</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">trainind</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">Ytrain</span><span class="o">=</span><span class="n">Y</span><span class="p">[</span><span class="n">trainind</span><span class="p">]</span>  <span class="c1">#the training set (both depend on k, so will get 10 different ones)</span>
    
    <span class="c1">#now we have a 9:1 split of the data into train and validation sets</span>
    <span class="c1">#for each k, we get a different split</span>
    
    <span class="c1">#let&#39;s try doing smth, like plotting</span>
    
    <span class="n">axc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
    <span class="n">axc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
    <span class="n">axc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xval</span><span class="p">[</span><span class="n">Yval</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xval</span><span class="p">[</span><span class="n">Yval</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;k+&#39;</span><span class="p">)</span>
    <span class="n">axc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xval</span><span class="p">[</span><span class="n">Yval</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xval</span><span class="p">[</span><span class="n">Yval</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ko&#39;</span><span class="p">)</span>
    <span class="c1">#black are the point in the validation set</span>
    <span class="n">axc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">axc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_343_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SVM-with-Linear-Kernel">SVM with Linear Kernel<a class="anchor-link" href="#SVM-with-Linear-Kernel">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">=</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">10e6</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
<span class="n">g</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xval</span><span class="p">)</span>
<span class="n">sv</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">support_vectors_</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ww</span><span class="o">=</span><span class="p">[</span><span class="n">clf</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">y_svm</span><span class="o">=-</span><span class="p">(</span><span class="n">ww</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">ww</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">ww</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">yt</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y_svm</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;kx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xval</span><span class="p">[</span><span class="n">g</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xval</span><span class="p">[</span><span class="n">g</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;m+&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xval</span><span class="p">[</span><span class="n">g</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xval</span><span class="p">[</span><span class="n">g</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;go&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[32]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1bb7f974948&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_346_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">err</span><span class="o">=</span><span class="p">[]</span>
<span class="n">nv</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  
    <span class="n">lb</span><span class="o">=</span><span class="n">k</span><span class="o">*</span><span class="n">m</span>  
    <span class="n">ub</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">m</span> 
    <span class="c1">#lb and ub establish a range for the indexes to be included in the validation set</span>
    <span class="c1">#e.g. N=400, m=40</span>
    <span class="c1"># k=0 -&gt;   lb=0, ub=40</span>
    <span class="c1"># k=1 -&gt;   lb=40, ub=80 etc.</span>
    
    
    <span class="n">valind</span><span class="o">=</span><span class="p">(</span><span class="n">tt</span><span class="o">&lt;</span><span class="n">ub</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tt</span><span class="o">&gt;=</span><span class="n">lb</span><span class="p">)</span> <span class="c1">#indexes of the points in the validation set (true if it falls in the range)</span>
    <span class="n">trainind</span><span class="o">=~</span><span class="p">(</span><span class="n">valind</span><span class="p">)</span> <span class="c1">#indexes of the points in the training set</span>
 
    <span class="n">Xval</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">valind</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">Yval</span><span class="o">=</span><span class="n">Y</span><span class="p">[</span><span class="n">valind</span><span class="p">]</span>  <span class="c1">#the validation set</span>
    <span class="n">Xtrain</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">trainind</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">Ytrain</span><span class="o">=</span><span class="n">Y</span><span class="p">[</span><span class="n">trainind</span><span class="p">]</span>  <span class="c1">#the training set (both depend on k, so will get 10 different ones)</span>
    <span class="n">clf</span><span class="o">=</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">10e6</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">)</span>
    <span class="n">g</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xval</span><span class="p">)</span>
    <span class="n">sv</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">support_vectors_</span>
    <span class="n">err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">g</span><span class="o">!=</span><span class="n">Yval</span><span class="p">))</span>
    <span class="n">nv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">n_support_</span><span class="p">))</span>
    
    <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ww</span><span class="o">=</span><span class="p">[</span><span class="n">clf</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">y_svm</span><span class="o">=-</span><span class="p">(</span><span class="n">ww</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">ww</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">ww</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">yt</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y_svm</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;kx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtrain</span><span class="p">[</span><span class="n">Ytrain</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xval</span><span class="p">[</span><span class="n">g</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xval</span><span class="p">[</span><span class="n">g</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;m+&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xval</span><span class="p">[</span><span class="n">g</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xval</span><span class="p">[</span><span class="n">g</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;go&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_347_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">nv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nv</span><span class="p">)</span>
<span class="n">err</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nv</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Validation Error&quot;</span><span class="p">,</span> <span class="s1">&#39;SV-based Error Estimate&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[34]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1bb016642c8&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_348_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clfg</span><span class="o">=</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">10e6</span><span class="p">)</span>
<span class="n">clfg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ww</span><span class="o">=</span><span class="p">[</span><span class="n">clfg</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">clfg</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">clfg</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">y_svm</span><span class="o">=-</span><span class="p">(</span><span class="n">ww</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">ww</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">ww</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">yt</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="n">sv</span><span class="o">=</span><span class="n">clfg</span><span class="o">.</span><span class="n">support_vectors_</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;kx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y_svm</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">2.1</span><span class="p">,</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">2.1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[35]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[-2.1, 2.1, -2.1, 2.1]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_349_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">NN</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">XX</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">NN</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span>
<span class="n">YY</span><span class="o">=</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">XX</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">XX</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">GG</span><span class="o">=</span><span class="p">((</span><span class="n">ww</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">ww</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">XX</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">ww</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">XX</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Eout</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">YY</span><span class="o">!=</span><span class="n">GG</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eout         : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span> <span class="p">(</span><span class="n">Eout</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SV  estimate : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">n_support_</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CV  estimate : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">N</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Eout         : 1.8 %
SV  estimate : 3.0 %
CV  estimate : 1.0 %
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="SVMs-and-Kernel-Methods">SVMs and Kernel Methods<a class="anchor-link" href="#SVMs-and-Kernel-Methods">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-Some-Synthetic-Data">Generate Some Synthetic Data<a class="anchor-link" href="#Generate-Some-Synthetic-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">100</span>
<span class="n">Ntest</span><span class="o">=</span><span class="mi">100000</span>
<span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span>
<span class="n">Xtest</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">Ntest</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span>
<span class="n">tt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">q</span><span class="o">=</span><span class="mi">3</span>
<span class="n">Y</span><span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">3.7</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Ytest</span><span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">3.7</span><span class="o">*</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Ytt</span><span class="o">=</span><span class="mf">3.7</span><span class="o">*</span><span class="p">(</span><span class="n">tt</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">tt</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">Ytt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;$x_2$&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_355_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SVMs-with-RBF-Kernel">SVMs with RBF Kernel<a class="anchor-link" href="#SVMs-with-RBF-Kernel">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">=</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">10e6</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">gtest</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
<span class="n">sv</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">support_vectors_</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">Ytt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b894ca8d08&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_358_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">Ytt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b89563c608&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_359_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Eout</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Ytest</span><span class="o">!=</span><span class="n">gtest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eout         : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span> <span class="p">(</span><span class="n">Eout</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SV  estimate : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">n_support_</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Eout         : 4.6 %
SV  estimate : 9.1 %
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Soft-Threshold-SVMs">Soft Threshold SVMs<a class="anchor-link" href="#Soft-Threshold-SVMs">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Generate-some-data">Generate some data<a class="anchor-link" href="#Generate-some-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">100</span>
<span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span>
<span class="n">Y</span><span class="o">=</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>

<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">yt</span><span class="o">=-</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">Y</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">=-</span><span class="n">Y</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">2.1</span><span class="p">,</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">2.1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[-2.1, 2.1, -2.1, 2.1]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_363_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Soft-Threshold">Soft Threshold<a class="anchor-link" href="#Soft-Threshold">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">maxC</span><span class="o">=</span><span class="mf">10e1</span>
<span class="n">clf</span><span class="o">=</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">maxC</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">sv</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">support_vectors_</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">dual_coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">maxC</span>
<span class="n">sv1</span><span class="o">=</span><span class="n">sv</span><span class="p">[</span><span class="n">f1</span><span class="p">,:]</span>
<span class="n">sv2</span><span class="o">=</span><span class="n">sv</span><span class="p">[</span><span class="n">f1</span><span class="o">&lt;</span><span class="mf">0.5</span><span class="p">,:]</span>
<span class="n">ww</span><span class="o">=</span><span class="p">[</span><span class="n">clf</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">y_svm</span><span class="o">=-</span><span class="p">(</span><span class="n">ww</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">ww</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">ww</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Margin SV&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Non-margin SV&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y_svm</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">2.1</span><span class="p">,</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">2.1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b896ad6788&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_366_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ntest</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">Xtest</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">Ntest</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span>
<span class="n">Ytest</span><span class="o">=</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">gtest</span><span class="o">=</span><span class="p">((</span><span class="n">ww</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">ww</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">ww</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Eout</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Ytest</span><span class="o">!=</span><span class="n">gtest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eout               : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span> <span class="p">(</span><span class="n">Eout</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# of margin SV     : </span><span class="si">%.0f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sv1</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# of non-margin SV : </span><span class="si">%.0f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sv2</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Eout               : 3.0 %
# of margin SV     : 3
# of non-margin SV : 27
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Notes-on-Unsupervised-Learning">Notes on Unsupervised Learning<a class="anchor-link" href="#Notes-on-Unsupervised-Learning">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Let's-generate-some-data">Let's generate some data<a class="anchor-link" href="#Let's-generate-some-data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">200</span>
<span class="n">K</span><span class="o">=</span><span class="mi">4</span>
<span class="n">centers</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">15</span>
<span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">X</span><span class="p">[</span><span class="n">labels</span><span class="o">==</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">-=</span><span class="n">centers</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
   

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2"> Random Clusters&quot;</span><span class="o">%</span><span class="k">K</span>)


<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">labels</span><span class="o">==</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">labels</span><span class="o">==</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2"> Random Clusters&quot;</span><span class="o">%</span><span class="k">K</span>)
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b896ba4b08&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_372_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Lloyd's-Algorithm">Lloyd's Algorithm<a class="anchor-link" href="#Lloyd's-Algorithm">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Step -0 Pick K random centers</span>
<span class="n">ri</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
<span class="n">S</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">ri</span><span class="p">[</span><span class="n">i</span><span class="p">],:]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2"> Random Clusters&quot;</span><span class="o">%</span><span class="k">K</span>)

<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">markersize</span><span class="o">=</span><span class="mi">7</span> <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2"> Random Clusters&quot;</span><span class="o">%</span><span class="k">K</span>)
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[21]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b898466408&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_374_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># step 1 - update the cluster memberships</span>
<span class="n">newlabels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">newlabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">S</span><span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">markersize</span><span class="o">=</span><span class="mi">7</span> <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;k.&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2"> Random Clusters&quot;</span><span class="o">%</span><span class="k">K</span>)
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">newlabels</span><span class="o">==</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">newlabels</span><span class="o">==</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;PC &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0f</span><span class="s2"> Random Clusters&quot;</span><span class="o">%</span><span class="k">K</span>)


<span class="c1"># step 2 - update the cluster means</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,:]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">newlabels</span><span class="o">==</span><span class="n">j</span><span class="p">,</span> <span class="p">:],</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;NC &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[22]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b8985a7c08&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_375_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Run the code in cell above until it converges</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Illustrating-Sampling-Bias-(using-SVMs)">Illustrating Sampling Bias (using SVMs)<a class="anchor-link" href="#Illustrating-Sampling-Bias-(using-SVMs)">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-Synthetic-Data">Generate Synthetic Data<a class="anchor-link" href="#Generate-Synthetic-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">200</span>
<span class="n">Ntest</span><span class="o">=</span><span class="mi">100000</span>
<span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span>   <span class="c1">#Training examples</span>
<span class="n">Xtest</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">Ntest</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span>  <span class="c1">#Test examples</span>
<span class="n">tt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">q</span><span class="o">=</span><span class="mi">3</span>
<span class="n">Y</span><span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">3.7</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Ytest</span><span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">3.7</span><span class="o">*</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">Ytt</span><span class="o">=</span><span class="mf">3.7</span><span class="o">*</span><span class="p">(</span><span class="n">tt</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">tt</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r+&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="c1">#ax[0].plot(tt,Ytt,&#39;g&#39;, label=&quot;target&quot;)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1">#ax[1].plot(tt,Ytt,&#39;g&#39;, label=&quot;target&quot;)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_381_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SVM-with-RBF-Kernel">SVM with RBF Kernel<a class="anchor-link" href="#SVM-with-RBF-Kernel">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">=</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">10e6</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">gtest</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
<span class="n">sv</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">support_vectors_</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">Ytt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b8987c63c8&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_384_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">Ytt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[27]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b898843048&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_385_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Eout</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Ytest</span><span class="o">!=</span><span class="n">gtest</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eout         : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span> <span class="p">(</span><span class="n">Eout</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SV  estimate : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">n_support_</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Eout         : 2.2 %
SV  estimate : 4.5 %
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Sampling-Bias">Sampling Bias<a class="anchor-link" href="#Sampling-Bias">&#182;</a></h2><p><strong>The training examples are drawn from a different distribution than the testing examples</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N2</span><span class="o">=</span><span class="mi">200</span>
<span class="n">X2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span>  <span class="c1">#Training examples drawn from a different distribution than test examples</span>
<span class="n">Y2</span><span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">3.7</span><span class="o">*</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">X2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">q</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

<span class="n">fig3</span><span class="p">,</span> <span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1">#ax3[0].plot(tt,Ytt,&#39;g&#39;, label=&quot;target&quot;)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">Ytest</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1">#ax3[1].plot(tt,Ytt,&#39;g&#39;, label=&quot;target&quot;)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_388_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf2</span><span class="o">=</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">10e6</span><span class="p">)</span>
<span class="n">clf2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">)</span>
<span class="n">gtest2</span><span class="o">=</span><span class="n">clf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>
<span class="n">sv2</span><span class="o">=</span><span class="n">clf2</span><span class="o">.</span><span class="n">support_vectors_</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig4</span><span class="p">,</span> <span class="n">ax4</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">Ytt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">X2</span><span class="p">[</span><span class="n">Y2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">Ytt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[31]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b89bdea908&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_390_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig5</span><span class="p">,</span> <span class="n">ax5</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">Ytt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x_2$&quot;</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax5</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xtest</span><span class="p">[</span><span class="n">gtest2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sv2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">sv2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Support Vectors&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span><span class="n">Ytt</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x_1$&quot;</span><span class="p">)</span>
<span class="n">ax5</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[32]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x1b89bee3c88&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_391_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Eout2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Ytest</span><span class="o">!=</span><span class="n">gtest2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Eout         : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span> <span class="p">(</span><span class="n">Eout2</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SV  estimate : </span><span class="si">%.1f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">clf2</span><span class="o">.</span><span class="n">n_support_</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="p">(</span><span class="n">N2</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Eout         : 7.9 %
SV  estimate : 5.0 %
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Input-Processing">Input Processing<a class="anchor-link" href="#Input-Processing">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate-Some-Toy-Data">Generate Some Toy Data<a class="anchor-link" href="#Generate-Some-Toy-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sig1</span><span class="o">=</span><span class="mi">2</span>
<span class="n">mu1</span><span class="o">=</span><span class="mi">4</span>
<span class="n">sig2</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">mu2</span><span class="o">=-</span><span class="mi">2</span>
<span class="n">N</span><span class="o">=</span><span class="mi">200</span>
<span class="n">x1o</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span><span class="n">sig1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="n">x2o</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu2</span><span class="p">,</span><span class="n">sig2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span>
<span class="n">x1</span><span class="o">=</span><span class="n">x1o</span>
<span class="n">x2</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">x1o</span><span class="o">+</span><span class="n">alpha</span><span class="o">*</span><span class="n">x2o</span>

<span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;raw input&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(200, 2)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;raw input&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_397_2.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Input-Centering">Input Centering<a class="anchor-link" href="#Input-Centering">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">meanx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Xc</span><span class="o">=</span><span class="n">X</span><span class="o">-</span><span class="n">meanx</span>
<span class="nb">print</span><span class="p">(</span><span class="n">meanx</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[3.855663   2.10701488]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;raw input&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;centered&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[-10, 10, -10, 10]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_400_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Input-Normalization">Input Normalization<a class="anchor-link" href="#Input-Normalization">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stdx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Xc</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Xn</span><span class="o">=</span><span class="n">Xc</span><span class="o">/</span><span class="n">stdx</span>

<span class="nb">print</span><span class="p">(</span><span class="n">stdx</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[1.94444334 1.35496944]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;raw input&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;centered&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xn</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xn</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;normalized&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[-10, 10, -10, 10]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_403_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Input-Whitening">Input Whitening<a class="anchor-link" href="#Input-Whitening">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Sig</span><span class="o">=</span><span class="n">Xc</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">Xc</span><span class="o">/</span><span class="n">N</span>
<span class="n">Phi</span><span class="o">=</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">linalg</span><span class="o">.</span><span class="n">sqrtm</span><span class="p">(</span><span class="n">Sig</span><span class="p">))</span>
<span class="n">Z</span><span class="o">=</span>  <span class="n">Xc</span> <span class="o">@</span> <span class="n">Phi</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Phi&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Phi
[[ 3.05772942 -3.78909693]
 [-3.78909693  5.87059128]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;raw input&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;centered&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xn</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">Xn</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;normalized&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Z</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">Z</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$z_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;whitened&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[-10, 10, -10, 10]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_406_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x_bar : &#39;</span><span class="p">,</span> <span class="n">meanx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Transformation :&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Covariance matrix of Z&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">T</span><span class="nd">@Z</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>x_bar :  [3.855663   2.10701488]
Transformation :
[[ 3.05772942 -3.78909693]
 [-3.78909693  5.87059128]]
Covariance matrix of Z
[[ 1.00000000e+00 -5.48971447e-14]
 [-5.48971447e-14  1.00000000e+00]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="PCA-and-SVD">PCA and SVD<a class="anchor-link" href="#PCA-and-SVD">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>We will be working with the digits dataset used in the lectures</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfilename</span><span class="o">=</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">gentib</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">Teaching</span><span class="se">\\</span><span class="s2">Spring 2021</span><span class="se">\\</span><span class="s2">CSCI 440 Machine Learning</span><span class="se">\\</span><span class="s2">Datasets</span><span class="se">\\</span><span class="s2">Handwritten Digits</span><span class="se">\\</span><span class="s2">zip.train&quot;</span>
<span class="n">digit_data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">tfilename</span><span class="p">)</span> 
<span class="c1">#print(np.shape(digit_data))</span>
<span class="c1">#print(digit_data[:5,:])</span>

<span class="n">Y</span><span class="o">=</span><span class="n">digit_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X</span><span class="o">=</span><span class="n">digit_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensions of the X data : &quot;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first 5 data entries : &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 100 labels :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Dimensions of the X data :  (7291, 256) 

The first 5 data entries : 
[[-1.    -1.    -1.    ... -1.    -1.    -1.   ]
 [-1.    -1.    -1.    ... -0.671 -0.828 -1.   ]
 [-1.    -1.    -1.    ... -1.    -1.    -1.   ]
 [-1.    -1.    -1.    ... -1.    -1.    -1.   ]
 [-1.    -1.    -1.    ... -0.883 -1.    -1.   ]]
First 100 labels :
[6. 5. 4. 7. 3. 6. 3. 1. 0. 1. 7. 0. 1. 1. 7. 7. 4. 8. 0. 1. 4. 8. 7. 4.
 8. 7. 3. 7. 4. 1. 3. 6. 7. 4. 1. 3. 7. 7. 4. 5. 4. 2. 7. 4. 1. 3. 7. 7.
 4. 0. 6. 3. 2. 0. 8. 6. 6. 2. 0. 8. 7. 8. 2. 0. 9. 0. 2. 2. 0. 8. 1. 2.
 0. 8. 3. 3. 2. 8. 2. 2. 0. 8. 1. 4. 4. 8. 9. 8. 9. 6. 7. 6. 1. 9. 7. 0.
 8. 0. 4. 6.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#visualizing the first 30 images (uncentered)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_413_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Center the data</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mux</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Xc</span><span class="o">=</span><span class="n">X</span><span class="o">-</span><span class="n">mux</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mux</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(256,)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#visualizing the first 30 images</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xc</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_416_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Perform the SVD</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">Xc</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Xc</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">D</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">V</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(7291, 256)
(7291, 7291) (256,) (256, 256)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">D</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">kk</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sst</span><span class="p">)))</span><span class="o">+</span><span class="mi">1</span>
<span class="n">ss</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sst</span><span class="o">/</span><span class="n">sst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Recovery error&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[17]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;Recovery error&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_419_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Note</strong></p>
<blockquote><p>I use the rows of V not the columns to get it to work.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">K</span><span class="o">=</span><span class="mi">2</span>
<span class="n">Vk</span><span class="o">=</span><span class="n">V</span><span class="p">[:</span><span class="n">K</span><span class="p">,:]</span>
<span class="n">Z</span><span class="o">=</span><span class="n">Xc</span> <span class="o">@</span> <span class="n">Vk</span><span class="o">.</span><span class="n">T</span>

<span class="n">Z1</span><span class="o">=</span><span class="n">Z</span><span class="p">[</span><span class="n">Y</span><span class="o">==</span><span class="mi">1</span><span class="p">,:]</span>
<span class="n">Zr</span><span class="o">=</span><span class="n">Z</span><span class="p">[</span><span class="n">Y</span><span class="o">!=</span><span class="mi">1</span><span class="p">,:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Zr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(1005, 2) (6286, 2)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Zr</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">Zr</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;rest&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Z1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">Z1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Top two principal components&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$z_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$z_2$&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[20]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;$z_2$&#39;)</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_422_1.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Recovering the data using only K principal components</strong> <br><br>
<strong>K=2</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="mi">2</span>
<span class="n">Vk</span><span class="o">=</span><span class="n">V</span><span class="p">[:</span><span class="n">p</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">Xr</span><span class="o">=</span><span class="n">Xc</span> <span class="o">@</span> <span class="n">Vk</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">Vk</span>
<span class="c1">#visualizing the first 30 recovered images, using the first p componets</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xr</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_424_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>K=10</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="mi">10</span>
<span class="n">Vk</span><span class="o">=</span><span class="n">V</span><span class="p">[:</span><span class="n">p</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">Xr</span><span class="o">=</span><span class="n">Xc</span> <span class="o">@</span> <span class="n">Vk</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">Vk</span>
<span class="c1">#visualizing the first 30 recovered images, using the first p componets</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xr</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_426_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>K=50</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span><span class="o">=</span><span class="mi">50</span>
<span class="n">Vk</span><span class="o">=</span><span class="n">V</span><span class="p">[:</span><span class="n">p</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">Xr</span><span class="o">=</span><span class="n">Xc</span> <span class="o">@</span> <span class="n">Vk</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">Vk</span>
<span class="c1">#visualizing the first 30 recovered images, using the first p componets</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xr</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>    
    <span class="n">im</span><span class="o">=</span><span class="n">Xr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">,:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="output_428_0.png"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    </div>
  </div>
</body>

 


</html>
